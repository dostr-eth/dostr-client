(globalThis["webpackChunkdostr"]=globalThis["webpackChunkdostr"]||[]).push([[403],{25736:(e,t,n)=>{"use strict";var o=n(38761)["default"];n(46727);var s=Object.create,i=Object.defineProperty,a=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,l=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,d=(e,t)=>{for(var n in t)i(e,n,{get:t[n],enumerable:!0})},u=(e,t,n,o)=>{if(t&&"object"===typeof t||"function"===typeof t)for(let s of r(t))c.call(e,s)||s===n||i(e,s,{get:()=>t[s],enumerable:!(o=a(t,s))||o.enumerable});return e},p=(e,t,n)=>(n=null!=e?s(l(e)):{},u(!t&&e&&e.__esModule?n:i(n,"default",{value:e,enumerable:!0}),e)),h=e=>u(i({},"__esModule",{value:!0}),e),m={};d(m,{Kind:()=>S,SimplePool:()=>N,finishEvent:()=>T,fj:()=>R,generatePrivateKey:()=>f,getBlankEvent:()=>q,getEventHash:()=>$,getPublicKey:()=>g,matchFilter:()=>W,matchFilters:()=>z,nip04:()=>L,nip05:()=>X,nip06:()=>oe,nip19:()=>ue,nip26:()=>Ce,nip39:()=>Oe,nip57:()=>We,nipxx:()=>Be,relayInit:()=>V,serializeEvent:()=>P,signEvent:()=>M,utils:()=>k,validateEvent:()=>O,verifySignature:()=>I}),e.exports=h(m);var y=p(n(59493));function f(){return y.utils.bytesToHex(y.utils.randomPrivateKey())}function g(e){return y.utils.bytesToHex(y.schnorr.getPublicKey(e))}var w=p(n(59493)),b=n(25137),k={};d(k,{insertEventIntoAscendingList:()=>C,insertEventIntoDescendingList:()=>E,normalizeURL:()=>_,utf8Decoder:()=>v,utf8Encoder:()=>x});var v=new TextDecoder("utf-8"),x=new TextEncoder;function _(e){let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),("80"===t.port&&"ws:"===t.protocol||"443"===t.port&&"wss:"===t.protocol)&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}function E(e,t){let n,o=0,s=e.length-1,i=o;if(s<0)i=0;else if(t.created_at<e[s].created_at)i=s+1;else if(t.created_at>=e[o].created_at)i=o;else while(1){if(s<=o+1){i=s;break}if(n=Math.floor(o+(s-o)/2),e[n].created_at>t.created_at)o=n;else{if(!(e[n].created_at<t.created_at)){i=n;break}s=n}}return e[i]?.id!==t.id?[...e.slice(0,i),t,...e.slice(i)]:e}function C(e,t){let n,o=0,s=e.length-1,i=o;if(s<0)i=0;else if(t.created_at>e[s].created_at)i=s+1;else if(t.created_at<=e[o].created_at)i=o;else while(1){if(s<=o+1){i=s;break}if(n=Math.floor(o+(s-o)/2),e[n].created_at<t.created_at)o=n;else{if(!(e[n].created_at>t.created_at)){i=n;break}s=n}}return e[i]?.id!==t.id?[...e.slice(0,i),t,...e.slice(i)]:e}var S=(e=>(e[e["Metadata"]=0]="Metadata",e[e["Text"]=1]="Text",e[e["RecommendRelay"]=2]="RecommendRelay",e[e["Contacts"]=3]="Contacts",e[e["EncryptedDirectMessage"]=4]="EncryptedDirectMessage",e[e["EventDeletion"]=5]="EventDeletion",e[e["Reaction"]=7]="Reaction",e[e["ChannelCreation"]=40]="ChannelCreation",e[e["ChannelMetadata"]=41]="ChannelMetadata",e[e["ChannelMessage"]=42]="ChannelMessage",e[e["ChannelHideMessage"]=43]="ChannelHideMessage",e[e["ChannelMuteUser"]=44]="ChannelMuteUser",e[e["Report"]=1984]="Report",e[e["ZapRequest"]=9734]="ZapRequest",e[e["Zap"]=9735]="Zap",e[e["RelayList"]=10002]="RelayList",e[e["ClientAuth"]=22242]="ClientAuth",e[e["Article"]=30023]="Article",e))(S||{});function q(){return{kind:255,content:"",tags:[],created_at:0}}function T(e,t){let n=e;return n.pubkey=g(t),n.id=$(n),n.sig=M(n,t),n}function P(e){if(!O(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function $(e){let t=(0,b.sha256)(x.encode(P(e)));return w.utils.bytesToHex(t)}function O(e){if("object"!==typeof e)return!1;if("number"!==typeof e.kind)return!1;if("string"!==typeof e.content)return!1;if("number"!==typeof e.created_at)return!1;if("string"!==typeof e.pubkey)return!1;if(!e.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let e=0;e<n.length;e++)if("object"===typeof n[e])return!1}return!0}function I(e){return w.schnorr.verifySync(e.sig,$(e),e.pubkey)}function M(e,t){return w.utils.bytesToHex(w.schnorr.signSync($(e),t))}function W(e,t){if(e.ids&&-1===e.ids.indexOf(t.id))return!1;if(e.kinds&&-1===e.kinds.indexOf(t.kind))return!1;if(e.authors&&-1===e.authors.indexOf(t.pubkey))return!1;for(let n in e)if("#"===n[0]){let o=n.slice(1),s=e[`#${o}`];if(s&&!t.tags.find((([e,t])=>e===n.slice(1)&&-1!==s.indexOf(t))))return!1}return!(e.since&&t.created_at<e.since)&&!(e.until&&t.created_at>=e.until)}function z(e,t){for(let n=0;n<e.length;n++)if(W(e[n],t))return!0;return!1}var R={};function U(e,t){let n=t.length+3,o=e.indexOf(`"${t}":`)+n,s=e.slice(o).indexOf('"')+o+1;return e.slice(s,s+64)}function D(e,t){let n=t.length,o=e.indexOf(`"${t}":`)+n+3,s=e.slice(o),i=Math.min(s.indexOf(","),s.indexOf("}"));return parseInt(s.slice(0,i),10)}function j(e){let t=e.slice(0,22).indexOf('"EVENT"');if(-1===t)return null;let n=e.slice(t+7+1).indexOf('"');if(-1===n)return null;let o=t+7+1+n,s=e.slice(o+1,80).indexOf('"');if(-1===s)return null;let i=o+1+s;return e.slice(o+1,i)}function K(e,t){return t===U(e,"id")}function Z(e,t){return t===U(e,"pubkey")}function B(e,t){return t===D(e,"kind")}function V(e,t={}){let{listTimeout:n=3e3,getTimeout:o=3e3}=t;var s,i={},a={connect:[],disconnect:[],error:[],notice:[]},r={},l={};async function c(){return new Promise(((t,n)=>{try{s=new WebSocket(e)}catch(u){n(u)}s.onopen=()=>{a.connect.forEach((e=>e())),t()},s.onerror=()=>{a.error.forEach((e=>e())),n()},s.onclose=async()=>{a.disconnect.forEach((e=>e()))};let o,c=[];function d(){if(0===c.length)return clearInterval(o),void(o=null);var t=c.shift();if(!t)return;let n=j(t);if(n){let o=i[n];if(o&&o.alreadyHaveEvent&&o.alreadyHaveEvent(U(t,"id"),e))return}try{let e=JSON.parse(t);switch(e[0]){case"EVENT":let t=e[1],n=e[2];return void(O(n)&&i[t]&&(i[t].skipVerification||I(n))&&z(i[t].filters,n)&&(i[t],(r[t]?.event||[]).forEach((e=>e(n)))));case"EOSE":{let t=e[1];return void(t in r&&(r[t].eose.forEach((e=>e())),r[t].eose=[]))}case"OK":{let t=e[1],n=e[2],o=e[3]||"";return void(t in l&&(n?l[t].ok.forEach((e=>e())):l[t].failed.forEach((e=>e(o))),l[t].ok=[],l[t].failed=[]))}case"NOTICE":let o=e[1];return void a.notice.forEach((e=>e(o)))}}catch(u){return}}s.onmessage=e=>{c.push(e.data),o||(o=setInterval(d,0))}}))}function d(){return 1===s?.readyState}async function u(){d()||await c()}async function p(e){let t=JSON.stringify(e);if(d()||(await new Promise((e=>setTimeout(e,1e3))),d()))try{s.send(t)}catch(n){console.log(n)}}const h=(e,{skipVerification:t=!1,alreadyHaveEvent:n=null,id:o=Math.random().toString().slice(2)}={})=>{let s=o;return i[s]={id:s,filters:e,skipVerification:t,alreadyHaveEvent:n},p(["REQ",s,...e]),{sub:(o,i={})=>h(o||e,{skipVerification:i.skipVerification||t,alreadyHaveEvent:i.alreadyHaveEvent||n,id:s}),unsub:()=>{delete i[s],delete r[s],p(["CLOSE",s])},on:(e,t)=>{r[s]=r[s]||{event:[],eose:[]},r[s][e].push(t)},off:(e,t)=>{let n=r[s],o=n[e].indexOf(t);o>=0&&n[e].splice(o,1)}}};return{url:e,sub:h,on:(e,t)=>{a[e].push(t),"connect"===e&&1===s?.readyState&&t()},off:(e,t)=>{let n=a[e].indexOf(t);-1!==n&&a[e].splice(n,1)},list:(e,t)=>new Promise((o=>{let s=h(e,t),i=[],a=setTimeout((()=>{s.unsub(),o(i)}),n);s.on("eose",(()=>{s.unsub(),clearTimeout(a),o(i)})),s.on("event",(e=>{i.push(e)}))})),get:(e,t)=>new Promise((n=>{let s=h([e],t),i=setTimeout((()=>{s.unsub(),n(null)}),o);s.on("event",(e=>{s.unsub(),clearTimeout(i),n(e)}))})),publish(e){if(!e.id)throw new Error(`event ${e} has no id`);let t=e.id;return p(["EVENT",e]),{on:(e,n)=>{l[t]=l[t]||{ok:[],failed:[]},l[t][e].push(n)},off:(e,n)=>{let o=l[t];if(!o)return;let s=o[e].indexOf(n);s>=0&&o[e].splice(s,1)}}},connect:u,close(){a={connect:[],disconnect:[],error:[],notice:[]},r={},l={},s.readyState===WebSocket.OPEN&&s?.close()},get status(){return s?.readyState??3}}}d(R,{getHex64:()=>U,getInt:()=>D,getSubscriptionId:()=>j,matchEventId:()=>K,matchEventKind:()=>B,matchEventPubkey:()=>Z});var N=class{constructor(e={}){o(this,"_conn",void 0),o(this,"_seenOn",{}),o(this,"eoseSubTimeout",void 0),o(this,"getTimeout",void 0),this._conn={},this.eoseSubTimeout=e.eoseSubTimeout||3400,this.getTimeout=e.getTimeout||3400}close(e){e.forEach((e=>{let t=this._conn[_(e)];t&&t.close()}))}async ensureRelay(e){const t=_(e),n=this._conn[t];if(n&&1===n.status)return n;if(n)return await n.connect(),n;const o=V(t,{getTimeout:.9*this.getTimeout,listTimeout:.9*this.getTimeout});return this._conn[t]=o,await o.connect(),o}sub(e,t,n){let o=new Set,s={...n||{}};s.alreadyHaveEvent=(e,t)=>{if(n?.alreadyHaveEvent?.(e,t))return!0;let s=this._seenOn[e]||new Set;return s.add(t),this._seenOn[e]=s,o.has(e)};let i=[],a=new Set,r=new Set,l=e.length,c=!1,d=setTimeout((()=>{c=!0;for(let e of r.values())e()}),this.eoseSubTimeout);e.forEach((async e=>{let n;try{n=await this.ensureRelay(e)}catch(h){return void p()}if(!n)return;let u=n.sub(t,s);function p(){if(l--,0===l){clearTimeout(d);for(let e of r.values())e()}}u.on("event",(e=>{o.add(e.id);for(let t of a.values())t(e)})),u.on("eose",(()=>{c||p()})),i.push(u)}));let u={sub(e,t){return i.forEach((n=>n.sub(e,t))),u},unsub(){i.forEach((e=>e.unsub()))},on(e,t){"event"===e?a.add(t):"eose"===e&&r.add(t)},off(e,t){"event"===e?a.delete(t):"eose"===e&&r.delete(t)}};return u}get(e,t,n){return new Promise((o=>{let s=this.sub(e,[t],n),i=setTimeout((()=>{s.unsub(),o(null)}),this.getTimeout);s.on("event",(e=>{o(e),clearTimeout(i),s.unsub()}))}))}list(e,t,n){return new Promise((o=>{let s=[],i=this.sub(e,t,n);i.on("event",(e=>{s.push(e)})),i.on("eose",(()=>{i.unsub(),o(s)}))}))}publish(e,t){const n=[];return e.forEach((async e=>{let o;try{o=await this.ensureRelay(e),n.push(o.publish(t))}catch(s){}})),{on(t,o){n.forEach(((n,s)=>{n.on(t,(()=>o(e[s])))}))},off(){}}}seenOn(e){return Array.from(this._seenOn[e]?.values?.()||[])}},L={};d(L,{decrypt:()=>Y,encrypt:()=>H});var A=n(41654),F=p(n(59493)),Q=n(64999);async function H(e,t,n){const o=F.getSharedSecret(e,"02"+t),s=G(o);let i=Uint8Array.from((0,A.randomBytes)(16)),a=x.encode(n),r=await crypto.subtle.importKey("raw",s,{name:"AES-CBC"},!1,["encrypt"]),l=await crypto.subtle.encrypt({name:"AES-CBC",iv:i},r,a),c=Q.base64.encode(new Uint8Array(l)),d=Q.base64.encode(new Uint8Array(i.buffer));return`${c}?iv=${d}`}async function Y(e,t,n){let[o,s]=n.split("?iv="),i=F.getSharedSecret(e,"02"+t),a=G(i),r=await crypto.subtle.importKey("raw",a,{name:"AES-CBC"},!1,["decrypt"]),l=Q.base64.decode(o),c=Q.base64.decode(s),d=await crypto.subtle.decrypt({name:"AES-CBC",iv:c},r,l),u=v.decode(d);return u}function G(e){return e.slice(1,33)}var J,X={};d(X,{queryProfile:()=>ne,searchDomain:()=>te,useFetchImplementation:()=>ee});try{J=fetch}catch{}function ee(e){J=e}async function te(e,t=""){try{let n=await(await J(`https://${e}/.well-known/nostr.json?name=${t}`)).json();return n.names}catch(n){return{}}}async function ne(e){let t,[n,o]=e.split("@");if(o||(o=n,n="_"),!n.match(/^[A-Za-z0-9-_]+$/))return null;if(!o.includes("."))return null;try{t=await(await J(`https://${o}/.well-known/nostr.json?name=${n}`)).json()}catch(a){return null}if(!t?.names?.[n])return null;let s=t.names[n],i=t.relays?.[s]||[];return{pubkey:s,relays:i}}var oe={};d(oe,{generateSeedWords:()=>ce,privateKeyFromSeedWords:()=>le,validateWords:()=>de});var se=p(n(59493)),ie=n(88270),ae=n(79266),re=n(294);function le(e,t){let n=re.HDKey.fromMasterSeed((0,ae.mnemonicToSeedSync)(e,t)),o=n.derive("m/44'/1237'/0'/0/0").privateKey;if(!o)throw new Error("could not derive private key");return se.utils.bytesToHex(o)}function ce(){return(0,ae.generateMnemonic)(ie.wordlist)}function de(e){return(0,ae.validateMnemonic)(e,ie.wordlist)}var ue={};d(ue,{decode:()=>ye,naddrEncode:()=>_e,neventEncode:()=>xe,noteEncode:()=>be,nprofileEncode:()=>ve,npubEncode:()=>we,nsecEncode:()=>ge});var pe=p(n(59493)),he=n(64999),me=5e3;function ye(e){let{prefix:t,words:n}=he.bech32.decode(e,me),o=new Uint8Array(he.bech32.fromWords(n));switch(t){case"nprofile":{let e=fe(o);if(!e[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:pe.utils.bytesToHex(e[0][0]),relays:e[1]?e[1].map((e=>v.decode(e))):[]}}}case"nevent":{let e=fe(o);if(!e[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nevent",data:{id:pe.utils.bytesToHex(e[0][0]),relays:e[1]?e[1].map((e=>v.decode(e))):[]}}}case"naddr":{let e=fe(o);if(!e[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!e[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!e[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:v.decode(e[0][0]),pubkey:pe.utils.bytesToHex(e[2][0]),kind:parseInt(pe.utils.bytesToHex(e[3][0]),16),relays:e[1]?e[1].map((e=>v.decode(e))):[]}}}case"nsec":case"npub":case"note":return{type:t,data:pe.utils.bytesToHex(o)};default:throw new Error(`unknown prefix ${t}`)}}function fe(e){let t={},n=e;while(n.length>0){let e=n[0],o=n[1],s=n.slice(2,2+o);n=n.slice(2+o),s.length<o||(t[e]=t[e]||[],t[e].push(s))}return t}function ge(e){return ke("nsec",e)}function we(e){return ke("npub",e)}function be(e){return ke("note",e)}function ke(e,t){let n=pe.utils.hexToBytes(t),o=he.bech32.toWords(n);return he.bech32.encode(e,o,me)}function ve(e){let t=Ee({0:[pe.utils.hexToBytes(e.pubkey)],1:(e.relays||[]).map((e=>x.encode(e)))}),n=he.bech32.toWords(t);return he.bech32.encode("nprofile",n,me)}function xe(e){let t=Ee({0:[pe.utils.hexToBytes(e.id)],1:(e.relays||[]).map((e=>x.encode(e)))}),n=he.bech32.toWords(t);return he.bech32.encode("nevent",n,me)}function _e(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let n=Ee({0:[x.encode(e.identifier)],1:(e.relays||[]).map((e=>x.encode(e))),2:[pe.utils.hexToBytes(e.pubkey)],3:[new Uint8Array(t)]}),o=he.bech32.toWords(n);return he.bech32.encode("naddr",o,me)}function Ee(e){let t=[];return Object.entries(e).forEach((([e,n])=>{n.forEach((n=>{let o=new Uint8Array(n.length+2);o.set([parseInt(e)],0),o.set([n.length],1),o.set(n,2),t.push(o)}))})),pe.utils.concatBytes(...t)}var Ce={};d(Ce,{createDelegation:()=>Te,getDelegator:()=>Pe});var Se=p(n(59493)),qe=n(25137);function Te(e,t){let n=[];(t.kind||-1)>=0&&n.push(`kind=${t.kind}`),t.until&&n.push(`created_at<${t.until}`),t.since&&n.push(`created_at>${t.since}`);let o=n.join("&");if(""===o)throw new Error("refusing to create a delegation without any conditions");let s=(0,qe.sha256)(x.encode(`nostr:delegation:${t.pubkey}:${o}`)),i=Se.utils.bytesToHex(Se.schnorr.signSync(s,e));return{from:g(e),to:t.pubkey,cond:o,sig:i}}function Pe(e){let t=e.tags.find((e=>"delegation"===e[0]&&e.length>=4));if(!t)return null;let n=t[1],o=t[2],s=t[3],i=o.split("&");for(let r=0;r<i.length;r++){let[t,n,o]=i[r].split(/\b/);if(("kind"!==t||"="!==n||e.kind!==parseInt(o))&&(!("created_at"===t&&"<"===n&&e.created_at<parseInt(o))&&!("created_at"===t&&">"===n&&e.created_at>parseInt(o))))return null}let a=(0,qe.sha256)(x.encode(`nostr:delegation:${e.pubkey}:${o}`));return Se.schnorr.verifySync(s,a,n)?n:null}var $e,Oe={};d(Oe,{useFetchImplementation:()=>Ie,validateGithub:()=>Me});try{$e=fetch}catch{}function Ie(e){$e=e}async function Me(e,t,n){try{let o=await(await $e(`https://gist.github.com/${t}/${n}/raw`)).text();return o===`Verifying that I control the following Nostr public key: ${e}`}catch(o){return!1}}var We={};d(We,{getZapEndpoint:()=>De,makeZapReceipt:()=>Ze,makeZapRequest:()=>je,useFetchImplementation:()=>Ue,validateZapRequest:()=>Ke});var ze,Re=n(64999);try{ze=fetch}catch{}function Ue(e){ze=e}async function De(e){try{let t="",{lud06:n,lud16:o}=JSON.parse(e.content);if(n){let{words:e}=Re.bech32.decode(n,1e3),o=Re.bech32.fromWords(e);t=v.decode(o)}else{if(!o)return null;{let[e,n]=o.split("@");t=`https://${n}/.well-known/lnurlp/${e}`}}let s=await ze(t),i=await s.json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch(t){}return null}function je({profile:e,event:t,amount:n,relays:o,comment:s=""}){if(!n)throw new Error("amount not given");if(!e)throw new Error("profile not given");let i={kind:9734,created_at:Math.round(Date.now()/1e3),content:s,tags:[["p",e],["amount",n.toString()],["relays",...o]]};return t&&i.tags.push(["e",t]),i}function Ke(e){let t;try{t=JSON.parse(e)}catch(i){return"Invalid zap request JSON."}if(!O(t))return"Zap request is not a valid Nostr event.";if(!I(t))return"Invalid signature on zap request.";let n=t.tags.find((([e,t])=>"p"===e&&t));if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let o=t.tags.find((([e,t])=>"e"===e&&t));if(o&&!o[1].match(/^[a-f0-9]{64}$/))return"Zap request 'e' tag is not valid hex.";let s=t.tags.find((([e,t])=>"relays"===e&&t));return s?null:"Zap request doesn't have a 'relays' tag."}function Ze({zapRequest:e,preimage:t,bolt11:n,paidAt:o}){let s=JSON.parse(e),i=s.tags.filter((([e])=>"e"===e||"p"===e||"a"===e)),a={kind:9735,created_at:Math.round(o.getTime()/1e3),content:"",tags:[...i,["bolt11",n],["description",e]]};return t&&a.tags.push(["preimage",t]),a}var Be={};d(Be,{loginWithX:()=>He,privateKeyFromX:()=>Fe,registerWithX:()=>Qe,signInWithX:()=>Ye,useFetchImplementation:()=>Ae});var Ve=p(n(59493)),Ne=n(81535),Le=n(25137);try{fetch}catch{}function Ae(e){e}async function Fe(e,t,n,o){if(n.length<64)throw new Error("Signature too short; length should be 65 bytes");let s=await(0,Le.sha256)(Ve.utils.hexToBytes(n.toLowerCase().startsWith("0x")?n.slice(2):n)),i=`${t}:${e}`,a=await(0,Le.sha256)(`${i}:${o||""}:${n.slice(-64)}`),r=await(0,Ne.hkdf)(Le.sha256,s,a,i,42);return Ve.utils.bytesToHex(Ve.utils.hashToPrivateKey(r))}var Qe=Fe,He=Ye;async function Ye(e,t,n,o){let s=null,i=e;if(e.includes(".")){try{s=await ne(e)}catch(l){throw console.log(l),new Error("Nostr Profile Not Found")}if(null==s)throw new Error("Nostr Profile Not Found");i=2==e.split("@").length?e.split("@")[0]:e.split(".")[0]}let a=await Fe(e,t,n,o),r=g(a);if(s?.pubkey&&r!==s.pubkey)throw new Error("Invalid Signature/Password");return{petname:i,profile:s,privkey:a}}var Ge=p(n(59493)),Je=n(76253),Xe=n(25137);Ge.utils.hmacSha256Sync=(e,...t)=>(0,Je.hmac)(Xe.sha256,e,Ge.utils.concatBytes(...t)),Ge.utils.sha256Sync=(...e)=>(0,Xe.sha256)(Ge.utils.concatBytes(...e))},42532:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Tn});var o=n(59835),s=n(61957);const i=["href"],a=["href"],r={id:"layout-container",ripple:!1,class:"backdrop"},l={id:"left-drawer",class:"flex justify-end",style:{"margin-right":"25px"}},c={id:"middle-page"},d={key:0,id:"post-entry",unelevated:"",class:"gt-xs flex column align-self relative-position"},u=(0,o._)("div",{id:"bottom-drawer-placeholder"},null,-1),p={id:"right-drawer",class:"flex justify-start"},h={key:0,id:"bottom-message-entry",unelevated:"",class:"flex column align-self relative-position q-px-md"},m={key:1,id:"bottom-post-entry-top-border"},y={key:2,id:"bottom-post-entry",unelevated:"",class:"flex column align-self relative-position q-px-md"},f=(0,o.Uk)("CLICK TO COLLAPSE/EXPAND OR DRAG TO MOVE"),g=(0,o.Uk)("FORWARD"),w=(0,o.Uk)("SCROLL TO TOP"),b=(0,o.Uk)("BACK");function k(e,t,n,k,v,x){const _=(0,o.up)("TheKeyInitializationDialog"),E=(0,o.up)("q-dialog"),C=(0,o.up)("TheUserMenu"),S=(0,o.up)("router-view"),q=(0,o.up)("q-page-container"),T=(0,o.up)("q-btn"),P=(0,o.up)("BasePostEntry"),$=(0,o.up)("TheSearchMenu"),O=(0,o.up)("q-page-sticky"),I=(0,o.up)("q-tooltip"),M=(0,o.up)("q-icon"),W=(0,o.up)("q-fab"),z=(0,o.up)("q-layout"),R=(0,o.Q2)("touch-pan");return(0,o.wg)(),(0,o.j4)(z,null,{default:(0,o.w5)((()=>[e.updatingFont?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("link",{key:0,id:"font-link",rel:"stylesheet",href:`https://fonts.googleapis.com/css2?family=${e.googleFontsName}&display-swap`},null,8,i)),(0,o._)("link",{id:"emoji-font-link",rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display-swap"},null,8,a),e.$store.state.keys.pub?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(E,{key:1,modelValue:e.initializeKeys,"onUpdate:modelValue":t[0]||(t[0]=t=>e.initializeKeys=t),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{style:{"max-height":"85vh"},onLookAround:e.setLookingAroundMode},null,8,["onLookAround"])])),_:1},8,["modelValue"])),(0,o._)("div",r,[(0,o._)("div",l,[(0,o.Wm)(C,{"item-mode":e.$q.screen.width<1023,"show-compact-mode-items":e.$q.screen.width<700,posting:e.postEntryOpen,onTogglePostEntry:e.togglePostEntry,onScrollToRect:e.scrollToRect,onSetUser:t[1]||(t[1]=t=>e.lookingAround=!1)},null,8,["item-mode","show-compact-mode-items","posting","onTogglePostEntry","onScrollToRect"])]),(0,o._)("div",c,[(0,o.Wm)(q,{ref:"pageContainer"},{default:(0,o.w5)((()=>[(0,o.Wm)(S,null,{default:(0,o.w5)((({Component:t})=>[((0,o.wg)(),(0,o.j4)(o.Ob,{include:e.cachedPages},[((0,o.wg)(),(0,o.j4)((0,o.LL)(t),{key:e.$route.path,"looking-around":e.lookingAround,onScrollToRect:e.scrollToRect,onReplyEvent:e.setReplyEvent,onUpdateFont:e.updateFont},null,40,["looking-around","onScrollToRect","onReplyEvent","onUpdateFont"]))],1032,["include"]))])),_:1})])),_:1},512),e.$q.screen.width>=600&&e.postEntryOpen?((0,o.wg)(),(0,o.iD)("div",d,[(0,o.Wm)(T,{icon:"close",flat:"",dense:"",onClick:e.togglePostEntry,class:"self-end",style:{position:"absolute",top:"0",right:"0","z-index":"1"}},null,8,["onClick"]),(0,o.Wm)(P,{event:e.replyEvent,onClearEvent:t[2]||(t[2]=t=>e.replyEvent=null),onSent:e.togglePostEntry,class:"q-px-md q-pt-sm"},null,8,["event","onSent"])])):(0,o.kq)("",!0),u]),(0,o._)("div",p,[(0,o.Wm)($)])]),e.$q.screen.width<600?((0,o.wg)(),(0,o.j4)(O,{key:2,onClick:(0,s.iM)(e.resizePostEntryPlaceholder,["stop"]),id:"bottom-drawer",position:"bottom",class:"z-top xs lt-sm"},{default:(0,o.w5)((()=>[e.messageMode?((0,o.wg)(),(0,o.iD)("div",h,[(0,o.Wm)(P,{event:e.replyEvent,"message-mode":e.messageMode,onClearEvent:t[3]||(t[3]=t=>e.replyEvent=null),onSent:t[4]||(t[4]=t=>e.replyEvent=null),onResized:e.resizePostEntryPlaceholder,"auto-focus":!1},null,8,["event","message-mode","onResized"])])):(0,o.kq)("",!0),e.messageMode?((0,o.wg)(),(0,o.iD)("div",m)):(0,o.kq)("",!0),e.postEntryOpen?((0,o.wg)(),(0,o.iD)("div",y,[(0,o.Wm)(P,{onSent:e.togglePostEntry,onResized:e.resizePostEntryPlaceholder,"auto-focus":!1},null,8,["onSent","onResized"])])):(0,o.kq)("",!0),(0,o.Wm)(C,{id:"bottom-menu","compact-mode":!0,posting:e.postEntryOpen,onTogglePostEntry:e.togglePostEntry,onScrollToRect:e.scrollToRect,onSetUser:t[5]||(t[5]=t=>e.lookingAround=!1)},null,8,["posting","onTogglePostEntry","onScrollToRect"])])),_:1},8,["onClick"])):(0,o.kq)("",!0),(0,o.Wm)(O,{style:{"margin-top":"20px"},position:"top-right",offset:e.fabPos,id:"navagation-buttons"},{default:(0,o.w5)((()=>[(0,o.wy)(((0,o.wg)(),(0,o.j4)(W,{direction:"left",color:"accent",class:"no-margin no-padding z-top","model-value":!0,persistent:"",flat:"",padding:"xs",disable:e.draggingFab},{tooltip:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,o.w5)((()=>[f])),_:1})])),icon:(0,o.w5)((()=>[(0,o.Wm)(M,{name:"drag_indicator"})])),"active-icon":(0,o.w5)((()=>[(0,o.Wm)(M,{name:"drag_indicator"})])),default:(0,o.w5)((()=>[(0,o.Wm)(T,{onClick:(0,s.iM)(e.forward,["stop"]),color:"primary",unelevated:"",round:"",outline:"",icon:"keyboard_arrow_right",disable:e.draggingFab},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,o.w5)((()=>[g])),_:1})])),_:1},8,["onClick","disable"]),(0,o.Wm)(T,{onClick:(0,s.iM)(e.scrollToTop,["stop"]),color:"primary",unelevated:"",round:"",outline:"",icon:"keyboard_double_arrow_up",disable:e.draggingFab||"inbox"===e.$route.name||"messages"===e.$route.name},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,o.w5)((()=>[w])),_:1})])),_:1},8,["onClick","disable"]),(0,o.Wm)(T,{onClick:(0,s.iM)(e.back,["stop"]),color:"primary",unelevated:"",round:"",outline:"",icon:"keyboard_arrow_left",disable:e.draggingFab},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,o.w5)((()=>[b])),_:1})])),_:1},8,["onClick","disable"])])),_:1},8,["disable"])),[[R,e.moveFab,void 0,{prevent:!0,mouse:!0}]])])),_:1},8,["offset"])])),_:1})}n(46727);var v=n(43701),x=n(19302),_=n(86970);const E={key:1,style:{"min-height":"1rem"}},C={key:2,avatar:"",class:"q-mx-auto no-padding relative-position"},S={key:2,style:{"min-height":"1rem"}};function q(e,t,n,s,i,a){const r=(0,o.up)("BaseUserCard"),l=(0,o.up)("BaseUserAvatar"),c=(0,o.up)("q-item"),d=(0,o.up)("q-item-section"),u=(0,o.up)("q-icon"),p=(0,o.up)("q-badge"),h=(0,o.up)("BaseButtonPost"),m=(0,o.up)("BaseButtonSetUser"),y=(0,o.up)("q-list");return(0,o.wg)(),(0,o.j4)(y,{class:(0,_.C_)(e.compactMode?"flex row no-wrap justify-around items-center full-width":"text-right"),dense:e.compactMode},{default:(0,o.w5)((()=>[e.$store.state.keys.pub?((0,o.wg)(),(0,o.j4)(c,{key:0,class:(0,_.C_)(["col no-padding flex items-center",e.compactMode?"justify-center":"justify-end"]),clickable:"",onClick:t[0]||(t[0]=t=>e.toProfile(e.$store.state.keys.pub))},{default:(0,o.w5)((()=>[e.compactMode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(r,{key:0,pubkey:e.$store.state.keys.pub,"align-right":!0,wrap:!0,class:"gt-sm"},null,8,["pubkey"])),e.compactMode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(l,{key:1,pubkey:e.$store.state.keys.pub,"align-right":!0,"show-verified":!0,size:"lg",class:"q-mr-sm lt-md"},null,8,["pubkey"])),e.$store.state.keys.pub&&e.compactMode?((0,o.wg)(),(0,o.j4)(l,{key:2,pubkey:e.$store.state.keys.pub,"align-right":!0,size:"1.5rem"},null,8,["pubkey"])):(0,o.kq)("",!0)])),_:1},8,["class"])):(0,o.kq)("",!0),e.compactMode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",E)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.filteredUserMenuItems,(t=>((0,o.wg)(),(0,o.j4)(c,{clickable:"",class:(0,_.C_)(["menu-item",(e.$route.name===t.title||e.$route.path.split("/")[1]===t.title?"menu-item-active text-accent ":"")+(e.compactMode?"no-margin no-padding col":"self-end q-px-none")]),dense:e.compactMode,style:(0,_.j5)(e.compactMode?"":"min-height: 2.75rem;"),active:e.$route.name===t.title||e.$route.path.split("/")[1]===t.title,"active-class":"",onClick:n=>e.handleClick(n,t),key:t.title},{default:(0,o.w5)((()=>[e.compactMode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(d,{key:0,class:"gt-sm text-uppercase",style:{"font-size":"1rem"}},{default:(0,o.w5)((()=>[(0,o._)("div",null,(0,_.zw)(e.$t(t.title)),1)])),_:2},1024)),t.icon&&!e.compactMode?((0,o.wg)(),(0,o.j4)(d,{key:1,avatar:"",class:"relative-position no-padding",style:{"min-width":"2.5rem"}},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{outline:"",name:t.icon},null,8,["name"]),"notifications"===t.title&&e.$store.state.unreadNotifications?((0,o.wg)(),(0,o.j4)(p,{key:0,color:"secondary",floating:"",class:"q-mr-md text-bold",outline:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,_.zw)(e.$store.state.unreadNotifications),1)])),_:1})):(0,o.kq)("",!0),"messages"===t.title&&e.$store.getters.unreadChats?((0,o.wg)(),(0,o.j4)(p,{key:1,color:"secondary",floating:"",class:"q-mr-md text-bold",outline:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,_.zw)(e.$store.getters.unreadChats),1)])),_:1})):(0,o.kq)("",!0)])),_:2},1024)):(0,o.kq)("",!0),t.icon&&e.compactMode?((0,o.wg)(),(0,o.iD)("div",C,[(0,o.Wm)(u,{name:t.icon,size:"sm"},null,8,["name"]),t.badge&&e.$store.getters[t.badge]?((0,o.wg)(),(0,o.j4)(p,{key:0,color:"secondary",floating:"",rounded:"",style:{"margin-top":"0.2rem","margin-left":"0.1rem"}})):(0,o.kq)("",!0)])):(0,o.kq)("",!0)])),_:2},1032,["dense","style","active","onClick","class"])))),128)),e.compactMode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",S)),(0,o._)("div",{color:"primary",class:(0,_.C_)(["flex",e.compactMode?"col justify-center":"q-my-md justify-end"])},[e.$store.state.keys.pub?((0,o.wg)(),(0,o.j4)(h,{key:0,"is-open":e.posting,verbose:!0,onOpen:t[1]||(t[1]=t=>e.$emit("toggle-post-entry")),outline:!e.compactMode,flat:e.compactMode,color:"primary",size:e.compactMode?"sm":"lg",class:(0,_.C_)(e.compactMode?"":"q-px-sm")},null,8,["is-open","outline","flat","size","class"])):(0,o.kq)("",!0),e.$store.state.keys.pub?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(m,{key:1,onClick:t[2]||(t[2]=t=>e.handleClick(t,{title:"set-user"})),verbose:!0,outline:!e.compactMode,flat:e.compactMode,color:"primary",size:e.compactMode?"sm":"lg",class:(0,_.C_)(e.compactMode?"":"q-px-sm")},null,8,["outline","flat","size","class"]))],2)])),_:1},8,["class","dense"])}var T=n(18933),P=n(23494);const $={key:0,class:"gt-sm spotnik",style:{"font-size":"1rem","font-weight":"700","letter-spacing":"0.05rem"}},O={key:0},I={key:1};function M(e,t,n,s,i,a){const r=(0,o.up)("q-icon"),l=(0,o.up)("q-btn");return(0,o.wg)(),(0,o.j4)(l,{unelevated:"",clickable:"",size:e.buttonSize,class:"button-post",dense:"",onClick:t[0]||(t[0]=t=>e.$emit("open"))},{default:(0,o.w5)((()=>[e.verbose?((0,o.wg)(),(0,o.iD)("div",$,[e.isOpen?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",O," "+(0,_.zw)(e.$t("post"))+" ",1)),e.isOpen?((0,o.wg)(),(0,o.iD)("span",I," "+(0,_.zw)(e.$t("close"))+" ",1)):(0,o.kq)("",!0)])):(0,o.kq)("",!0),(0,o.Wm)(r,{name:e.isOpen?"close":"chat_bubble_outline",class:(0,_.C_)(e.verbose?"":"flip-horizontal"),color:e.isOpen?"":"primary",size:e.buttonSize},null,8,["name","class","color","size"])])),_:1},8,["size"])}const W=(0,o.aZ)({name:"BaseButtonPost",emits:["open"],props:{isOpen:{type:Boolean,required:!0},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}});var z=n(11639),R=n(24455),U=n(22857),D=n(69984),j=n.n(D);const K=(0,z.Z)(W,[["render",M]]),Z=K;j()(W,"components",{QBtn:R.Z,QIcon:U.Z});const B={key:0,class:"gt-sm",style:{"font-size":"1rem","font-weight":"700","letter-spacing":"0.05rem"}};function V(e,t,n,s,i,a){const r=(0,o.up)("q-icon"),l=(0,o.up)("q-btn");return(0,o.wg)(),(0,o.j4)(l,{unelevated:"",clickable:"",size:e.buttonSize,class:"button-set-user",dense:"",style:{"margin-left":"-10px"}},{default:(0,o.w5)((()=>[e.verbose?((0,o.wg)(),(0,o.iD)("div",B,[(0,o._)("span",null," "+(0,_.zw)(e.$t("Login"))+" ",1)])):(0,o.kq)("",!0),(0,o.Wm)(r,{name:"login",color:"primary",size:e.buttonSize},null,8,["size"])])),_:1},8,["size"])}const N=(0,o.aZ)({name:"BaseButtonSetUser",props:{buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}}),L=(0,z.Z)(N,[["render",V]]),A=L;j()(N,"components",{QBtn:R.Z,QIcon:U.Z});const F=(0,o.aZ)({name:"TheUserMenu",mixins:[T.Z],emits:["toggle-post-entry","scroll-to-rect","set-user"],props:{iconMode:{type:Boolean,default:!1},compactMode:{type:Boolean,default:!1},showCompactModeItems:{type:Boolean,default:!1},posting:{type:Boolean,required:!0}},data(){return{userMenuItems:[{title:"feed",icon:"newspaper",to:"/",match:"feed"},{title:"notifications",badge:"unreadNotifications",icon:"notifications",to:"/notifications",match:"notifications"},{title:"messages",badge:"unreadChats",icon:"mail_lock",to:"/messages/inbox",match:"messages"},{title:"settings",icon:"settings",to:"/settings",match:"settings"},{title:"follow",icon:"search",to:"/follow",match:"follow",compactMenuOnly:!0}]}},components:{BaseUserCard:P.Z,BaseButtonPost:Z,BaseButtonSetUser:A},computed:{filteredUserMenuItems(){return this.$store.state.keys.pub?this.compactMode||this.showCompactModeItems?this.userMenuItems:this.userMenuItems.filter((e=>!e.compactMenuOnly)):this.userMenuItems.filter((e=>"feed"===e.title))}},methods:{handleClick(e,t){if("set-user"===t.title)return this.$emit("scroll-to-rect",{top:0}),void this.$emit("set-user");"feed"===t.title&&"feed"===this.$route.name?(e.preventDefault(),this.$emit("scroll-to-rect",{top:0})):this.$router.push(t.to)}}});var Q=n(13246),H=n(490),Y=n(50926),G=n(76749),J=n(20990),X=n(87743),ee=n(44458),te=n(62146);const ne=(0,z.Z)(F,[["render",q],["__scopeId","data-v-4a613d6c"]]),oe=ne;j()(F,"components",{QList:Q.Z,QItem:H.Z,QSeparator:Y.Z,QItemSection:G.Z,QIcon:U.Z,QBadge:J.Z,QDialog:X.Z,QCard:ee.Z,QBtn:R.Z}),j()(F,"directives",{ClosePopup:te.Z});var se=n(63517);const ie=e=>((0,o.dD)("data-v-72567971"),e=e(),(0,o.Cn)(),e),ae=ie((()=>(0,o._)("div",{style:{width:"30%",display:"flex",margin:"0 auto"}},[(0,o._)("img",{src:"mascot_round.png",alt:"mascot_round",class:"image-fit"})],-1))),re=ie((()=>(0,o._)("h2",{style:{"text-align":"center","justify-content":"center","margin-bottom":"-30px","font-size":"16px"},class:"text-h4 spotnik"}," Welcome to ",-1))),le=ie((()=>(0,o._)("h1",{style:{"text-align":"center","justify-content":"center","margin-bottom":"-5px","font-size":"50px"},class:"text-h4 spotnik"}," Dostr ",-1))),ce=ie((()=>(0,o._)("h2",{style:{"text-align":"center","justify-content":"center","font-size":"16px"},class:"text-h6 spotnik"}," Ethereum-flavoured Nostr ",-1))),de={class:"text-bold flex justify-between",style:{margin:"0 auto"}},ue=ie((()=>(0,o._)("span",{class:"lt-md",style:{"font-size":"14px",margin:"-3px 0 0 8px"}},"Learn about Dostr",-1))),pe=ie((()=>(0,o._)("span",{class:"gt-sm",style:{"font-size":"14px",margin:"-4px 0 0 10px"}},"Click here to learn about Dostr",-1))),he=ie((()=>(0,o._)("div",{style:{"margin-top":"5px"}},[(0,o._)("span",{style:{padding:"0.2rem 0 0 0.2rem","font-size":"10pt","font-family":"'SF Mono'","letter-spacing":"-0.5px"}},[(0,o.Uk)("ℹ️ This same information can be found in the "),(0,o._)("strong",null,"FAQ"),(0,o.Uk)(" section at the bottom of the "),(0,o._)("strong",null,"Settings"),(0,o.Uk)(" page after Login")])],-1))),me=ie((()=>(0,o._)("hr",{style:{"margin-bottom":"25px"}},null,-1))),ye={key:0,style:{display:"flex",margin:"0","justify-content":"center"},class:"q-mb-md"},fe=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-right":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),ge=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-left":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),we={key:1,style:{display:"flex",margin:"0","justify-content":"center"},class:"q-mb-md"},be=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-right":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),ke=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-left":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),ve={key:2,style:{position:"relative"}},xe={class:"input-siwe",style:{margin:"0px auto"}},_e=ie((()=>(0,o._)("b",{style:{color:"orange"}},"PASSWORD",-1))),Ee=(0,o.Uk)(" IS OPTIONAL ALTHOUGH WE RECOMMEND USING A VALUE. IT IS USED TO 'SALT' NOSTR-SPECIFIC KEY GENERATION "),Ce={class:"input-siwe",style:{margin:"-20px auto"}},Se=ie((()=>(0,o._)("b",{style:{color:"orange"}},"USERNAME",-1))),qe=(0,o.Uk)(),Te=ie((()=>(0,o._)("b",null,"MUST",-1))),Pe=(0,o.Uk)(" BE YOUR NIP-02 OR NIP-05 IDENTIFIER. IT IS USED TO GENERATE UNIQUE KEYS FOR YOUR USERNAME "),$e={key:3,style:{display:"block"}},Oe={key:0,style:{display:"flex",margin:"15px auto","justify-content":"center"}},Ie=ie((()=>(0,o._)("p",{class:"spotnik"},[(0,o.Uk)("↓ GENERATED "),(0,o._)("span",{style:{color:"orange","font-weight":"700"}},"PRIVATE KEYS"),(0,o.Uk)(" ↓")],-1))),Me=[Ie],We={style:{display:"block",margin:"-30px auto","justify-content":"center"}},ze={key:1,style:{display:"flex",margin:"30px","justify-content":"center"},class:"q-mb-md"},Re=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-right":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),Ue=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-left":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),De={key:2,style:{display:"flex",margin:"20px","justify-content":"center"},class:"q-mb-md"},je=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-right":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),Ke=ie((()=>(0,o._)("div",{style:{width:"4%",display:"flex","margin-left":"5px"}},[(0,o._)("img",{src:"ethereum.svg",alt:"mascot_round",class:"image-fit"})],-1))),Ze=ie((()=>(0,o._)("div",{style:{"margin-left":"47%",width:"100%"}},[(0,o._)("h2",{class:"text-subtitle1 q-pr-md"},"OR")],-1))),Be=ie((()=>(0,o._)("h2",{class:"text-subtitle1 text-bold q-pr-md flex justify-between gt-sm",style:{margin:"0 auto"}}," 🔐  Enter your custom Nostr key ",-1))),Ve=ie((()=>(0,o._)("h2",{class:"text-subtitle1 text-bold q-pr-md flex justify-between lt-md",style:{margin:"0 auto","font-size":"12px"}}," 🔐  Enter your Nostr key ",-1))),Ne={key:0,style:{"font-size":"12px",color:"white","text-transform":"uppercase"}},Le=ie((()=>(0,o._)("b",{style:{color:"lightgreen"}},"INFO: ",-1))),Ae=(0,o.Uk)(" Entering "),Fe=ie((()=>(0,o._)("b",{style:{color:"lightgreen"}},"Public Key",-1))),Qe=(0,o.Uk)(" means you will need to "),He=ie((()=>(0,o._)("b",{style:{color:"orange"}},"Sign",-1))),Ye=(0,o.Uk)(" with your "),Ge=ie((()=>(0,o._)("b",{style:{color:"orange"}},"Private Key",-1))),Je=(0,o.Uk)(" each time you post content either manually or using a browser extension "),Xe={key:1,style:{"font-size":"12px",color:"white","text-transform":"uppercase"}},et=ie((()=>(0,o._)("span",{style:{"font-size":"14px"}},"⚠️",-1))),tt=(0,o.Uk)(),nt=ie((()=>(0,o._)("b",{style:{color:"orange"}},"WARNING: ",-1))),ot=(0,o.Uk)(" Entering your "),st=ie((()=>(0,o._)("b",{style:{color:"orange"}},"Private Key",-1))),it=(0,o.Uk)(" means Dostr will automatically "),at=ie((()=>(0,o._)("b",{style:{color:"orange"}},"Sign",-1))),rt=(0,o.Uk)(" with your "),lt=ie((()=>(0,o._)("b",{style:{color:"orange"}},"Private Key",-1))),ct=(0,o.Uk)(" each time you post content "),dt=[et,tt,nt,ot,st,it,at,rt,lt,ct],ut={class:"flex justify-center spotnik",style:{"margin-top":"10px"}},pt={key:0,style:{"font-size":"16px",color:"white"}},ht={key:1,style:{"font-size":"16px",color:"white"}},mt=ie((()=>(0,o._)("hr",{style:{"margin-top":"50px","margin-bottom":"25px"}},null,-1))),yt={class:"flex justify-between"},ft={key:0,class:"text-subtitle1 text-bold q-pr-md flex justify-between",style:{margin:"0 auto"}},gt=(0,o.Uk)(" Generate Keys "),wt=(0,o.Uk)(" Use Nostr Extension "),bt=ie((()=>(0,o._)("div",{class:"full-width flex row no-wrap justify-center"},[(0,o._)("h2",{class:"text-subtitle1 text-bold q-pr-sm gt-sm"}," 📡  Enter Bootstrap Relays (optional) "),(0,o._)("h2",{class:"text-subtitle1 text-bold q-pr-sm lt-md",style:{"font-size":"12px"}}," 📡  Enter Bootstrap Relays (optional) ")],-1))),kt={class:"flex row justify-between no-wrap items-end q-mb-sm",style:{"margin-top":"20px"}},vt=ie((()=>(0,o._)("span",{class:"q-ml-sm text-bold gt-sm"},"↓ Selected relays",-1))),xt=ie((()=>(0,o._)("span",{class:"q-ml-xs text-bold lt-md"},"↓ Relays",-1))),_t=(0,o.Uk)(" ◦ The selected relays below will be queried to load your user profile, follows, and relay data from Nostr network."),Et=ie((()=>(0,o._)("br",null,null,-1))),Ct=(0,o.Uk)(" ◦ Please ensure the list of selected relays includes relays you publish your Nostr data to, otherwise Dostr may not be able to find your data. "),St={class:"flex items-end",id:"new-relay-input"},qt={class:"relay-list",style:{border:"1px solid var(--q-primary)"}},Tt=(0,o.Uk)("                       "),Pt=["onClick"],$t=(0,o.Uk)("\n                         "),Ot={class:"flex row justify-between no-wrap"},It=(0,o.Uk)("\n                           "),Mt={style:{overflow:"auto"}},Wt=(0,o.Uk)("\n                           "),zt=(0,o.Uk)("\n                         "),Rt=(0,o.Uk)("\n                       "),Ut=(0,o.Uk)("\n                     "),Dt={style:{"max-height":"6.75rem"}},jt={class:"relay-list"},Kt=(0,o.Uk)("                       "),Zt=["onClick"],Bt=(0,o.Uk)("\n                         "),Vt={class:"flex row justify-between no-wrap"},Nt=(0,o.Uk)("\n                           "),Lt={style:{overflow:"auto"}},At=(0,o.Uk)("\n                           "),Ft=(0,o.Uk)("\n                         "),Qt=(0,o.Uk)("\n                       "),Ht=(0,o.Uk)("\n                     "),Yt=ie((()=>(0,o._)("div",{style:{"min-height":"1rem"}},null,-1)));function Gt(e,t,n,i,a,r){const l=(0,o.up)("q-btn"),c=(0,o.up)("q-icon"),d=(0,o.up)("BaseInformation"),u=(0,o.up)("q-expansion-item"),p=(0,o.up)("q-tooltip"),h=(0,o.up)("q-input"),m=(0,o.up)("q-btn-group"),y=(0,o.up)("q-card-section"),f=(0,o.up)("q-form"),g=(0,o.up)("BaseSelectMultiple"),w=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(w,{class:"relative-position full-width",style:{"overflow-x":"hidden"}},{default:(0,o.w5)((()=>[ae,(0,o.Wm)(l,{icon:"close",size:"md",flat:"",round:"",class:"absolute-top-right z-top",onClick:t[0]||(t[0]=t=>e.$emit("look-around"))}),re,le,ce,(0,o.Wm)(u,{"expand-icon":"expand_more","expanded-icon":"expand_less",class:"intro full-width items-center q-mb-md","header-class":"items-center"},{header:(0,o.w5)((()=>[(0,o._)("span",de,[(0,o.Wm)(c,{name:"info"}),ue,pe])])),default:(0,o.w5)((()=>[(0,o._)("div",null,[(0,o.Wm)(d)]),he])),_:1}),me,e.isConnected?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",ye,[fe,(0,o.Wm)(l,{size:"md",onClick:e.siwe,style:{background:"linear-gradient(266deg, rgba(0,148,21,0.75) 0%, rgba(0,113,205,0.75) 100%)",border:"0px solid white"},"text-color":"white","font-weight":"900",label:e.isConnected?"Wallet Connected":"Connect Ethereum Wallet",value:"true"},null,8,["onClick","label"]),ge])),e.isConnected?((0,o.wg)(),(0,o.iD)("div",we,[be,(0,o.Wm)(l,{size:"md",onClick:e.disconnect,style:{background:"linear-gradient(266deg, rgba(255,90,90,0.75) 0%, rgba(205,0,0,0.75) 100%)",border:"0px solid white"},"text-color":"white","font-weight":"900",label:e.isConnected?"Disconnect Wallet":"Connect Ethereum Wallet",value:"true"},null,8,["onClick","label"]),ke])):(0,o.kq)("",!0),e.isConnected?((0,o.wg)(),(0,o.iD)("div",ve,[(0,o._)("div",xe,[(0,o.Wm)(h,{modelValue:e.password,"onUpdate:modelValue":t[1]||(t[1]=t=>e.password=t),ref:"keyInput","bottom-slots":"",outlined:"",label:"enter password (optional)",dense:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{name:"info",style:{"font-size":"20px","margin-top":"10px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"tooltip",anchor:"top left",self:"bottom right",style:{width:"25%"},offset:[1,1]},{default:(0,o.w5)((()=>[_e,Ee])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,o._)("div",Ce,[(0,o.Wm)(h,{modelValue:e.username,"onUpdate:modelValue":t[2]||(t[2]=t=>e.username=t),ref:"keyInput","bottom-slots":"",outlined:"",label:"enter username",dense:"",class:"q-field__bottom",rules:[e=>e&&e.length>0||"cannot be empty"]},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{name:"info",style:{"font-size":"20px","margin-top":"10px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"tooltip",anchor:"top left",self:"bottom right",style:{width:"25%"},offset:[1,1]},{default:(0,o.w5)((()=>[Se,qe,Te,Pe])),_:1})])),_:1})])),_:1},8,["modelValue","rules"])])])):(0,o.kq)("",!0),e.isConnected?((0,o.wg)(),(0,o.iD)("div",$e,[e.isSigned?((0,o.wg)(),(0,o.iD)("div",Oe,Me)):(0,o.kq)("",!0),(0,o._)("div",We,[e.isSigned?((0,o.wg)(),(0,o.j4)(h,{key:0,modelValue:e.key,"onUpdate:modelValue":t[3]||(t[3]=t=>e.key=t),ref:"keyInput","bottom-slots":"",outlined:"",disabled:!e.isSigned,label:"auto-generated from ethereum signature",style:{width:"inherit"},dense:""},null,8,["modelValue","disabled"])):(0,o.kq)("",!0)]),!e.isSigned&&e.username.length>0?((0,o.wg)(),(0,o.iD)("div",ze,[Re,(0,o.Wm)(l,{size:"md",onClick:e.sign,style:{background:"linear-gradient(266deg, rgba(0,148,21,0.75) 0%, rgba(0,113,205,0.75) 100%)",border:"0px solid white"},"text-color":"white","font-weight":"900",label:e.isConnected?"Sign-In With Ethereum":"Connect Ethereum Wallet",value:"true"},null,8,["onClick","label"]),Ue])):(0,o.kq)("",!0),e.isSigned?((0,o.wg)(),(0,o.iD)("div",De,[je,(0,o.Wm)(l,{size:"md",onClick:e.proceed,style:{background:"linear-gradient(266deg, rgba(0,148,21,0.75) 0%, rgba(0,113,205,0.75) 100%)",border:"0px solid white"},"text-color":"white","font-weight":"900",label:e.isSigned?"Proceed to Login":"Connect Ethereum Wallet",value:"true"},null,8,["onClick","label"]),Ke])):(0,o.kq)("",!0)])):(0,o.kq)("",!0),Ze,(0,o.Wm)(u,{"expand-icon":"expand_more","expanded-icon":"expand_less",class:"no-padding items-center q-mb-md","header-class":"items-center"},{header:(0,o.w5)((()=>[Be,Ve])),default:(0,o.w5)((()=>[(0,o.Wm)(f,{onSubmit:e.proceed},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{class:"key-entry no-padding"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{spread:"",unelevated:""},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{size:"md",color:"primary",label:"public key",outline:!e.watchOnly,"text-color":e.watchOnly?"dark":"",value:"true",onClick:t[4]||(t[4]=t=>e.watchOnly=!0),disable:e.isBech32Sec},null,8,["outline","text-color","disable"]),(0,o.Wm)(l,{size:"md",color:"primary",label:"private key",outline:e.watchOnly,"text-color":e.watchOnly?"":"dark",value:"false",onClick:t[5]||(t[5]=t=>e.watchOnly=!1),disable:e.isBech32Pub},null,8,["outline","text-color","disable"])])),_:1}),(0,o.Wm)(h,{modelValue:e.key,"onUpdate:modelValue":t[6]||(t[6]=t=>e.key=t),ref:"keyInput","bottom-slots":"",outlined:"",label:e.watchOnly?"enter public key":"enter private key",style:{width:"inherit"},dense:""},{hint:(0,o.w5)((()=>[!e.key&&e.watchOnly?((0,o.wg)(),(0,o.iD)("p",Ne,[(0,o.Wm)(c,{name:"info",style:{"font-size":"16px","margin-top":"-2px"}}),Le,Ae,Fe,Qe,He,Ye,Ge,Je])):(0,o.kq)("",!0),e.key||e.watchOnly?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("p",Xe,dt)),(0,o._)("div",ut,[e.key&&!e.isKeyValid?((0,o.wg)(),(0,o.iD)("p",pt," INVALID KEY ❌ ")):(0,o.kq)("",!0),e.isKeyValid?((0,o.wg)(),(0,o.iD)("p",ht," VALID KEY ✅ ")):(0,o.kq)("",!0)])])),append:(0,o.w5)((()=>[(0,o.Wm)(l,{type:"submit",unelevated:"",size:"sm",color:e.isKeyValid?"positive":"negative","font-weight":e.isKeyValid?"normal":"bold","text-color":(e.isKeyValid,"white"),label:e.isKeyValid?"PROCEED":"ENTER KEY","icon-right":e.isKeyValid?"login":"close",onClick:e.proceed,disabled:!e.isKeyValid,style:{"font-size":"12px","font-weight":"900"}},null,8,["color","font-weight","text-color","label","icon-right","onClick","disabled"])])),_:1},8,["modelValue","label"]),mt,(0,o._)("div",yt,[e.isKeyValid?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("h2",ft," 🔑 Do not have a key? "))]),(0,o.Wm)(m,{style:{"margin-top":"20px"},spread:"",unelevated:""},{default:(0,o.w5)((()=>[e.isKeyValid?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(l,{key:0,size:"md",color:"primary",outline:"",onClick:e.generate},{default:(0,o.w5)((()=>[gt])),_:1},8,["onClick"])),e.hasExtension&&!e.isKeyValid?((0,o.wg)(),(0,o.j4)(l,{key:1,size:"md",color:"primary",outline:"",onClick:e.getFromExtension},{default:(0,o.w5)((()=>[wt])),_:1},8,["onClick"])):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["onSubmit"]),e.isKeyValid?((0,o.wg)(),(0,o.j4)(u,{key:0,class:"q-mt-sm",dense:"","dense-toggle":"","default-opened":"",id:"bootstrap-relays"},{header:(0,o.w5)((()=>[bt])),default:(0,o.w5)((()=>[(0,o._)("div",kt,[vt,xt,(0,o.Wm)(c,{class:"gt-sm",name:"info",style:{"font-size":"20px","margin-left":"-75px","margin-top":"-15px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"tooltip",anchor:"top right",self:"bottom middle",offset:[10,10]},{default:(0,o.w5)((()=>[_t,Et,Ct])),_:1})])),_:1}),(0,o._)("div",St,[(0,o.Wm)(h,{modelValue:e.addRelay,"onUpdate:modelValue":t[7]||(t[7]=t=>e.addRelay=t),color:"lightgreen",ref:"keyInput",dense:"","bottom-slots":"",placeholder:"add new relay",style:{"padding-top":"-10px"}},null,8,["modelValue"]),(0,o.Wm)(l,{icon:"add",color:"positive",size:"md",flat:"",dense:"",onClick:(0,s.iM)(e.addNewRelay,["stop"])},null,8,["onClick"])])]),(0,o.Wm)(g,null,{selected:(0,o.w5)((()=>[(0,o._)("pre",qt,[Tt,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(Object.keys(e.selectedRelays),((t,n)=>((0,o.wg)(),(0,o.iD)("li",{key:n+"-"+t,class:"relay-item",onClick:(0,s.iM)((n=>delete e.selectedRelays[t]),["stop"])},[$t,(0,o._)("div",Ot,[It,(0,o._)("span",Mt,(0,_.zw)(t),1),Wt,(0,o.Wm)(c,{name:"remove",size:"xs",color:"negative"}),zt]),Rt],8,Pt)))),128)),Ut])])),options:(0,o.w5)((()=>[(0,o._)("div",Dt,[(0,o._)("pre",jt,[Kt,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.optionalRelays,((t,n)=>((0,o.wg)(),(0,o.iD)("li",{key:n+"-"+t,class:"relay-item",onClick:(0,s.iM)((n=>e.selectedRelays[t]={read:!0,write:!1}),["stop"])},[Bt,(0,o._)("div",Vt,[Nt,(0,o._)("span",Lt,(0,_.zw)(t),1),At,(0,o.Wm)(c,{name:"add",size:"xs",color:"positive",flat:""}),Ft]),Qt],8,Zt)))),128)),Ht])])])),_:1})])),_:1})):(0,o.kq)("",!0),Yt])),_:1})])),_:1})}var Jt=n(36836),Xt=n(13187),en=n(40301),tn=n(25736);const nn=async(e,t,n)=>{if(!window.ethereum)return{data:"",status:"❌ Wallet Not Connected"};{const s=new Xt.Q(window.ethereum),i=s.getSigner();try{const o=await window.ethereum.request({method:"eth_accounts"});let s=o[0];const a=window.location.host,r=window.location.origin;let l=`eip155:${n}:${s}`,c=`You are logging into Nostr network as '${e}'. Please verify the integrity and authenticity of your Nostr client before signing this message. Payload: ${l}`;const d=new en.SiweMessage({domain:a,address:s,statement:c,uri:r,version:"1",chainId:n}).prepareMessage();let u=await i.signMessage(d),p=await tn.nipxx.signInWithX(e,l,u,t);return{data:p,status:"🦊 Successfully Generated Schnorr Keys"}}catch(o){return console.log("❌ Failed to Sign: "+o.message),{data:"",status:"❌ Failed to Sign: "+o.message.toLowerCase()}}}},on=async()=>{if(!window.ethereum)return{chainId:"",address:"",status:"🦊 You must install MetaMask browser extension & connect using 'Connect Wallet' button"};try{const e=await window.ethereum.request({method:"eth_requestAccounts"}),t={chainId:window.ethereum.networkVersion,status:"🦊 Connected",address:e[0]};return t}catch(e){return console.log("❌ Failed to initialise: "+e.message),{chainId:"",address:"",status:"❌ Failed to initialise: "+e.message.toLowerCase()}}};var sn=n(42657),an=n(3719);const rn=(0,o.aZ)({name:"TheKeyInitializationDialog",mixins:[T.Z],emits:["look-around"],components:{BaseSelectMultiple:sn.Z,BaseInformation:an.Z},setup(){return{focusKeyInput(){this.$refs.keyInput.focus()}}},data(){return{watchOnly:!1,key:null,hasExtension:!1,selectedRelays:this.$store.state.defaultRelays,newRelay:"",isConnected:!1,username:"",password:"",chainId:"",isSigned:!1}},computed:{icon(){return document.getElementById("icon").href},isKeyKey(){return!!this.isKey(this.hexKey)},isKeyValid(){return!!this.isKeyKey||!!Jt.Ev.validateWords(this.key?.toLowerCase())},isUsernameValid(){return!0},isPasswordValid(){return!0},isKeyInvalid(){return!this.isKeyValid},hexKey(){return this.isBech32Key(this.key)?this.bech32ToHex(this.key):this.key?.toLowerCase()},isBech32Pub(){return!!this.isBech32Key(this.key)&&this.key.toLowerCase().startsWith("npub")},isBech32Sec(){return!!this.isBech32Key(this.key)&&this.key.toLowerCase().startsWith("nsec")},optionalRelays(){let e=this.$store.state.optionalRelaysList.filter((e=>!(this.newRelay.length&&!e.toLowerCase().includes(this.newRelay.toLowerCase()))&&!this.selectedRelays[e]));return e}},async created(){this.$store.state.keys.pub||setTimeout((()=>{window.nostr&&(this.hasExtension=!0)}),1e3)},methods:{async getFromExtension(){try{this.key=await window.nostr.getPublicKey(),this.watchOnly=!0,this.focusKeyInput()}catch(e){this.$q.notify({message:`Failed to get a public key from a Nostr extension: ${e}`,color:"warning"})}},async siwe(){let e=await on();e.address?(console.log(`Connected to ${e.address}`),this.isConnected=!0,this.chainId=e.chainId):(this.isConnected=!1,console.log("Connection Failed"))},disconnect(){this.isConnected=!1},async sign(){let e=await nn(this.username,this.password,this.chainId);this.key=e.data.privkey,this.watchOnly=!1,this.key.length>0&&(this.isSigned=!0)},generate(){this.key=(0,Jt.wQ)(),this.watchOnly=!1,this.focusKeyInput()},proceed(){let e=this.hexKey;var t={};this.isKey(e)?this.watchOnly?t.pub=e:t.priv=e:console.warn("Proceed called with invalid key",e),this.$store.commit("setDefaultRelays",this.selectedRelays),this.$store.dispatch("initKeys",t),this.$store.dispatch("launch"),this.initializeKeys=!1,this.$router.push({name:"settings",params:{initUser:!0}})},addNewRelay(){this.newRelay&&this.newRelay.length&&(this.selectedRelays[this.newRelay]={read:!0,write:!1}),this.newRelay="",this.focusKeyInput()}}});var ln=n(61123),cn=n(66611),dn=n(46858),un=n(18149),pn=n(8326),hn=n(63190),mn=n(67236);const yn=(0,z.Z)(rn,[["render",Gt],["__scopeId","data-v-72567971"]]),fn=yn;j()(rn,"components",{QDialog:X.Z,QCard:ee.Z,QBtn:R.Z,QExpansionItem:ln.Z,QIcon:U.Z,QInput:cn.Z,QTooltip:dn.Z,QField:un.Z,QForm:pn.Z,QCardSection:hn.Z,QBtnGroup:mn.Z});var gn=n(57674),wn=n(34136);const{getVerticalScrollPosition:bn,setVerticalScrollPosition:kn}=v.ZP,vn=(0,o.aZ)({name:"MainLayout",components:{TheUserMenu:oe,TheSearchMenu:se.Z,TheKeyInitializationDialog:fn},setup(){const e=(0,x.Z)();return e},data(){return{cachedPages:["Feed","Notifications","DevTools","Settings","Inbox"],middlePagePos:{},fabPos:[0,10],draggingFab:!1,broadcastChannel:new BroadcastChannel("astral"),activeWindow:!1,timeout:null,hasLaunched:!1,postEntryOpen:!1,replyEvent:null,googleFontsName:"Open Sans",updatingFont:!0,lookingAround:!1}},computed:{scrollingContainer(){return this.$q.screen.width<600?window:this.$refs.pageContainer?.$el},messageMode(){return"messages"===this.$route.name?this.replyEvent?"reply":"message":null},initializeKeys(){return!this.lookingAround}},created(){this.loadPreferences()},mounted(){this.launch(),this.enableWebLn(),document.querySelector("#left-drawer").addEventListener("wheel",this.redirectScroll,{passive:!0}),this.$router.beforeEach(((e,t)=>{this.preserveScrollPos(e,t),"messages"===e.name&&this.postEntryOpen&&(this.postEntryOpen=!1)})),this.$router.afterEach(((e,t)=>{e.path!==t.path&&this.restoreScrollPos(e,t)}));let e=this.$refs.pageContainer?.$el.getBoundingClientRect();e&&(this.fabPos[0]=e.right-e.width),this.updatingFont=!1,this.resizePostEntryPlaceholder()},beforeUnmount(){document.querySelector("#left-drawer").removeEventListener("wheel",this.redirectScroll)},methods:{redirectScroll(e){let t=bn(this.scrollingContainer);kn(this.scrollingContainer,t+e.deltaY)},preserveScrollPos(e,t){this.cachedPages.map((e=>e.toLowerCase())).includes(t.name)&&(this.middlePagePos[t.fullPath]=bn(this.scrollingContainer))},restoreScrollPos(e,t){this.middlePagePos[e.fullPath]?kn(this.scrollingContainer,this.middlePagePos[e.fullPath],500):this.scrollToTop()},scrollToTop(){kn(this.scrollingContainer,0,500)},back(){this.$router.go(-1)},forward(){this.$router.go(1)},moveFab(e){this.draggingFab=!0!==e.isFirst&&!0!==e.isFinal,this.fabPos=[this.fabPos[0]-e.delta.x,this.fabPos[1]+e.delta.y]},scrollToRect(e){let t=Math.max(e.top,0);kn(this.scrollingContainer,t,500)},async launch(){this.timeout=null,this.$store.state.keys.pub?this.$store.dispatch("launch"):this.$store.dispatch("launchWithoutKey"),this.hasLaunched=!0},togglePostEntry(){this.postEntryOpen=!this.postEntryOpen},setReplyEvent(e){this.replyEvent=e},resizePostEntryPlaceholder(){setTimeout((()=>{document.querySelector("#bottom-drawer-placeholder").style.minHeight=`${document.querySelector("#bottom-drawer")?.clientHeight||0}px`}),1e3)},updateFont(e){this.updatingFont=!0,(0,gn.Z)("font",e),this.googleFontsName=e.replace(" ","+"),this.updatingFont=!1},lightOrDark(e){var t,n,o,s;return e.match(/^rgb/)?(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),t=e[1],n=e[2],o=e[3]):(e=+("0x"+e.slice(1).replace(e.length<5&&/./g,"$&$&")),t=e>>16,n=e>>8&255,o=255&e),s=Math.sqrt(t*t*.299+n*n*.587+o*o*.114),s>127.5?"light":"dark"},loadPreferences(){let{primary:e,secondary:t,accent:n,background:o}=this.$store.state.config.preferences.color;(0,gn.Z)("primary",e),(0,gn.Z)("secondary",t),(0,gn.Z)("accent",n),(0,gn.Z)("background",o),this.$q.dark.set("dark"===this.lightOrDark(o)),this.updateFont(this.$store.state.config.preferences.font)},setLookingAroundMode(){this.lookingAround=!0},async enableWebLn(){try{"undefined"!==typeof window.webln&&await window.webln.enable()}catch(e){console.log(e)}},async getRelayStat(){let e=await(0,wn.Y8)();console.log("relayStatus",e)}}});var xn=n(77605),_n=n(12133),En=n(30627),Cn=n(88830),Sn=n(2873);const qn=(0,z.Z)(vn,[["render",k]]),Tn=qn;j()(vn,"components",{QLayout:xn.Z,QDialog:X.Z,QPageContainer:_n.Z,QSeparator:Y.Z,QBtn:R.Z,QPageSticky:En.Z,QFab:Cn.Z,QTooltip:dn.Z,QIcon:U.Z}),j()(vn,"directives",{TouchPan:Sn.Z})},88677:()=>{},62808:()=>{},69159:()=>{},35883:()=>{}}]);
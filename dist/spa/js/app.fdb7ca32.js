(()=>{var e={3308:(e,t,s)=>{"use strict";var n=s(61957),o=s(71947),i=s(60499),a=s(59835);function l(e,t,s,n,o,i){const l=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(l)}const r=(0,a.aZ)({name:"App"});var d=s(11639);const c=(0,d.Z)(r,[["render",l]]),u=c;var p=s(54927),h=s(23340),g=s(28339);const m=[{path:"/",component:()=>Promise.all([s.e(736),s.e(64),s.e(286)]).then(s.bind(s,67231)),children:[{path:"",component:()=>Promise.all([s.e(736),s.e(64),s.e(443)]).then(s.bind(s,93864)),name:"feed"},{path:"/follow",component:()=>Promise.all([s.e(736),s.e(64),s.e(363)]).then(s.bind(s,21294)),name:"follow"},{path:"/settings/:initUser?",component:()=>Promise.all([s.e(736),s.e(64),s.e(591)]).then(s.bind(s,81038)),name:"settings"},{path:"/messages/inbox",component:()=>Promise.all([s.e(736),s.e(252)]).then(s.bind(s,24252)),name:"inbox"},{path:"/messages/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([s.e(736),s.e(129)]).then(s.bind(s,64129)),name:"messages"},{path:"/:eventId(note[a-z0-9A-Z]{59})",component:()=>Promise.all([s.e(736),s.e(64),s.e(771)]).then(s.bind(s,99771)),name:"event"},{path:"/notifications",component:()=>Promise.all([s.e(736),s.e(64),s.e(408)]).then(s.bind(s,28128)),name:"notifications"},{path:"/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([s.e(736),s.e(64),s.e(218)]).then(s.bind(s,29966)),name:"profile"},{path:"/hashtag/:hashtagId([a-zA-Z0-9_]{1,63})",component:()=>Promise.all([s.e(736),s.e(64),s.e(989)]).then(s.bind(s,36989)),name:"hashtag"},{path:"/devTools",component:()=>Promise.all([s.e(736),s.e(35)]).then(s.bind(s,50035)),name:"devTools"},{path:"/:catchAll(.*)*",component:()=>Promise.all([s.e(736),s.e(740)]).then(s.bind(s,70740))}]}],y=m,f=(0,h.BC)((()=>{const e=g.PO,t=(0,g.p7)({routes:y,history:e("/dostr-client/")});return t}));async function w(e,t){const n=e(u);n.use(o.Z,t);const a="function"===typeof p["default"]?await(0,p["default"])({}):p["default"],{storeKey:l}=await Promise.resolve().then(s.bind(s,54927)),r=(0,i.Xl)("function"===typeof f?await f({store:a}):f);return a.$router=r,{app:n,store:a,storeKey:l,router:r}}var b=s(6827),v=s(97286),k=s(79231);const x={config:{dark:!0,notify:{closeBtn:!0}},plugins:{Notify:b.Z,Dialog:v.Z,Meta:k.ZP}},C="/dostr-client/",M=/\/\//,_=e=>(C+e).replace(M,"/");async function T({app:e,router:t,store:s,storeKey:n},o){let i=!1;const a=e=>{try{return _(t.resolve(e).href)}catch(s){}return Object(e)===e?null:e},l=e=>{if(i=!0,"string"===typeof e&&/^https?:\/\//.test(e))return void(window.location.href=e);const t=a(e);null!==t&&(window.location.href=t)},r=window.location.href.replace(window.location.origin,"");for(let c=0;!1===i&&c<o.length;c++)try{await o[c]({app:e,router:t,store:s,ssrContext:null,redirect:l,urlPath:r,publicPath:C})}catch(d){return d&&d.url?void l(d.url):void console.error("[Quasar] boot error:",d)}!0!==i&&(e.use(t),e.use(s,n),e.mount("#q-app"))}w(n.ri,x).then((e=>Promise.all([Promise.resolve().then(s.bind(s,5516)),Promise.resolve().then(s.bind(s,55635))]).then((t=>{const s=t.map((e=>e.default)).filter((e=>"function"===typeof e));T(e,s)}))))},5516:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>os});var n=s(59835),o=s(86970),i=s(61957);const a=e=>((0,n.dD)("data-v-e15640ec"),e=e(),(0,n.Cn)(),e),l={key:0,class:"is-reply-connector"},r={key:1,class:"has-reply-connector"},d={ref:"postHeader",clickable:"",avatar:"",top:"",class:"relative-position q-px-xs flex row no-wrap justify-between items-center"},c={class:"flex row no-wrap items-center",style:{gap:"1rem"}},u={class:"q-pb-xs sf-mono pubkey"},p=a((()=>(0,n._)("span",null,"in reply to ",-1))),h={style:{background:"var(--q-background)"}},g={style:{background:"var(--q-background)"}},m={class:"flex column no-wrap col full-width"},y={class:"q-py-sm q-px-lg"},f={key:3},w={key:4,class:"reposts flex column q-pr-md",clickable:!1},b=["color"],v=(0,n.Uk)(" EMBED "),k=(0,n.Uk)(" REPOST "),x=(0,n.Uk)(" QUOTE "),C={class:"no-wrap flex row items-center self-start",style:{gap:"0.5rem"}},M=(0,n.Uk)(" REPLY "),_={key:0,style:{position:"abosolute",right:"0"}},T=(0,n.Uk)(" CANCEL "),q=a((()=>(0,n._)("span",{class:"text-caption",style:{"letter-spacing":"-0.5px"}}," Copy event ID below and paste it in any post to embed this event ",-1))),B=a((()=>(0,n._)("br",null,null,-1))),S={class:"code",style:{"word-break":"break-all"}},$={key:1,class:"full-width",style:{"padding-left":"12px"}};function E(e,t,s,a,E,z){const Z=(0,n.up)("BaseUserAvatar"),W=(0,n.up)("q-item-label"),R=(0,n.up)("q-space"),j=(0,n.up)("BaseUserName"),P=(0,n.up)("BaseButtonInfo"),L=(0,n.up)("BaseButtonRelays"),D=(0,n.up)("q-fab"),U=(0,n.up)("BaseMarkdown"),I=(0,n.up)("BaseRelayRecommend"),N=(0,n.up)("BaseUserCard"),O=(0,n.up)("BasePost",!0),A=(0,n.up)("BaseButtonLightning"),F=(0,n.up)("q-tab"),H=(0,n.up)("q-tooltip"),Q=(0,n.up)("q-icon"),V=(0,n.up)("q-tabs"),K=(0,n.up)("q-item-section"),J=(0,n.up)("BaseButtonCopy"),Y=(0,n.up)("q-tab-panel"),X=(0,n.up)("BasePostEntry"),G=(0,n.up)("q-tab-panels"),ee=(0,n.up)("BasePostThread");return(0,n.wg)(),(0,n.iD)("div",{color:"accent",class:(0,o.C_)(["post-padding cursor-pointer no-hover flex column no-wrap relative-position",(e.hasReply?"post-has-reply":"")+(e.isReply?" post-is-reply":"")+(e.highlighted?" post-highlighted":"")+(e.isChildReply?" post-is-child-reply":"")+(e.hasReplyChildren?" post-has-child-reply":"")]),clickable:"","manual-focus":"",onClick:t[14]||(t[14]=(0,i.iM)((t=>e.toEvent(e.event.id)),["stop"]))},[e.isReply?((0,n.wg)(),(0,n.iD)("div",l)):(0,n.kq)("",!0),e.hasReply?((0,n.wg)(),(0,n.iD)("div",r)):(0,n.kq)("",!0),"reply"===e.replyMode?((0,n.wg)(),(0,n.iD)("div",{key:2,class:"has-replying-connector",style:(0,o.j5)("height: "+(e.headerHeight+e.postHeight)+"px;")},null,4)):(0,n.kq)("",!0),e.hasReplyChildren?((0,n.wg)(),(0,n.iD)("div",{key:3,ref:"hasChildReplyConnector",class:"has-child-reply-connector",style:(0,o.j5)([{visibility:"hidden"},e.childReplyConnectorStyle()])},null,4)):(0,n.kq)("",!0),(0,n._)("div",d,[(0,n._)("div",c,[(0,n.Wm)(Z,{pubkey:e.event.pubkey,size:e.highlighted?"lg":"md",round:!0,bordered:e.hasReply||e.isReply||e.hasReplyChildren||e.isChildReply,"hover-effect":!0,style:{"z-index":"1"}},null,8,["pubkey","size","bordered"]),(0,n._)("div",u,[(0,n.Wm)(W,{caption:"",class:"text-secondary",style:{opacity:"1"}},{default:(0,n.w5)((()=>[(0,n._)("span",{onClick:t[0]||(t[0]=(0,i.iM)((t=>e.toProfile(e.event.pubkey)),["stop"]))},(0,o.zw)(e.shorten(e.hexToBech32(e.event.pubkey,"npub"))),1)])),_:1}),(0,n.Wm)(R),(0,n.Wm)(W,{line:1,clickable:""},{default:(0,n.w5)((()=>[(0,n.Wm)(j,{pubkey:e.event.pubkey,"show-verified":!0,class:"text-bold","show-following":!0,wrap:!0},null,8,["pubkey"])])),_:1}),!e.tagged||"event"==e.$route.name||e.isReply||e.isChildReply?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(W,{key:0,class:"q-pl-sm",style:{"font-size":"0.8rem",opacity:"0.7"}},{default:(0,n.w5)((()=>[p,(0,n._)("a",{onClick:t[1]||(t[1]=(0,i.iM)((t=>e.toEvent(e.tagged)),["stop"]))},(0,o.zw)(e.shorten(e.hexToBech32(e.tagged,"note"))),1)])),_:1}))])]),(0,n._)("div",{class:"flex row no-wrap items-center post-info",style:{"z-index":"1"},onClick:t[2]||(t[2]=(0,i.iM)((()=>{}),["stop"]))},[(0,n.Wm)(W,{class:"q-pr-xs sf-mono",style:{opacity:"0.8","font-size":"90%"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.niceDate(e.event.created_at)),1)])),_:1}),(0,n.Wm)(D,{color:"secondary",icon:"more_vert",direction:"down","vertical-actions-align":"right",padding:"xs",flat:"",dense:""},{default:(0,n.w5)((()=>[(0,n._)("div",h,[(0,n.Wm)(P,{"button-class":"text-secondary full-width justify-start no-wrap",event:e.event,size:"md"},null,8,["event"])]),(0,n._)("div",g,[(0,n.Wm)(L,{"button-class":"text-secondary full-width justify-start no-wrap",event:e.event,size:"md"},null,8,["event"])])])),_:1})])],512),(0,n._)("div",m,[(0,n.Wm)(K,{ref:"postContent"},{default:(0,n.w5)((()=>[(0,n._)("div",y,[1===e.event.kind?((0,n.wg)(),(0,n.j4)(U,{key:0,content:e.event.interpolated.text,"long-form":e.isLongForm,onExpand:t[3]||(t[3]=t=>e.isLongForm=!e.isLongForm),onResized:t[4]||(t[4]=t=>e.calcConnectorValues(10))},null,8,["content","long-form"])):2===e.event.kind?((0,n.wg)(),(0,n.j4)(I,{key:1,url:e.sanitize(e.event.content)},null,8,["url"])):0===e.event.kind?((0,n.wg)(),(0,n.j4)(N,{key:2,pubkey:e.event.pubkey,"header-mode":!0},null,8,["pubkey"])):((0,n.wg)(),(0,n.iD)("pre",f," "+(0,o.zw)(e.cleanEvent)+" ",1)),e.isEmbeded||!e.isQuote&&!e.isRepost?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",w,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.mentionEvents,((s,o)=>((0,n.wg)(),(0,n.iD)("div",{key:s+"_"+e.mentionEvents.length+"_"+o},[e.$store.state.eventsCache[s]?((0,n.wg)(),(0,n.j4)(O,{key:0,event:e.$store.state.eventsCache[s],"manual-focus":!1,"is-embeded":!0,onClick:(0,i.iM)((t=>e.toEvent(s)),["stop"]),onResized:t[5]||(t[5]=t=>e.calcConnectorValues(10))},null,8,["event","onClick"])):(0,n.kq)("",!0)])))),128))]))]),!e.isRepost&&e.$store.state.keys.pub&&-1!==e.replyDepth?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"flex row items-center no-wrap reply-buttons full-width",color:e.replying?"primary":""},[(0,n.Wm)(V,{modelValue:e.replyMode,"onUpdate:modelValue":t[7]||(t[7]=t=>e.replyMode=t),class:"text-secondary full-width",align:"justify",unelevated:"",dense:"",flat:"","active-color":"primary",size:e.highlighted?"md":"sm",onClick:t[8]||(t[8]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{class:"no-padding"},{default:(0,n.w5)((()=>[e.$store.getters.profileLud06(e.event.pubkey)?((0,n.wg)(),(0,n.j4)(A,{key:0,pubkey:e.event.pubkey,size:e.highlighted?"md":"sm"},null,8,["pubkey","size"])):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(F,{name:"embed",class:"no-padding"},{default:(0,n.w5)((()=>[(0,n.Wm)(Q,{name:"link",size:"sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(H,{class:"tooltip",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,n.w5)((()=>[v])),_:1})])),_:1})])),_:1}),(0,n.Wm)(F,{name:"repost",class:"no-padding"},{default:(0,n.w5)((()=>[(0,n.Wm)(Q,{name:"repeat",size:"sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(H,{class:"tooltip",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,n.w5)((()=>[k])),_:1})])),_:1})])),_:1}),(0,n.Wm)(F,{name:"quote",class:"no-padding"},{default:(0,n.w5)((()=>[(0,n.Wm)(Q,{name:"format_quote",size:"sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(H,{class:"tooltip",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,n.w5)((()=>[x])),_:1})])),_:1})])),_:1}),(0,n.Wm)(F,{name:"reply",class:"no-padding no-wrap flex row"},{default:(0,n.w5)((()=>[(0,n._)("div",C,[(0,n.Wm)(Q,{size:"sm",name:"chat_bubble_outline",class:"flip-horizontal relative-position"},{default:(0,n.w5)((()=>[(0,n.Wm)(H,{class:"tooltip",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,n.w5)((()=>[M])),_:1})])),_:1}),e.replyCount?((0,n.wg)(),(0,n.iD)("span",_,(0,o.zw)(e.replyCount),1)):(0,n.kq)("",!0)])])),_:1}),e.replyMode&&"tip"!==e.replyMode?((0,n.wg)(),(0,n.j4)(F,{key:0,class:"no-padding",onClick:t[6]||(t[6]=(0,i.iM)((t=>e.replyMode=null),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(Q,{name:"close",color:"accent"},{default:(0,n.w5)((()=>[(0,n.Wm)(H,{class:"tooltip",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,n.w5)((()=>[T])),_:1})])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1},8,["modelValue","size"])],8,b)):(0,n.kq)("",!0)])),_:1},512),e.replyMode&&"tip"!==e.replyMode?((0,n.wg)(),(0,n.j4)(K,{key:0,class:"new-reply-box",ref:"replyContent"},{default:(0,n.w5)((()=>[(0,n.Wm)(G,{modelValue:e.replyPanel,"onUpdate:modelValue":t[11]||(t[11]=t=>e.replyPanel=t),class:"no-padding full-width overflow-hidden",style:{background:"var(--q-background)","max-width":"100%","z-index":"1"},onTransition:t[12]||(t[12]=t=>e.calcConnectorValues(10))},{default:(0,n.w5)((()=>[(0,n.Wm)(Y,{name:"embed",class:"no-padding",onClick:t[9]||(t[9]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(Q,{name:"info"}),q,(0,n.Wm)(J,{"button-text":e.hexToBech32(e.event.id,"note"),color:"primary",flat:"","tooltip-text":"COPY EVENT ID"},null,8,["button-text"]),B,(0,n._)("span",S,(0,o.zw)(e.hexToBech32(e.event.id,"note")),1)])),_:1}),(0,n.Wm)(Y,{name:"reply",class:"q-pa-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(X,{event:e.event,"reply-mode":e.replyMode,onSent:e.replySent,onResized:t[10]||(t[10]=t=>e.calcConnectorValues(10))},null,8,["event","reply-mode","onSent"])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,n.kq)("",!0),e.hasReplyChildren&&-1!==e.replyDepth&&e.event.replies&&e.event.replies.length<3?((0,n.wg)(),(0,n.iD)("div",$,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.event.replies,(s=>((0,n.wg)(),(0,n.iD)("div",{key:s[0].id,ref_for:!0,ref:"childReplyContent"},[(0,n.Wm)(ee,{events:s,"reply-depth":e.replyDepth+1,onResized:t[13]||(t[13]=t=>e.calcConnectorValues(10)),onAddEvent:e.addEvent},null,8,["events","reply-depth","onAddEvent"])])))),128))])):(0,n.kq)("",!0)])],2)}var z=s(22330),Z=s(18933),W=s(85598),R=s(32145),j=s(23426),P=s(3325),L=s(85234),D=s(28669),U=s(88995);const I=(0,n.aZ)({name:"BasePost",emits:["resized","add-event","mounted"],mixins:[Z.Z],props:{event:{type:Object,required:!0},highlighted:{type:Boolean,default:!1},position:{type:String,default:"standalone"},replyDepth:{type:Number,default:0},replyCount:{type:Number,default:0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:W.Z,BaseButtonInfo:R.Z,BaseButtonCopy:j.Z,BaseMarkdown:P.Z,BaseRelayRecommend:L.Z,BaseButtonLightning:D.Z},data(){return{clicking:!1,replying:!1,childReplyHeights:[],postHeight:0,replyHeight:0,reposts:[],eventSub:null,replyMode:"",resizing:!1,trigger:1,isLongForm:!1}},computed:{tagged(){let e=this.event.interpolated?.replyEvents;return e?.length?e[e.length-1]:null},taggedPubkeys(){let e=this.event.tags.filter((e=>"p"===e[0]&&e[1])).map((e=>e[1]));return e?.length?e:null},isRepost(){return""===this.event.interpolated?.text&&this.event.interpolated.mentionEvents.length},isQuote(){return this.event.interpolated?.text&&this.event.interpolated.mentionEvents.length},mentionEvents(){return this.event.interpolated?.mentionEvents},isReply(){return"middle"===this.position||"last"===this.position},hasReply(){return"middle"===this.position||"first"===this.position},isChildReply(){return!!this.replyDepth},hasReplyChildren(){return!!(this.event.replies&&this.event.replies.length>0&&this.event.replies.length<3)},postContentWidth(){return this.resizing,this.$refs.postContent?.$el?.clientWidth},postContentHeight(){return this.resizing,this.$refs.postContent?.$el?.clientHeight},replyContentHeight(){return this.replyMode&&this.resizing&&this.$refs.replyContent?.$el?this.$refs.replyContent?.$el?.clientHeight:this.$refs.replyContent?.$el?.clientHeight||0},replyPanel(){return"embed"===this.replyMode?"embed":this.replyMode?"reply":""},cleanEvent(){return this.sanitize(JSON.stringify((0,z.CX)(this.event),null,2))}},mounted(){this.isEmbeded||!this.isQuote&&!this.isRepost||(Array.isArray(this.reposts)||(this.reposts=[]),this.processTaggedEvents(this.mentionEvents,this.reposts)),this.calcConnectorValues(),this.$emit("mounted"),this.isLongForm=this.event.content.length>600||this.event.content.split(/\r\n|\r|\n/).length>10},activated(){this.calcConnectorValues(),this.trigger++},methods:{childReplyConnectorStyle(){if(this.childReplyHeights?.length){let e=this.headerHeight+this.postHeight+this.childReplyHeights.slice(0,-1).reduce(((e,t)=>e+t),0);return e+=this.isChildReply?12:22,this.replyHeight&&(e+=this.replyHeight),"visibility: visible; height: "+e+"px"}return""},calcConnectorValues(e=2e3){this.resizing=!this.resizing,(0,n.Y3)((()=>{setTimeout((()=>{this.headerHeight=this.$refs.postHeader?this.$refs.postHeader.clientHeight:0,this.postHeight=this.postContentHeight,this.replyHeight=this.replyContentHeight,this.hasReplyChildren&&(this.childReplyHeights=this.$refs.childReplyContent?.map((e=>e.clientHeight))),this.$emit("resized")}),e)}))},toggleReplying(){""===this.replyMode?(this.replying=!0,this.replyMode="reply"):(this.replyMode="",this.replying=!1),this.calcConnectorValues(10)},replySent(e){this.replying=!1,this.replyMode="",this.$emit("add-event",e)},niceDate(e){return this.trigger,this.niceDateUTC(e)},addEvent(e){this.$emit("add-event",e)},sanitize(e){return U.sanitize(e)}}});var N=s(11639),O=s(33115),A=s(90136),F=s(88830),H=s(24455),Q=s(56362),V=s(76749),K=s(47817),J=s(70900),Y=s(22857),X=s(46858),G=s(89800),ee=s(84106),te=s(69984),se=s.n(te);const ne=(0,N.Z)(I,[["render",E],["__scopeId","data-v-e15640ec"]]),oe=ne;se()(I,"components",{QItemLabel:O.Z,QSpace:A.Z,QFab:F.Z,QBtn:H.Z,QMenu:Q.Z,QItemSection:V.Z,QTabs:K.Z,QTab:J.Z,QIcon:Y.Z,QTooltip:X.Z,QTabPanels:G.Z,QTabPanel:ee.Z});const ie={key:0,class:"text-bold flex row no-wrap items-center",style:{gap:"0.2rem"},clickable:""},ae=(0,n.Uk)(" following "),le={key:0,style:{opacity:"0.9","font-size":"90%","font-weight":"300","line-height":"90%"}},re={key:1,style:{opacity:"0.9","font-size":"90%","font-weight":"300","line-height":"90%"}};function de(e,t,s,a,l,r){const d=(0,n.up)("q-tooltip"),c=(0,n.up)("q-icon"),u=(0,n.up)("BaseButtonNIP05");return(0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)(["cursor-pointer flex",(s.alignRight?" justify-end":" justify-start")+(s.headerMode?" column items-start":" row items-center")+(s.wrap?"":" no-wrap")]),onClick:t[0]||(t[0]=(0,i.iM)((t=>e.toProfile(s.pubkey)),["stop"])),style:(0,o.j5)([{gap:"0.1rem"},s.alignRight?"text-align: right;":"text-align: left"])},[e.$store.getters.name(s.pubkey)?((0,n.wg)(),(0,n.iD)("div",ie,[(0,n.Uk)((0,o.zw)(e.$store.getters.name(s.pubkey))+" ",1),s.showFollowing&&r.isFollow?((0,n.wg)(),(0,n.j4)(c,{key:0,name:"visibility",size:s.headerMode?"sm":"xs",color:"secondary"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{class:"tooltip",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,n.w5)((()=>[ae])),_:1})])),_:1},8,["size"])):(0,n.kq)("",!0)])):(0,n.kq)("",!0),(0,n._)("div",{class:"flex row no-wrap items-center",style:(0,o.j5)(s.headerMode?"gap: .3rem;":"gap: .1rem;")},[(0,n.Wm)(u,{pubkey:s.pubkey,"button-size":s.headerMode?"sm":"xs"},null,8,["pubkey","button-size"]),e.$store.getters.NIP05Id(s.pubkey)?((0,n.wg)(),(0,n.iD)("div",le,(0,o.zw)(s.headerMode?r.niceNIP05:r.niceShortNIP05),1)):(0,n.kq)("",!0)],4),s.headerMode&&e.lnurlToLnAddr(e.$store.getters.profileLud06(s.pubkey))?((0,n.wg)(),(0,n.iD)("div",re," ⚡️"+(0,o.zw)(e.lnurlToLnAddr(e.$store.getters.profileLud06(s.pubkey))),1)):(0,n.kq)("",!0)],6)}s(46727);const ce={class:"flex row justify-end"},ue={class:"overflow-auto"},pe={class:"text-subtitle1 flex row overflow-auto items-end q-gutter-sm"},he=(0,n.Uk)(" NIP-05 Identifier "),ge=["href"],me={key:0},ye=(0,n._)("div",null,[(0,n.Uk)(" Learn how to get NIP-05 verified "),(0,n._)("a",{href:"https://gist.github.com/metasikander/609a538e6a03b2f67e5c8de625baed3e",target:"_"},"here")],-1),fe=(0,n.Uk)(" NIP-05 VERIFIED ");function we(e,t,s,a,l,r){const d=(0,n.up)("q-btn"),c=(0,n.up)("q-spinner-orbit"),u=(0,n.up)("q-inner-loading"),p=(0,n.up)("q-card-section"),h=(0,n.up)("q-card"),g=(0,n.up)("q-dialog"),m=(0,n.up)("q-tooltip"),y=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(g,{modelValue:l.NIP05Dialog,"onUpdate:modelValue":t[0]||(t[0]=e=>l.NIP05Dialog=e)},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,n.w5)((()=>[(0,n._)("div",ce,[(0,n.wy)((0,n.Wm)(d,{icon:"close",flat:"",dense:""},null,512),[[y]])]),(0,n._)("div",ue,[(0,n.Wm)(p,null,{default:(0,n.w5)((()=>[(0,n._)("div",pe,[he,(0,n._)("a",{href:r.NIP05Link,target:"_"},(0,o.zw)(r.NIP05Link),9,ge)]),r.NIP05Loaded?((0,n.wg)(),(0,n.iD)("pre",me,(0,o.zw)(r.NIP05Formatted),1)):(0,n.kq)("",!0),(0,n.Wm)(u,{showing:!r.NIP05Loaded},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{color:"accent",size:"2rem"})])),_:1},8,["showing"]),ye])),_:1})])])),_:1})])),_:1},8,["modelValue"]),e.$store.getters.NIP05Id(s.pubkey)?((0,n.wg)(),(0,n.j4)(d,{key:0,icon:"verified",color:"info",flat:"",dense:"",size:s.buttonSize,class:"no-padding",clickable:"",onClick:(0,i.iM)(r.openNIP05,["stop"])},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,n.w5)((()=>[fe])),_:1})])),_:1},8,["size","onClick"])):(0,n.kq)("",!0)],64)}var be=s(33688),ve=s.n(be),ke=s(6827);const xe={mixins:[Z.Z],props:{pubkey:{type:String,required:!0},buttonSize:{type:String,default:"xs"}},data(){return{NIP05Dialog:!1,NIP05Data:{}}},computed:{NIP05Link(){let[e,t]=this.$store.getters.NIP05Id(this.pubkey).split("@");return t||(t=e,e="_"),`https://${t}/.well-known/nostr.json?name=${e}`},NIP05Formatted(){return this.json(this.NIP05Data)},NIP05Loaded(){return!!Object.keys(this.NIP05Data).length}},methods:{openNIP05(){this.loadNIP05Data(),this.NIP05Dialog=!this.NIP05Dialog},async loadNIP05Data(){try{this.NIP05Data=await(await ve()(this.NIP05Link)).json()}catch(e){ke.Z.create({message:"❌ Failed to fetch NIP-05 Identifier",color:"negative",classes:"notify"})}}}};var Ce=s(87743),Me=s(44458),_e=s(63190),Te=s(60854),qe=s(10786),Be=s(62146);const Se=(0,N.Z)(xe,[["render",we]]),$e=Se;se()(xe,"components",{QDialog:Ce.Z,QCard:Me.Z,QBtn:H.Z,QCardSection:_e.Z,QInnerLoading:Te.Z,QSpinnerOrbit:qe.Z,QTooltip:X.Z}),se()(xe,"directives",{ClosePopup:Be.Z});const Ee={mixins:[Z.Z],components:{BaseButtonNIP05:$e},props:{pubkey:{type:String,required:!0},wrap:{type:Boolean,default:!1},alignRight:{type:Boolean,default:!1},headerMode:{type:Boolean,default:!1},showFollowing:{type:Boolean,default:!1}},computed:{niceShortNIP05(){let e=this.$store.getters.NIP05Id(this.pubkey).split("@").map(((e,t)=>0===t&&e===this.$store.getters.name(this.pubkey)?"":e)).join("@");return e.startsWith("_@")?e.replace("_@",""):e},niceNIP05(){return this.$store.getters.NIP05Id(this.pubkey).split("@").map(((e,t)=>0===t&&"_"===e?"":e)).join("@")},isFollow(){return this.$store.state.follows.includes(this.pubkey)}}},ze=(0,N.Z)(Ee,[["render",de]]),Ze=ze;se()(Ee,"components",{QIcon:Y.Z,QTooltip:X.Z});const We=["src"];function Re(e,t,s,a,l,r){const d=(0,n.up)("BaseButtonNIP05"),c=(0,n.up)("q-avatar");return(0,n.wg)(),(0,n.iD)("div",{style:{"margin-right":"10px","margin-left":"5px"},class:(0,o.C_)((s.bordered?"bordered-avatar":"")+(s.hoverEffect?" hovered-avatar":""))},[(0,n.Wm)(c,{rounded:!s.round,class:"relative-position",size:s.size,onClick:t[0]||(t[0]=(0,i.iM)((t=>e.toProfile(s.pubkey)),["stop"]))},{default:(0,n.w5)((()=>[(0,n._)("img",{src:e.$store.getters.avatar(s.pubkey),loading:"lazy",async:""},null,8,We),(0,n._)("div",{class:(0,o.C_)([s.alignRight?"icon-right":"icon-left","q-pt-xs"])},[s.showVerified?((0,n.wg)(),(0,n.j4)(d,{key:0,pubkey:s.pubkey,"button-size":"xs"},null,8,["pubkey"])):(0,n.kq)("",!0)],2)])),_:1},8,["rounded","size"])],2)}const je={mixins:[Z.Z],components:{BaseButtonNIP05:$e},props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,default:!0},size:{type:String,default:""},round:{type:Boolean,default:!1},bordered:{type:Boolean,default:!0},showVerified:{type:Boolean,default:!0},hoverEffect:{type:Boolean,default:!1}}};var Pe=s(61357);const Le=(0,N.Z)(je,[["render",Re],["__scopeId","data-v-21ff1cd8"]]),De=Le;se()(je,"components",{QAvatar:Pe.Z});var Ue=s(15554);const Ie=e=>((0,n.dD)("data-v-487d418d"),e=e(),(0,n.Cn)(),e),Ne={key:1,clickable:!1,class:"embeded-message q-px-md q-py-md"},Oe={class:"relative-position"},Ae={key:0,class:"flex row items-center",style:{gap:"0.3rem"}},Fe={class:"input-area"},He={id:"input-placeholder"},Qe={id:"input-readonly-highlight",contenteditable:"true",spellcheck:"false"},Ve=["contenteditable"],Ke=Ie((()=>(0,n._)("div",{id:"input-readonly",contenteditable:"true",spellcheck:"false"},null,-1))),Je={key:0,class:"absolute-top full-width row justify-center q-my-md"},Ye={style:{"font-size":"0.9rem"}},Xe={key:0,class:"q-pl-xs"},Ge=Ie((()=>(0,n._)("div",{class:"text-secondary"},"links added",-1))),et={dense:"",style:{"font-size":"0.8rem","font-weight":"300"}},tt={class:"col-11",style:{"overflow-x":"auto"}},st={class:"flex row justify-between"},nt=Ie((()=>(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[(0,n._)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),(0,n._)("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})],-1))),ot=(0,n.Uk)(" ADD EMOJI "),it=(0,n.Uk)(" ADD A LINK "),at=(0,n.Uk)(" HOW TO MENTION USERS AND POSTS "),lt=Ie((()=>(0,n._)("div",null,[(0,n._)("span",{class:"text-bold"},(0,o.zw)("ADD USER: ")),(0,n.Uk)(" "+(0,o.zw)("Type @ and select user from the dropdown menu that pops up, or paste user's public key"))],-1))),rt=Ie((()=>(0,n._)("span",{class:"text-bold"},(0,o.zw)("ADD POST: "),-1))),dt=(0,n.Uk)("Paste the event ID, which can be copied from the "),ct=(0,n.Uk)(' button at the bottom of every post"'),ut=(0,n.Uk)(" CANCEL "),pt={key:1,class:"char-left-label"},ht={key:0,class:"over-limit"},gt=(0,n.Uk)(" SHORT FORM POST "),mt=(0,n.Uk)(" LONG FORM LOST ");function yt(e,t,s,a,l,r){const d=(0,n.up)("BasePost"),c=(0,n.up)("q-btn"),u=(0,n.up)("BaseMessage"),p=(0,n.up)("q-list"),h=(0,n.up)("q-icon"),g=(0,n.up)("BaseUserAvatar"),m=(0,n.up)("q-spinner-orbit"),y=(0,n.up)("q-tooltip"),f=(0,n.up)("q-btn-toggle"),w=(0,n.up)("q-separator"),b=(0,n.up)("BaseEmojiPicker"),v=(0,n.up)("q-tab-panel"),k=(0,n.up)("BaseLinkForm"),x=(0,n.up)("q-tab-panels"),C=(0,n.up)("q-item"),M=(0,n.up)("q-circular-progress"),_=(0,n.up)("q-btn-group");return(0,n.wg)(),(0,n.j4)(C,{unelevated:"",class:"q-pa-none post-entry-form flex column",ref:"postEntry",onClick:t[20]||(t[20]=(0,i.iM)((()=>{}),["stop"])),onMouseup:t[21]||(t[21]=(0,i.iM)((()=>{}),["stop"])),onKeypress:t[22]||(t[22]=(0,i.D2)((0,i.iM)((()=>{}),["stop"]),["enter"])),onKeydown:t[23]||(t[23]=(0,i.iM)((()=>{}),["stop"])),onKeyup:t[24]||(t[24]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>["quote"===s.replyMode||"repost"===s.replyMode?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,o.C_)(["reposts flex column q-px-sm q-py-xs","quote"===s.replyMode?"q-mb-sm":""]),clickable:!1},[(0,n.Wm)(d,{event:s.event,clickable:!1,"is-embeded":!0,"reply-depth":-1},null,8,["event"])],2)):(0,n.kq)("",!0),"reply"===s.messageMode&&s.event?((0,n.wg)(),(0,n.iD)("div",Ne,[(0,n._)("div",Oe,[(0,n.Wm)(c,{icon:"close",flat:"",dense:"",onClick:t[0]||(t[0]=(0,i.iM)((t=>e.$emit("clear-event")),["stop"])),size:"xs",class:"absolute-top-right z-top"})]),s.event?((0,n.wg)(),(0,n.j4)(u,{key:0,event:s.event,clickable:!1,"is-embeded":!0},null,8,["event"])):(0,n.kq)("",!0)])):(0,n.kq)("",!0),(0,n.wy)((0,n._)("div",{class:"relative-position full-width",style:{gap:"5px"},onClick:t[9]||(t[9]=(0,i.iM)((()=>{}),["stop"]))},[(0,n.Wm)(p,{id:"tribute-wrapper",class:"overflow-auto flex row z-top",style:{"max-height":"40vh"},onClick:(0,i.iM)(l.focusInput,["stop"])},null,8,["onClick"]),!s.messageMode&&l.replyUserTags.length&&"embed"!==this.replyMode?((0,n.wg)(),(0,n.iD)("div",Ae,[(0,n.Wm)(h,{name:"alternate_email",color:"secondary",size:"sm"}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.replyUserTags,(t=>((0,n.wg)(),(0,n.j4)(c,{key:t,color:"secondary",outline:"",rounded:"",label:e.$store.getters.displayName(t),icon:"close",dense:"",size:"sm",class:"q-pr-sm","no-caps":"",onClick:(0,i.iM)((e=>r.removeReplyUserTag(t)),["stop"])},null,8,["label","onClick"])))),128))])):(0,n.kq)("",!0),(0,n._)("div",Fe,[(0,n.Wm)(g,{pubkey:e.$store.state.keys.pub,class:"avatar-image"},null,8,["pubkey"]),(0,n._)("span",He,(0,o.zw)(r.placeholderText),1),(0,n.wy)((0,n._)("div",Qe,null,512),[[i.F8,!l.longForm]]),(0,n._)("div",{id:"input-editable",contenteditable:!l.sending&&!l.mentionsUpdating,style:(0,o.j5)(l.mentionsUpdating?"opacity: .7;":""),onInput:t[1]||(t[1]=(...e)=>r.updateText&&r.updateText(...e)),onKeypress:[t[2]||(t[2]=(0,i.D2)(((...e)=>r.updateText&&r.updateText(...e)),["delete"])),t[5]||(t[5]=(0,i.D2)((0,i.iM)(((...e)=>r.send&&r.send(...e)),["ctrl"]),["enter"]))],onFocus:t[3]||(t[3]=(...e)=>r.textareaFocus&&r.textareaFocus(...e)),onBlur:t[4]||(t[4]=(...e)=>r.textareaBlur&&r.textareaBlur(...e)),onClick:t[6]||(t[6]=(0,i.iM)(((...e)=>r.updateText&&r.updateText(...e)),["stop"])),onTouchstart:t[7]||(t[7]=(0,i.iM)((()=>{}),["stop"])),onMousedown:t[8]||(t[8]=(0,i.iM)((()=>{}),["stop"]))},null,44,Ve),Ke,l.mentionsUpdating?((0,n.wg)(),(0,n.iD)("div",Je,[(0,n.Wm)(m,{color:"accent",size:"md"})])):(0,n.kq)("",!0)])],512),[[i.F8,"repost"!==s.replyMode]]),(0,n._)("div",Ye,[l.links.length?((0,n.wg)(),(0,n.iD)("div",Xe,[Ge,(0,n._)("ul",et,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.links,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t,class:"flex row justify-between no-wrap",dense:""},[(0,n._)("div",tt,[(0,n._)("strong",null,(0,o.zw)(r.linkName(e)),1),(0,n._)("span",null,(0,o.zw)(e.url),1)]),(0,n.Wm)(c,{icon:"remove_circle",clickable:"",onClick:(0,i.iM)((e=>r.removeLink(t)),["stop"]),flat:"",color:"negative",size:"xs",class:"no-padding"},null,8,["onClick"])])))),128))])])):(0,n.kq)("",!0)]),(0,n._)("div",{class:(0,o.C_)(["flex justify-between",l.toolSelected?"column":"row"]),onClick:t[19]||(t[19]=(0,i.iM)((()=>{}),["stop"]))},[(0,n._)("div",st,[(0,n.wy)((0,n.Wm)(f,{modelValue:l.toolSelected,"onUpdate:modelValue":t[13]||(t[13]=e=>l.toolSelected=e),class:(0,o.C_)(["flex",l.toolSelected?"column":"row"]),dense:"",unelevated:"","toggle-color":"","toggle-text-color":"accent",options:[{value:"emoji",slot:"emoji"},{value:"link",slot:"link"},{value:"help",slot:"help"}]},{emoji:(0,n.w5)((()=>[(0,n.Wm)(c,{unelevated:"",class:"no-padding button-emoji",dense:"",size:"sm",onClick:t[10]||(t[10]=(0,i.iM)((e=>r.toggleTool("emoji")),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[nt])),_:1}),(0,n.Wm)(y,{class:"tooltip"},{default:(0,n.w5)((()=>[ot])),_:1})])),_:1})])),link:(0,n.w5)((()=>[(0,n.Wm)(c,{style:{"margin-left":"5px"},unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[11]||(t[11]=(0,i.iM)((e=>r.toggleTool("link")),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{name:"add_link",size:"sm"}),(0,n.Wm)(y,{class:"tooltip"},{default:(0,n.w5)((()=>[it])),_:1})])),_:1})])),help:(0,n.w5)((()=>[(0,n.Wm)(c,{style:{"margin-left":"5px"},unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[12]||(t[12]=(0,i.iM)((e=>r.toggleTool("help")),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{name:"info",size:"xs"}),(0,n.Wm)(y,{class:"tooltip"},{default:(0,n.w5)((()=>[at])),_:1})])),_:1})])),_:1},8,["modelValue","class"]),[[i.F8,"repost"!==s.replyMode]]),l.toolSelected?((0,n.wg)(),(0,n.j4)(C,{key:0,class:"col toolbox no-padding",ref:"toolbox"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{vertical:"",color:"accent",size:"1px"}),(0,n.Wm)(x,{modelValue:l.toolSelected,"onUpdate:modelValue":t[17]||(t[17]=e=>l.toolSelected=e),class:"no-padding full-width"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{name:"emoji",class:"no-padding",onClick:t[14]||(t[14]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{onEmojiSelected:r.insertEmoji,"per-line":r.emojiPerRow,class:"full-width"},null,8,["onEmojiSelected","per-line"])])),_:1}),(0,n.Wm)(v,{name:"link",class:"q-pa-xs",onClick:t[15]||(t[15]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{links:l.links,onLinkAdded:r.addLink},null,8,["links","onLinkAdded"])])),_:1}),(0,n.Wm)(v,{name:"help",class:"q-pa-xs",onClick:t[16]||(t[16]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>[lt,(0,n._)("div",null,[rt,(0,n._)("span",null,[dt,(0,n.Wm)(h,{name:"link",size:"sm"}),ct])])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,n.kq)("",!0)]),(0,n.Wm)(_,{class:"flex items-center",unelevated:""},{default:(0,n.w5)((()=>[l.toolSelected?((0,n.wg)(),(0,n.j4)(c,{key:0,icon:"close",unelevated:"",class:"col button-close",dense:"",onClick:(0,i.iM)(r.closeTools,["stop"])},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{class:"tooltip"},{default:(0,n.w5)((()=>[ut])),_:1})])),_:1},8,["onClick"])):(0,n.kq)("",!0),l.text&&!s.messageMode?((0,n.wg)(),(0,n.iD)("div",pt,[r.charLeft()<=0&&!l.longForm?((0,n.wg)(),(0,n.iD)("span",ht,(0,o.zw)(r.charLeft()),1)):(0,n.kq)("",!0),r.charLeft()>0?((0,n.wg)(),(0,n.j4)(M,{key:1,"show-value":r.charLeft()<=25,value:l.text.length%l.charLimit/l.charLimit*100,size:r.charLeft()<=25?"1.5rem":"1.2rem","font-size":".6rem",thickness:r.charLeft()<=25?.2:.1,color:r.charLeft()<=25?"warning":"secondary","track-color":"transparent",class:"no-padding","instant-feedback":""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(r.charLeft()),1)])),_:1},8,["show-value","value","size","thickness","color"])):(0,n.kq)("",!0)])):(0,n.kq)("",!0),!s.messageMode&&r.charLeft()<=0?((0,n.wg)(),(0,n.j4)(f,{key:2,modelValue:l.longForm,"onUpdate:modelValue":t[18]||(t[18]=e=>l.longForm=e),unelevated:"",dense:"","toggle-color":"primary",style:{border:"1px solid var(--q-primary)"},"text-color":"primary",class:"q-ml-md",options:[{value:!1,slot:"short"},{value:!0,slot:"long"}]},{short:(0,n.w5)((()=>[(0,n.Wm)(h,{name:"short_text",size:"xs",style:(0,o.j5)(l.longForm?"":"color: var(--q-background)")},null,8,["style"]),(0,n.Wm)(y,{class:"tooltip"},{default:(0,n.w5)((()=>[gt])),_:1})])),long:(0,n.w5)((()=>[(0,n.Wm)(h,{name:"format_align_left",size:"xs",style:(0,o.j5)(l.longForm?"color: var(--q-background)":"")},null,8,["style"]),(0,n.Wm)(y,{class:"tooltip"},{default:(0,n.w5)((()=>[mt])),_:1})])),_:1},8,["modelValue"])):(0,n.kq)("",!0),(0,n.Wm)(c,{flat:"",unelevated:"",color:"primary",type:"submit",onClick:(0,i.iM)(r.send,["stop"]),disable:!r.textValid()},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{name:"send",style:(0,o.j5)("transform: translateX("+l.sendIconTranslation+"px);")},null,8,["style"])])),_:1},8,["onClick","disable"])])),_:1})],2)])),_:1},512)}var ft=s(75103),wt=s(26041);function bt(e,t,s,o,a,l){const r=(0,n.up)("Picker");return(0,n.wg)(),(0,n.j4)(r,{data:a.emojiIndex,set:"google","emoji-size":22,"per-line":s.perLine,"show-preview":!1,"show-skin-tomes":!1,onSelect:l.emojiSelected,onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"]))},null,8,["data","per-line","onSelect"])}var vt=s(32859),kt=s(71556);let xt=new kt.xd(vt);const Ct={name:"BaseEmojiPicker",emits:["emoji-selected"],props:{perLine:{type:Number,required:!0}},components:{Picker:kt.cW},data(){return{emojiIndex:xt}},methods:{emojiSelected(e){this.$emit("emoji-selected",e)}}},Mt=(0,N.Z)(Ct,[["render",bt]]),_t=Mt;function Tt(e,t,s,i,a,l){const r=(0,n.up)("q-input"),d=(0,n.up)("q-btn"),c=(0,n.up)("q-form");return(0,n.wg)(),(0,n.j4)(c,{onSubmit:t[2]||(t[2]=e=>l.addLink({url:a.url,name:a.name})),class:"no-padding flex row items-center no-wrap justify-between"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{modelValue:a.url,"onUpdate:modelValue":t[0]||(t[0]=e=>a.url=e),type:"url",label:"url",dense:"",outlined:"",autofocus:"",color:"accent",class:"no-padding col-9"},null,8,["modelValue"]),(0,n.Wm)(r,{modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=e=>a.name=e),label:"url name",disable:0===a.url.length,outlined:"",dense:"",color:"accent",class:"no-padding col-2"},null,8,["modelValue","disable"]),(0,n.Wm)(d,{icon:"add",type:"submit",disable:!a.validUrl,outline:"",round:"",color:"accent",size:"sm",class:(0,o.C_)(["no-padding",a.validUrl?"pulse-button":""])},null,8,["disable","class"])])),_:1})}const qt={name:"BaseLinkForm",emits:["link-added","link-removed"],props:{links:{type:Array,required:!0}},data(){return{url:"",name:"",validUrl:!1}},watch:{async url(e,t){if(e)try{this.validUrl=Boolean(new URL(e))}catch(s){this.validUrl=!1}else this.validUrl=!1}},methods:{linkName(e){return e.name?`${e.name}: `:""},addLink(e){0===e.name.length&&delete e.name,this.$emit("link-added",e),this.url="",this.name=""},removeLink(e){this.$emit("link-removed",e)}}};var Bt=s(8326),St=s(66611);const $t=(0,N.Z)(qt,[["render",Tt],["__scopeId","data-v-3b53e1cf"]]),Et=$t;se()(qt,"components",{QForm:Bt.Z,QInput:St.Z,QBtn:H.Z});var zt=s(40930),Zt=s(34136);const{getPaletteColor:Wt}=ft.ZP,Rt={name:"BasePostEntry",mixins:[Z.Z],emits:["sent","resized","clear-event"],components:{BaseEmojiPicker:_t,BaseLinkForm:Et,BaseMessage:zt.Z},props:{messageMode:{type:String,required:!1,default:""},replyMode:{type:String,required:!1,default:""},event:{type:Object,required:!1,default:null},autoFocus:{type:Boolean,default:!0}},data(){return{text:"",charLimit:280,sending:!1,toolSelected:"",sendIconTranslation:0,tags:[],mentionsUpdating:!1,focusInput(){setTimeout((async()=>{await this.$nextTick(),this.textarea.focus()}),1)},trigger:1,links:[],textareaRange:null,longForm:!1,replyUserTags:[]}},watch:{text(e,t){this.updateMentionsTags()},replyMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())},messageMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())}},computed:{postEntry(){return this.$refs.postEntry.$el},textarea(){return this.postEntry.querySelector("#input-editable")},readonlyTextarea(){return this.postEntry.querySelector("#input-readonly")},readonlyHighlightTextarea(){return this.postEntry.querySelector("#input-readonly-highlight")},placeholder(){return this.postEntry.querySelector("#input-placeholder")},profileMentionsProvider(){return this.createMentionsProvider()},postEntryWidth(){return this.$refs.postEntry?.$el?.clientWidth},toolboxWidth(){return this.toolSelected?this.$refs.toolbox?.$el?.clientWidth:0},emojiPerRow(){return this.toolboxWidth?Math.floor((this.toolboxWidth-10)/25):0},label(){if("reply"===this.messageMode)return"what's your reply?";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought?"}return"what's happening?"},placeholderText(){if(this.text.length)return"";if("reply"===this.messageMode)return"reply to message";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought on this?"}return"what's happening?"},textareaMentions(){return this.mentions()},hashtags(){if(0===this.text.length)return[];const e=/(?<s>^|[\s])#(?<i>[\w]{1,63})/g;let t=this.innertext.matchAll(e),s=[];for(let n of t)s.push(n.groups.i.toLowerCase());return s},caretRange(){const e="undefined"!==typeof window.getSelection;if(e&&this.trigger){const e=window.getSelection();if(0!==e.rangeCount){const t=e.getRangeAt(0);return t}}return null},hexPubkey(){return this.$route.params.pubkey?this.bech32ToHex(this.$route.params.pubkey):""}},mounted(){this.messageMode||this.profileMentionsProvider.attach(this.textarea),this.replyMode&&(this.replyUserTags=this.getReplyUserTags()),this.autoFocus&&this.focusInput(),this.$emit("resized")},activated(){},beforeUnmount(){this.messageMode||this.profileMentionsProvider.detach(this.textarea),this.reset(),this.$emit("resized")},methods:{updateText(e){this.trigger++,this.text=this.textarea.textContent,this.innertext=this.textarea.innerText,this.textareaRange=this.caretRange||this.textareaRange,this.updateReadonlyInput(),this.messageMode||this.updateReadonlyHightlightInput()},async send(){if(!this.textValid())return void console.log("text not valid");if(this.sending)return void console.log("send already in progress");let e;this.toolSelected="",this.sending=!0,this.animateSendIcon(),this.updateText(),await this.extractMentions(this.textarea,this.tags),e=this.replyMode?await this.sendReply():this.messageMode?await this.sendMessage():await this.sendPost(),e&&(this.messageMode||this.interpolateEventMentions(e),this.reset(),this.$emit("sent",e),this.replyMode||this.messageMode||this.toEvent(e.id)),this.sending=!1},async sendPost(){let e=Object.values(this.mentions()).map((e=>e.tag)),t=await this.formatMentionsForPublishing(e);this.appendHashtags(e),t=this.appendLinks(t);let s=await this.$store.dispatch("sendPost",{message:t,tags:e});if(s)return s},async sendReply(){"repost"===this.replyMode&&this.text&&(this.textarea.innerHTML="");let e=[],t=this.textarea.cloneNode(!0);this.replyUserTags.forEach((async t=>e.push(await(0,wt.l_)(t))));let s=this.event.tags.filter((([e,t])=>"e"===e&&t)).map((([...e])=>[...e]));if("quote"===this.replyMode||"repost"===this.replyMode){let s=await(0,wt.wn)(this.event.id,"mention");e.push(s),t.append(` #[${e.length-1}]`)}else{let t=s.find((([e,t,s,n])=>"e"===e&&"root"===n))||s.find((e=>"e"===e[0]&&!e[3]));t||1!==s.filter((([e,t,s,n])=>"e"===e&&"reply"===n)).length||(t=s.find((([e,t,s,n])=>"e"===e&&"reply"===n))),t?(e.push(await(0,wt.wn)(t[1],"root")),e.push(await(0,wt.wn)(this.event.id,"reply"))):e.push(await(0,wt.wn)(this.event.id,"root"))}let n=await this.formatMentionsForPublishing(e,!0,t);this.appendHashtags(e),n=this.appendLinks(n);let o=Object.keys(this.$store.state.relays).length?Object.keys(this.$store.state.relays):Object.keys(this.$store.state.defaultRelays);return(0,Zt.nY)((0,z.CX)(this.event),o),await this.$store.dispatch("sendPost",{message:n,tags:e})},async sendMessage(){let e=Math.round(Date.now()/1e3),t=[];t.find((([e,t])=>t===this.hexPubkey))||t.push(["p",this.hexPubkey]),this.event&&!t.find((([e,t])=>t===this.event.id))&&t.push(await(0,wt.wn)(this.event.id,"mention"));let s=await this.formatMentionsForPublishing(t,!1);return s=this.appendLinks(s),await this.$store.dispatch("sendChatMessage",{now:e,pubkey:this.hexPubkey,text:s,tags:t})},async extractMentions(e,t){const s=/(?<t>note|npub)(?<v>[a-z0-9]{59})\b/g,n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let o={},i=n.nextNode();while(i){let e=i.textContent;for(let n of e.matchAll(s)){let e=null;if("note"===n.groups.t)e="e";else{if("npub"!==n.groups.t)return;e="p"}let s=n[0],i=this.bech32ToHex(s),a=Object.entries(t),l=a.map((([e,t])=>t)).findIndex((([t,n])=>t===e&&n===s));if(-1!==l)o[s]=a[l][0];else if("e"===e){let e=`${this.shorten(s)}`;t[e]=await(0,wt.wn)(i,"mention"),o[s]=e}else{console.log("extract mentions",`"${s}"`,n);let e=`@${this.$store.getters.displayName(i)}`;t[e]=await(0,wt.l_)(i),o[s]=e}}e=e.replace(s,((e,t,s)=>o[e])),i.textContent=e,i=n.nextNode()}},mentions(e=this.textarea){if(0===this.text.length)return{};let t={};const s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let n=s.nextNode(),o=0;while(n){for(let[e,s]of Object.entries(this.tags)){const i=new RegExp(`(?<i>${e})\\b`,"g");let a=n.textContent.matchAll(i);for(let e of a)this.tags[e.groups.i]&&(t[o+"."+e.index+"_"+e.groups.i]={el:n,pos:e.index,tag:Array.from(s),length:e.groups.i.length})}n=s.nextNode(),o++}return t},async formatMentionsForPublishing(e,t=!0,s=this.textarea.cloneNode(!0)){let n=this.mentions(s),o={el:null,offset:null};for(let a in n){let s=n[a],i=e.findIndex((([e,t])=>e===s.tag[0]&&t===s.tag[1]));if(-1===i){let n;"p"===s.tag[0]&&t?n=await(0,wt.l_)(s.tag[1]):"e"===s.tag[0]&&(n=await(0,wt.wn)(s.tag[1],"mention")),n&&(e.push(n),i=e.length-1)}o.el&&o.el!==s.el&&(o.offset=0);let l=o.el&&o.el===s.el?o.offset:0,r=new Range;r.setStart(s.el,s.pos+l),r.setEnd(s.el,s.pos+s.length+l);let d="p"!==s.tag[0]||t?`#[${i}]`:`@${s.tag[1]}`;this.insertText(d,r),o={el:s.el,offset:d.length-s.length+o.offset||0}}s.style.maxHeight="0",this.postEntry.appendChild(s);let i=s.innerText;return s.remove(),i},async updateMentionsTags(){this.trigger++;let{start:e}=this.startEndOfRange();const t=/(?<t>note|npub)(?<v>[a-z0-9]{59})/g;this.text.toLowerCase().match(t)&&(this.mentionsUpdating=!0,await this.extractMentions(this.textarea,this.tags),"#text"===e.el.nodeName&&e.pos>e.el.length?this.setCaret(e.el,e.el.length):this.setCaret(e.el,e.pos),this.updateText(),console.log("updateMentionTags",this.tags),Object.keys(this.tags).filter((e=>"p"===this.tags[e][0])).forEach((e=>{this.replyUserTags.includes(this.tags[e][1])||this.replyUserTags.push(this.tags[e][1])})),this.mentionsUpdating=!1)},startEndOfRange(e=this.caretRange){return{start:{el:e.startContainer,pos:e.startOffset},end:{el:e.endContainer,pos:e.endOffset}}},insertText(e,t=this.textareaRange){let{start:s,end:n}=this.startEndOfRange(t),o=s.el.textContent.slice(0,s.pos)+e+n.el.textContent.slice(n.pos);if(t.isCollapsed||(t.deleteContents(),n.el!==s.el&&n.el.remove()),"#text"===s.el.nodeName)s.el.textContent=o,this.setCaret(s.el,s.pos+e.length);else{let t=document.createTextNode(o);s.el.insertBefore(t,s.el.firstChild),this.setCaret(t,e.length)}this.updateText()},insertEmoji(e){e.native&&(this.trigger++,this.insertText(e.native))},animateSendIcon(){let e=setInterval((()=>{if(!this.sending)return clearInterval(e),void(this.sendIconTranslation=0);this.sendIconTranslation+=3,this.sendIconTranslation>50&&(this.sendIconTranslation-=this.postEntryWidth+40)}),50)},closeTools(){this.toolSelected=""},toggleTool(e){this.updateText(),this.toolSelected===e?this.closeTools():this.toolSelected=e},reset(){this.closeTools(),this.text="",this.textarea.innerHTML="",this.readonlyTextarea.innerHTML="",this.readonlyHighlightTextarea.innerHTML="",this.tags=[],this.links=[],this.focusInput()},appendHashtags(e){for(let t of this.hashtags)e.find((([e,s])=>s===t))||e.push(["t",t.toLowerCase()])},appendLinks(e){for(let t of this.links)t.name?e+=`\n[${t.name}](${t.url})`:e+=`\n${t.url}`;return e},setCaret(e,t){const s="undefined"!==typeof window.getSelection;if(s&&e){const s=window.getSelection(),n=document.createRange();s.removeAllRanges(),n.selectNodeContents(e),n.collapse(!0),n.setStart(e,t),s.addRange(n),this.focusInput()}},addLink(e){this.links.push(e)},linkName(e){return e.name?`${e.name}: `:""},removeLink(e){this.links.splice(e,1)},textareaFocus(e){const t=this.placeholder;t.style.opacity=".3"},textareaBlur(e){const t=this.placeholder;t.style.opacity=".6"},colorText(e){let t=document.createElement("span");return t.innerHTML=e,t.style.color=Wt("secondary"),t},updateReadonlyInput(){let e=this.textarea.innerHTML,t=Object.assign({},this.mentions());for(let s in t){let[t,n]=s.split("_");const o=new RegExp(`(?<i>${n})\\b`,"g");e=e.replaceAll(o,((e,t)=>this.colorText(n).outerHTML))}this.readonlyTextarea.innerHTML=e},updateReadonlyHightlightInput(){if(this.overCharLimit()){this.readonlyHighlightTextarea.innerHTML=this.textarea.innerHTML;let{el:e,pos:t}=this.charPos(this.charLimit,this.readonlyHighlightTextarea),s=e.length&&e.length>t,n=new Range;n.setStart(e,t),n.setEndAfter(this.readonlyHighlightTextarea.lastChild);let o=n.extractContents(),i=[].map.call(o.childNodes,((e,t)=>{if(0===t&&s)return"#text"===e.nodeName?e.textContent:e.innerHTML;let n=document.createElement("span");return n.style.background=Wt("negative"),n.style.opacity=".6",n.innerHTML=e.innerHTML,e.innerHTML=n.outerHTML,e.outerHTML})).join(""),a=document.createElement("span");a.innerHTML=i,a.style.background=Wt("negative"),a.style.opacity=".6";let l=new Range;l.setStart(e,t),l.collapse(!0),l.insertNode(a)}else this.readonlyHighlightTextarea.innerHTML=""},charPos(e,t=this.textarea){for(var s of t.childNodes)if(3===s.nodeType){if(s.length>=e)return{el:s,pos:e,char:-1};e-=s.length}else{let t=this.charPos(e,s);if(-1===t.char)return t;e=t.char}return{char:e}},extractUrls(e){const t=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;return e=e.replace(t,(e=>(this.addLink({url:e}),""))),e},charLeft(){return this.charLimit-this.text.length},overCharLimit(){return this.charLeft()<0},textValid(){return"repost"===this.replyMode||(!!this.links.length||!!this.text.length&&(!!this.messageMode||(!!this.longForm||!this.overCharLimit())))},getReplyUserTags(){if(!this.event)return[];let e=Object.assign({},this.event);e.tags||(e.tags=[]);let t=e.tags.filter((([e,t])=>"p"===e&&this.isKey(t))).map((([...e])=>[...e])),s=t.filter((([e,t])=>"p"===e)).map((([e,t])=>t)).slice(0,9);return s.find((t=>t===e.pubkey))||s.push(e.pubkey),s=s.filter((e=>e!==this.$store.state.keys.pub)),s},removeReplyUserTag(e){let t=this.mentions();Object.keys(t).forEach((s=>{let n=t[s];if(n.tag[1]===e){let e=new Range;e.setStart(n.el,n.pos),e.setEnd(n.el,n.pos+n.length),this.insertText("",e),this.updateText()}}));let s=Object.keys(this.tags).find((t=>e===this.tags[t][1]));delete this.tags[s],this.replyUserTags=this.replyUserTags.filter((t=>e!==t))}}};var jt=s(490),Pt=s(13246),Lt=s(1389),Dt=s(50926),Ut=s(67236),It=s(11221),Nt=s(83302);const Ot=(0,N.Z)(Rt,[["render",yt],["__scopeId","data-v-487d418d"]]),At=Ot;se()(Rt,"components",{QItem:jt.Z,QBtn:H.Z,QList:Pt.Z,QIcon:Y.Z,QSpinnerOrbit:qe.Z,QBtnToggle:Lt.Z,QTooltip:X.Z,QSeparator:Dt.Z,QTabPanels:G.Z,QTabPanel:ee.Z,QBtnGroup:Ut.Z,QCheckbox:It.Z,QCircularProgress:Nt.Z});const Ft={key:0},Ht={key:1,class:"bottom-border"};function Qt(e,t,s,o,a,l){const r=(0,n.up)("BasePostThread",!0),d=(0,n.up)("BaseButtonShowMore"),c=(0,n.up)("BasePost"),u=(0,n.up)("q-list");return(0,n.wg)(),(0,n.j4)(u,{ref:"thread",class:"no-padding"},{default:(0,n.w5)((()=>[s.fetchRootReply&&(e.$store.state.eventsCache[l.reply]||e.$store.state.eventsCache[l.root])&&l.rootReplyThread.length?((0,n.wg)(),(0,n.iD)("div",Ft,[(0,n.Wm)(r,{events:l.rootReplyThread,"is-ancestors":""},null,8,["events"])])):(0,n.kq)("",!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.filledEvents,((t,o)=>((0,n.wg)(),(0,n.iD)("div",{key:t.id+o,class:"no-padding"},["FILLER"===t.id?((0,n.wg)(),(0,n.j4)(d,{key:0,root:t.root},null,8,["root"])):((0,n.wg)(),(0,n.j4)(c,{key:1,event:t,position:l.position(o),"reply-depth":s.replyDepth,"reply-count":t.replies?.length?t.replies.length:o===l.filledEvents.length-1?s.isAncestors?1:0:1,onResized:l.resize,onAddEvent:l.addEvent,onClick:(0,i.iM)((s=>e.toEvent(t.id)),["stop"])},null,8,["event","position","reply-depth","reply-count","onResized","onAddEvent","onClick"]))])))),128)),s.replyDepth&&0!==s.replyDepth||s.isAncestors?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",Ht))])),_:1},512)}var Vt=s(80517);const Kt={name:"BasePostThread",emits:["resized","add-event"],mixins:[Z.Z],props:{events:{type:Array,required:!0},isAncestors:{type:Boolean,default:!1},replyDepth:{type:Number,default:0},fetchRootReply:{type:Boolean,default:!1}},components:{BaseButtonShowMore:Vt.Z},data(){return{resizing:!1}},computed:{root(){return this.events[0]?.interpolated?.replyEvents?.length?this.events[0].interpolated.replyEvents[0]:null},reply(){return this.root&&this.events[0]?.interpolated?.replyEvents?.length>1?this.events[0].interpolated.replyEvents[1]:null},rootReplyThread(){let e=[];return this.reply&&this.$store.state.eventsCache[this.reply]&&(this.root&&this.$store.state.eventsCache[this.root]&&e.push(this.$store.state.eventsCache[this.root]),e.push(this.$store.state.eventsCache[this.reply])),e},filledEvents(){if(!this.resizing||this.resizing){if(0===this.events.length)return[];var e=[this.events[0]];if(1===this.events.length)return e;for(let t=1;t<this.events.length;t++){let s=this.events[t],n=this.events[t-1],o=s.interpolated.replyEvents||[];o.length&&o[o.length-1]!==n.id&&e.push({id:"FILLER",root:n.id}),e.push(s)}return e}}},mounted(){this.fetchRootReply&&(this.root&&this.$store.dispatch("useEvent",{id:this.root}),this.reply&&this.$store.dispatch("useEvent",{id:this.reply}))},methods:{position(e){return this.isAncestors?1===this.filledEvents.length||0===e?"first":(this.filledEvents.length,"middle"):1===this.filledEvents.length?this.rootReplyThread?.length?"last":"single":0===e?this.rootReplyThread?.length?"middle":"first":e===this.filledEvents.length-1?"last":"middle"},addEvent(e){console.log("basepostthread add-event",e),this.$emit("add-event",e)},resize(e){this.resizing=!this.resizing,this.$emit("resized")},threadWidth(){return this.$refs.thread?.$el?.clientWidth}}},Jt=(0,N.Z)(Kt,[["render",Qt]]),Yt=Jt;se()(Kt,"components",{QList:Pt.Z});const Xt={class:"text-h5 text-bold q-pt-md q-pb-sm q-px-sm gt-sm"},Gt={class:"text-primary text-bold q-pt-md q-pb-sm q-pl-xl lt-md"};function es(e,t,s,o,i,a){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",Xt,[(0,n.WI)(e.$slots,"default")]),(0,n._)("div",Gt,[(0,n.WI)(e.$slots,"default")])])}const ts=(0,n.aZ)({name:"BaseHeader",props:{separator:{type:Boolean,default:!0}}}),ss=(0,N.Z)(ts,[["render",es]]),ns=ss;se()(ts,"components",{QSeparator:Dt.Z});const os=({app:e})=>{e.component("BasePost",oe),e.component("BaseUserName",Ze),e.component("BaseUserAvatar",De),e.component("BaseUserCard",Ue.Z),e.component("BasePostEntry",At),e.component("BasePostThread",Yt),e.component("BaseHeader",ns)}},55635:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s(37912);const o={Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday",Sun:"Sun",Mon:"Mon",Tue:"Tue",Wed:"Wed",Thu:"Thu",Fri:"Fri",Sat:"Sat",second:"sec",day:"day",January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December",Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",UTC:"UTC",now:"now".toUpperCase(),s:"s",m:"m",h:"h",post:"Post".toUpperCase(),follow:"Follow".toUpperCase(),close:"Close".toUpperCase(),setUser:"Set User".toUpperCase(),read:"Read".toUpperCase(),write:"Write".toUpperCase(),reorderFollows:"Re-order Follows".toUpperCase(),cancel:"Cancel".toUpperCase(),save:"Save".toUpperCase(),searchProfiles:"Search Profiles".toUpperCase(),searchPosts:"Search Posts".toUpperCase(),feed:"Feed".toUpperCase(),notifications:"Notifications".toUpperCase(),messages:"Messages".toUpperCase(),inbox:"Inbox".toUpperCase(),settings:"Settings".toUpperCase(),thread:"Thread".toUpperCase(),event:"Event".toUpperCase(),devTools:"DevTools".toUpperCase(),notFound:"Oops. Nothing here...",follows:"Follows".toUpperCase(),followers:"Followers".toUpperCase(),replies:"Replies".toUpperCase(),profile:"Profile".toUpperCase(),relays:"Relays".toUpperCase(),faq:"FAQ",users:"Users".toUpperCase(),nip05Maintainer:"NIP-05 Maintainer".toUpperCase(),inactiveRelays:"Inactive Relays".toUpperCase(),preferences:"Preferences".toUpperCase(),colors:"Colors".toUpperCase(),font:"Font".toUpperCase(),lightningTips:"Lightning Tips".toUpperCase(),noFollows:"No Follows".toUpperCase(),noFollowers:"No Followers".toUpperCase(),noRelays:"No Relays".toUpperCase(),dragDropReorder:"Drag & Drop to re-order".toUpperCase()},i={en:o},a=({app:e})=>{const t=(0,n.o)({locale:"en",fallbackLocale:"en",globalInjection:!0,messages:i});e.use(t)}},34136:(e,t,s)=>{"use strict";s.d(t,{$1:()=>q,$d:()=>_,AF:()=>x,Fp:()=>f,GG:()=>d,Kk:()=>p,LB:()=>M,Lh:()=>h,TE:()=>z,Uk:()=>$,Xp:()=>g,Y8:()=>l,cp:()=>c,dq:()=>C,hG:()=>b,hl:()=>w,mX:()=>Z,mw:()=>S,nY:()=>r,pe:()=>y,sf:()=>B,so:()=>k,t_:()=>E,u$:()=>m,uA:()=>T,vw:()=>u,w8:()=>v});const n=new Worker(new URL(s.p+s.u(399),s.b)),o={};function i(e,t){let s=e+" "+Math.random().toString().slice(-4);return n.postMessage(JSON.parse(JSON.stringify({id:s,name:e,args:t,call:!0}))),new Promise(((e,t)=>{o[s]={resolve:e,reject:t}}))}function a(e,t,s,i){let a=e+" "+Math.random().toString().slice(-4);return o[a]={cb:s,eoseCb:i},n.postMessage(JSON.stringify({id:a,name:e,args:t,stream:!0})),{update(...t){n.postMessage(JSON.stringify({id:a,name:e,args:t,stream:!0}))},cancel(){n.postMessage(JSON.stringify({id:a,cancel:!0})),delete o[a]}}}async function l(){return i("getRelayStatus",[])}async function r(e,t){return i("publish",[e,t])}async function d(e={}){return i("getFeed",[e])}async function c(e={}){return i("getProfiles",[e])}async function u(e={}){return i("getEvents",[e])}async function p(e={}){return i("getNotes",[e])}async function h(e={},t=(()=>{}),s=(()=>{})){return a("streamMainProfilesFollows",[e],t,s)}async function g(e={},t=(()=>{}),s=(()=>{})){return a("streamMainMentions",[e],t,s)}async function m(e={},t=(()=>{}),s=(()=>{})){return a("streamMainIncomingMessages",[e],t,s)}async function y(e={},t=(()=>{}),s=(()=>{})){return a("streamMainOutgoingMessages",[e],t,s)}async function f(e={},t=(()=>{}),s=(()=>{})){return a("streamPeerIncomingMessages",[e],t,s)}async function w(e={},t=(()=>{}),s=(()=>{})){return a("streamPeerOutgoingMessages",[e],t,s)}async function b(e={},t=(()=>{}),s=(()=>{})){return a("streamProfile",[e],t,s)}async function v(e={},t=(()=>{}),s=(()=>{})){return a("dbStreamEvent",[e],t,s)}async function k(e={},t=(()=>{}),s=(()=>{})){return a("dbStreamFollows",[e],t,s)}async function x(e={},t=(()=>{}),s=(()=>{})){return a("dbStreamFollowers",[e],t,s)}async function C(e={},t=(()=>{}),s=(()=>{})){return a("dbStreamTagKind",[e],t,s)}async function M(e){return i("dbSave",[e])}async function _(e){return i("dbQuery",[e])}async function T(e){return i("dbEvent",[e])}async function q(e){return i("dbProfile",[e])}async function B(e){return i("dbFollows",[e])}async function S(e){return i("dbChats",[e])}async function $(e,t,s=50,n=Math.round(Date.now()/1e3)){return i("dbMessages",[e,t,s,n])}async function E(e,t=40,s=Math.round(Date.now()/1e3)){return i("dbMentions",[e,t,s])}async function z(e,t,s=0){return i("dbUnreadMessagesCount",[e,t,s])}async function Z(e,t=0){return i("dbUnreadMentionsCount",[e,t])}n.onmessage=e=>{let{id:t,success:s,error:n,data:i,stream:a,type:l,notice:r,eose:d}="string"===typeof e.data?JSON.parse(e.data):e.data;if(!l&&!r)if(d)o[t]&&o[t].eoseCb&&o[t].eoseCb();else if(a)s?o[t]&&o[t].cb&&o[t].cb(i):console.log("ERROR",t,"~>>",i,o[t],n);else{if(!s)return o[t].reject(new Error(n)),void delete o[t];o[t]?.resolve?.(i),delete o[t]}}},54927:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Ze});var n={};s.r(n),s.d(n,{NIP05Id:()=>k,avatar:()=>x,canEncryptDecrypt:()=>$,canSignEventsAutomatically:()=>S,contacts:()=>_,displayName:()=>v,hasMoreContacts:()=>T,hasName:()=>w,name:()=>b,namedProfiles:()=>f,profileDescription:()=>C,profileLud06:()=>M,unreadChats:()=>q,unreadNotifications:()=>B});var o={};s.r(o),s.d(o,{addContactListToCache:()=>H,addEventToCache:()=>A,addProfileToCache:()=>O,addRelay:()=>R,addToNIP05VerificationCache:()=>F,follow:()=>U,haveReadMessage:()=>K,haveReadNotifications:()=>Q,removeRelay:()=>j,reorderFollows:()=>N,saveRelays:()=>L,setConfig:()=>Y,setConfigLightningTips:()=>X,setDefaultRelays:()=>W,setFollows:()=>D,setKeys:()=>z,setRelayOpt:()=>P,setRelays:()=>Z,setUnreadMessages:()=>J,setUnreadNotifications:()=>V,unfollow:()=>I});var i={};s.r(i),s.d(i,{addEvent:()=>ce,handleAddingProfileEventToCache:()=>Be,initKeys:()=>ae,launch:()=>le,publishContactList:()=>he,publishEvent:()=>ye,recommendRelay:()=>me,restartMainSubscription:()=>de,sendChatMessage:()=>pe,sendPost:()=>ue,setMetadata:()=>ge,useEvent:()=>Te,useNip05:()=>qe,useProfile:()=>ke,walletModal:()=>ie});var a=s(76058),l=s(63703);const r=()=>window.location.hostname.endsWith(".onion"),d={"wss://nostr-pub.wellorder.net":{read:!0,write:!0},"wss://nostr.onsats.org":{read:!0,write:!0},"wss://nostr-relay.wlvs.space":{read:!0,write:!0},"wss://relay.damus.io":{read:!0,write:!0},"wss://nostr.zebedee.cloud":{read:!0,write:!1},"wss://relay.nostr.info":{read:!0,write:!0},"wss://nostr-pub.semisol.dev":{read:!0,write:!1},"wss://nostr.walletofsatoshi.com":{read:!0,write:!1}},c=["wss://nostr-pub.wellorder.net","wss://nostr.swiss-enigma.ch","wss://nostr.cercatrova.me","wss://relay.damus.io","wss://relayer.fiatjaf.com","wss://nostr.rocks","wss://rsslay.fiatjaf.com","wss://nostr.zebedee.cloud","wss://nostr-2.zebedee.cloud","wss://expensive-relay.fiatjaf.com","wss://freedom-relay.herokuapp.com/ws","wss://nostr-relay.freeberty.net","wss://offchain.pub","wss://nostr-relay.wlvs.space","wss://nostr.onsats.org","wss://nostr-relay.untethr.me","wss://nostr.semisol.dev","wss://nostr-pub.semisol.dev","wss://nostr-verified.wellorder.net","wss://nostr.drss.io","wss://nostr.unknown.place","wss://nostr.openchain.fr","wss://nostr.delo.software","wss://relay.nostr.info","wss://relay.minds.com/nostr/v1/ws","wss://nostr.zaprite.io","wss://nostr.oxtr.dev","wss://nostr.ono.re","wss://relay.grunch.dev","wss://relay.cynsar.foundation","wss://nostr.sandwich.farm","wss://relay.nostr.ch","wss://nostr.mom","wss://nostr.walletofsatoshi.com","wss://nostr-relay.alekberg.net","wss://nostr.developer.li","wss://relay.current.fyi"],u={"ws://jgqaglhautb4k6e6i2g34jakxiemqp6z4wynlirltuukgkft2xuglmqd.onion":{read:!0,write:!0},"ws://wagvwfrdrikrqzp7h3b5lwl6btyuttu7mqpeji35ljzq36ovzgjhsfqd.onion":{read:!0,write:!0}};function p(){const e=r()?u:d,t=r()?Object.keys(u):c;let s=l.Z.getItem("config"),{timestamps:n,preferences:o}=s||{},{lastUserMainSync:i=0,lastFeedLoad:a=0}=n||{},{color:p,font:h="Roboto",lightningTips:g}=o||{},{primary:m="#ffffff",secondary:y="#aaaaaa",accent:f="#777777",background:w="#1f1f1f"}=p||{},{enabled:b=!0,lastMode:v="copy",lastWallet:k=null,presets:x=[10,100,1e3],oneClick:C={enabled:!1,amount:10}}=g||{};return s={timestamps:{lastUserMainSync:i,lastFeedLoad:a},preferences:{color:{primary:m,secondary:y,accent:f,background:w},font:h,lightningTips:{enabled:b,lastMode:v,lastWallet:k,presets:x,oneClick:C}}},{keys:l.Z.getItem("keys")||{},walletModal:l.Z.getItem("walletModal")||!1,relays:l.Z.getItem("relays")||{},defaultRelays:e,optionalRelaysList:t,follows:l.Z.getItem("follows")||[],profilesCache:{},profilesCacheLRU:[],eventsCache:{},eventsCacheLRU:[],contactListCache:{},contactListCacheLRU:[],nip05VerificationCache:{},lastMessageRead:l.Z.getItem("lastMessageRead")||{},unreadMessages:{},lastNotificationRead:l.Z.getItem("lastNotificationRead")||0,unreadNotifications:0,config:s}}var h=s(61993),g=s.n(h),m=s(18933),y=s(31262);function f(e,t){return Object.entries(e.profilesCache).reduce(((e,[s,n])=>t.hasName(s)?[...e,{...n,pubkey:s}]:e),[])}function w(e){return t=>{let{name:s,nip05:n}=e.profilesCache[t]||{};return(s||n||"").length>0}}function b(e){return t=>{let{name:s}=e.profilesCache[t]||{};return s}}function v(e,t){return t=>{let{name:s,nip05:n}=e.profilesCache[t]||{};return n?n.startsWith("_@")?n.slice(2):n:s||m.Z.methods.shorten(m.Z.methods.hexToBech32(t,"npub"))}}function k(e){return t=>{let{nip05:s}=e.profilesCache[t]||{};return s}}function x(e){return t=>{let{picture:s="data:image/png;base64,"+new(g())(t,40).toString()}=e.profilesCache[t]||{};return s}}function C(e){return t=>{let{about:s=""}=e.profilesCache[t]||{};return s}}function M(e){return t=>{let{lud06:s,lud16:n}=e.profilesCache[t]||{};return s||n?y.P6.isLnurl(s)?s.toLowerCase():y.P6.isLightningAddress(n)?m.Z.methods.lnAddrToLnurl(n):null:null}}function _(e){return t=>e.contactListCache[t]}function T(e){return t=>e.contactListCache[t]?.length>6}function q(e){return delete e.unreadMessages[e.keys.pub],Object.values(e.unreadMessages).filter((e=>e)).length}function B(e){return e.unreadNotifications}function S(e){return Boolean(e.keys.priv||window.nostr)}function $(e){return Boolean(e.keys.priv||window.nostr&&window.nostr.nip04)}s(46727);var E=s(36836);function z(e,{mnemonic:t,priv:s,pub:n}={}){if(t||s||n||(t=E.Ev.generateSeedWords()),t){let e=E.Ev.seedFromWords(t);s=E.Ev.privateKeyFromSeed(e)}s&&(n=(0,E.$3)(s)),e.keys={priv:s,pub:n}}function Z(e,t){e.relays=t}function W(e,t){e.defaultRelays=t}function R(e,t){try{G(t),new URL(t)}catch(s){return}e.relays[t]={read:!0,write:!0}}function j(e,t){delete e.relays[t]}function P(e,{url:t,opt:s,value:n}){t in e.relays&&(e.relays[t][s]=n)}function L(e,t){e.relays=t}function D(e,t){e.follows=t}function U(e,t){e.keys.pub!==t&&(e.follows.includes(t)||e.follows.push(t))}function I(e,t){let s=e.follows.indexOf(t);s>=0&&e.follows.splice(s,1)}function N(e,t){e.follows=t}function O(e,t){t=JSON.parse(JSON.stringify(t));let{pubkey:s}=t;if(delete t.pubkey,s in e.profilesCache&&e.profilesCacheLRU.splice(e.profilesCacheLRU.indexOf(s),1),e.profilesCache[s]=t,s===e.keys.pub||e.profilesCacheLRU.push(s),e.profilesCacheLRU.length>3500){let t=e.profilesCacheLRU.shift();delete e.profilesCache[t]}}function A(e,t){let{id:s}=t;if(s in e.eventsCache&&e.eventsCacheLRU.splice(e.eventsCacheLRU.indexOf(s),1),e.eventsCache[s]=t,e.eventsCacheLRU.push(s),e.eventsCacheLRU.length>1e3){let t=e.eventsCacheLRU.shift();delete e.eventsCache[t]}}function F(e,{identifier:t,pubkey:s}){e.nip05VerificationCache[t]={pubkey:s,when:Math.round(Date.now()/1e3)}}function H(e,t){t.pubkey in e.contactListCache&&e.contactListCacheLRU.splice(e.contactListCacheLRU.indexOf(t.pubkey),1);try{let s=t.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t,s,n])=>({pubkey:t,relay:s,petname:n})));s.length&&(e.contactListCache[t.pubkey]=s)}catch(s){return}if(t.pubkey===e.keys.pub||e.contactListCacheLRU.push(t.pubkey),e.contactListCacheLRU.length>150){let t=e.contactListCacheLRU.shift();delete e.contactListCache[t]}}function Q(e){e.lastNotificationRead=Math.round(Date.now()/1e3)}function V(e,t){e.unreadNotifications=t}function K(e,t){e.lastMessageRead[t]=Math.round(Date.now()/1e3)}function J(e,{peer:t,count:s}){e.unreadMessages[t]=s}function Y(e,{key:t,value:s}){e.config[t]=s}function X(e,{key:t,value:s}){e.config.preferences.lightningTips[t]=s}function G(e){let[t,...s]=e.trim().split("?");return"http"===t.slice(0,4)&&(t="ws"+t.slice(4)),"ws"!==t.slice(0,2)&&(t="wss://"+t),t.length&&"/"===t[t.length-1]&&(t=t.slice(0,-1)),[t,...s].join("?")}var ee=s(6827),te=s(60899),se=s(22330),ne=s(34136),oe=s(26041);function ie(e,t){e.commit("setWalletModal",t)}function ae(e,t){e.commit("setKeys",t),e.commit("haveReadNotifications")}async function le(e){console.log("launch for ",e.state.keys.pub),e.dispatch("restartMainSubscription")}let re={};async function de(e){let t=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),s=[e.state.keys.pub,...e.state.follows,"29f63b70d8961835b14062b195fc7d84fa810560b36dde0749e4bc084f0f8952"];re.streamMainProfilesFollows?re.streamMainProfilesFollows.update({authors:s,relays:t}):re.streamMainProfilesFollows=await(0,ne.Lh)({authors:s,relays:t},(async t=>{for(let s of t)if(0===s.kind)e.dispatch("handleAddingProfileEventToCache",s);else if(s.pubkey===e.state.keys.pub&&3===s.kind){let t=await(0,ne.$d)(`\n            SELECT json_extract(event,'$.created_at') created_at\n            FROM nostr\n            WHERE json_extract(event,'$.kind') = 3 AND\n              json_extract(event,'$.pubkey') = '${e.state.keys.pub}'\n            LIMIT 1\n          `);if(t.length&&s.created_at<t[0].created_at)return;let n=JSON.parse(s.content);e.commit("setRelays",n);let o=s.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t));e.commit("setFollows",o),e.dispatch("restartMainSubscription")}}))}async function ce(e,{event:t,relay:s=null}){await(0,ne.LB)(t,s)}async function ue(e,{message:t,tags:s=[],kind:n=1}){if(0===t.length)return;const o={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:n,tags:s,content:t};let i=await e.dispatch("publishEvent",{unpublishedEvent:o});return console.log("sendPost result",i),i}async function pe(e,{now:t,pubkey:s,text:n,tags:o}){if(0===n.length)return;let i="???";try{if(e.state.keys.priv)i=await E._J.encrypt(e.state.keys.priv,s,n);else{if(await(window?.nostr?.getPublicKey?.())!==e.state.keys.pub)throw new Error("No private key available to encrypt!");i=await window.nostr.nip04.encrypt(s,n)}let a={pubkey:e.state.keys.pub,created_at:t,kind:4,tags:o,content:i};return await e.dispatch("publishEvent",{unpublishedEvent:a})}catch(a){return void ee.Z.create({message:`❌ Could not encrypted message: ${a}`,color:"negative",classes:"notify"})}}async function he(e){let[t]=await(0,ne.sf)(e.state.keys.pub);console.log("oldEvent poblishContactList",t);var s=t?.tags||[];let n=[];await Promise.all(e.state.follows.map((async e=>{let t=s.findIndex((([t,s])=>"p"===t&&s===e));t>=0?n.push(s[t]):n.push(await(0,oe.l_)(e))})));let o={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:3,tags:n,content:JSON.stringify(e.state.relays)};return await e.dispatch("publishEvent",{unpublishedEvent:o})}async function ge(e,t){t.created_at&&delete t.created_at;let s={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:0,tags:[],content:JSON.stringify(t)};return await e.dispatch("publishEvent",{unpublishedEvent:s})}async function me(e,t){let s={pubkey:e.state.keys.pub,created_at:Math.round(Date.now()/1e3),kind:2,tags:[],content:t};return await e.dispatch("publishEvent",{unpublishedEvent:s})}async function ye(e,{unpublishedEvent:t}){let s,n=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays);switch(t.kind){case 0:s="profile information";break;case 1:s="note";break;case 2:s="recommend relay";break;case 3:s="follows and relay list";break;case 4:s="dm";break;default:s=`kind ${t.kind}`}try{let o=await(0,se.B_)(t,e),i=await(0,ne.nY)(o,n);if(i||console.log(`no publish confirmation for ${s} event`),await e.dispatch("addEvent",{event:o}),0===o.kind)e.dispatch("handleAddingProfileEventToCache",o);else if(3===o.kind){let t,s;t=JSON.parse(o.content),s=o.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t)),e.commit("setFollows",s),e.commit("setRelays",t)}return[0,3].includes(o.kind)&&ee.Z.create({message:`🎉 Published updated ${s} event`,color:"positive",classes:"notify"}),o}catch(o){return console.log(`could not publish ${s} event: ${o}`),void ee.Z.create({message:`❌ Could not publish ${s} event: ${o}`,color:"negative",classes:"notify"})}}const fe=(0,te.Z)((async e=>{ve||we(e)}),1e3);async function we(e){if(be.length){ve=!0;let t=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),s=be.splice(0,50);while(s&&s.length){let n=await(0,ne.cp)({authors:s,relays:t});if(n)for(let t of n)e.dispatch("handleAddingProfileEventToCache",t);s=be.splice(0,50)}ve=!1}}let be=[],ve=!1;async function ke(e,{pubkey:t}){if(m.Z.methods.isKey(t))if(t in e.state.profilesCache)e.commit("addProfileToCache",{pubkey:t,...e.state.profilesCache[t]});else{let s=await(0,ne.$1)(t);s?e.dispatch("handleAddingProfileEventToCache",s):(be.push(t),fe(e))}}const xe=(0,te.Z)((async e=>{_e||Ce(e)}),1e3);async function Ce(e){if(Me.length){_e=!0;let t=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),s=Me.splice(0,50);while(s&&s.length){let n=await(0,ne.vw)({ids:s,relays:t});if(n)for(let t of n)1===t.kind||2===t.kind?m.Z.methods.interpolateEventMentions(t,e):4===t.kind&&(t.text=await m.Z.methods.getPlaintext(t,e),m.Z.methods.interpolateMessageMentions(t,e)),e.commit("addEventToCache",t),e.dispatch("useProfile",{pubkey:t.pubkey});s=Me.splice(0,50)}_e=!1}}let Me=[],_e=!1;async function Te(e,{id:t}){if(m.Z.methods.isKey(t))if(t in e.state.eventsCache)e.commit("addEventToCache",{...e.state.eventsCache[t]});else{let s=await(0,ne.uA)(t);s?(1===s.kind||2===s.kind?m.Z.methods.interpolateEventMentions(s,e):4===s.kind&&(s.text=await m.Z.methods.getPlaintext(s,e),m.Z.methods.interpolateMessageMentions(s,e)),e.commit("addEventToCache",s),e.dispatch("useProfile",{pubkey:s.pubkey})):(Me.push(t),xe(e))}}async function qe(e,{metadata:t}){if(""===t.nip05&&delete t.nip05,t.nip05){let n=e.state.nip05VerificationCache[t.nip05];if(n&&n.when>Date.now()/1e3-3600)n.pubkey!==t.pubkey&&delete t.nip05;else{let n;try{let s=await E.r$.queryProfile(t.nip05);n=s.pubkey,e.commit("addToNIP05VerificationCache",{pubkey:n,identifier:t.nip05})}catch(s){n=""}t.pubkey!==n&&delete t.nip05}}e.commit("addProfileToCache",t)}async function Be(e,t){if(e.state.profilesCache[t.pubkey]&&t.created_at<=e.state.profilesCache[t.pubkey].created_at)return;let s=(0,se.Wb)(t);e.commit("addProfileToCache",s),e.dispatch("useNip05",{metadata:s})}function Se(e){e.subscribe((({type:e,payload:t},s)=>{switch(e){case"setKeys":l.Z.set("keys",s.keys);break;case"setWalletModal":l.Z.set("walletModal",s.walletModal);break;case"setFollows":l.Z.set("follows",s.follows);break;case"setRelays":l.Z.set("relays",s.relays);break;case"setConfig":case"setConfigLightningTips":l.Z.set("config",s.config);break;case"haveReadNotifications":l.Z.set("lastNotificationRead",s.lastNotificationRead);break;case"haveReadMessage":l.Z.set("lastMessageRead",s.lastMessageRead);break}}))}function $e(e){e.subscribe((({type:t,payload:s},n)=>{switch(t){case"addRelay":case"removeRelay":case"setRelayOpt":case"saveRelays":case"follow":case"unfollow":case"reorderFollows":e.dispatch("publishContactList");break}}))}function Ee(e){e.subscribe((({type:t,payload:s},n)=>{switch(t){case"saveRelays":case"follow":case"unfollow":case"setRelays":case"addRelay":case"removeRelay":e.dispatch("restartMainSubscription");break}}))}function ze(e){const t=async()=>{e.commit("setUnreadNotifications",await(0,ne.mX)(e.state.keys.pub,e.state.lastNotificationRead))},s=async t=>{e.commit("setUnreadMessages",{peer:t,count:await(0,ne.TE)(e.state.keys.pub,t,e.state.lastMessageRead[t]||0)})};let n={};const o=async()=>{let o=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),i=!1,a=!1,l={};e.state.keys.pub&&(n.streamMainMentions?n.streamMainMentions.update({authors:[e.state.keys.pub],relays:o}):n.streamMainMentions=await(0,ne.Xp)({authors:[e.state.keys.pub],relays:o},(()=>{i&&t()}),(()=>{i||(i=!0,t())})),n.streamMainIncomingMessages?n.streamMainIncomingMessages.update({authors:[e.state.keys.pub],relays:o}):n.streamMainIncomingMessages=await(0,ne.u$)({authors:[e.state.keys.pub],relays:o},(e=>{if(a)for(let t of e)s(t.pubkey);else l[event.pubkey]=!0}),(()=>{if(!a){a=!0;for(let e of Object.keys(l))s(e)}})),t(),(0,ne.mw)(e.state.keys.pub).then((e=>{e.forEach((e=>{s(e.peer)}))})))};e.subscribeAction((({type:e,payload:t},s)=>{switch(e){case"restartMainSubscription":o();break}})),e.subscribe((({type:e,payload:n},o)=>{switch(e){case"haveReadNotifications":t();break;case"haveReadMessage":s(n);break}}))}const Ze=(0,a.MT)({state:p,getters:n,mutations:o,actions:i,plugins:[Se,$e,Ee,ze]})},22330:(e,t,s)=>{"use strict";s.d(t,{B_:()=>r,CX:()=>i,Wb:()=>a,nf:()=>l});s(46727);var n=s(88995),o=s(36836);function i(e){return{id:e.id,pubkey:e.pubkey,created_at:e.created_at,kind:e.kind,tags:e.tags,content:e.content,sig:e.sig}}function a(e){try{let t=JSON.parse(e.content);for(let e of Object.keys(t))t[e]=n.sanitize(t[e]);return t.pubkey=e.pubkey,t.created_at=e.created_at,t}catch(t){return console.log("metadataFromEvent error",t,e),{}}}function l(e){if(e.tags.filter((([e,t])=>"e"===e&&(!t||t.includes(" ")))).length)return!1;if("this workshop is awesome!"===e.content)return!1;if("Hello Nostr! :)"===e.content)return!1;if(""===e.content.trim())return!1;if(e.seen_on?.length&&e.seen_on.includes("wss://rsslay.nostr.net"))return!1;try{return JSON.parse(e.content),!1}catch(t){}return!0}async function r(e,t){if(e.id=(0,o.s_)(e),t.state.keys.priv)e.sig=(0,o.Y5)(e,t.state.keys.priv);else if(window.nostr){let t=await window.nostr.signEvent(e);switch(typeof t){case"string":e.sig=t;break;case"object":e.sig=t.sig;break;default:throw new Error("Failed to sign with Nostr extension.")}}return e}},26041:(e,t,s)=>{"use strict";s.d(t,{BP:()=>a,OV:()=>o,Xp:()=>i,aR:()=>l,l_:()=>r,wn:()=>d});s(46727);var n=s(34136);function o(e,t=5){if(!e)return"";let s=e.slice(0,4);return["npub","nsec","note"].includes(s)?e.slice(0,t+s.length)+"..."+e.slice(-t):e?e.slice(0,t)+"..."+e.slice(-t):""}function i(e,t=27){if(!e)return"";if(e.length<t)return e;let s=e.slice(0,6);return["wss://"].includes(s)?e.slice(s.length,t+s.length)+"...":e?e.slice(0,t)+"...":""}function a(e,t=3){if(!Array.isArray(e)||!e.length)return"";let s=e.length;return 1===s?e[0]:s<=t?`${JSON.stringify(...e.slice(0,s-2))} and ${e[s-1]}`:`${JSON.stringify(...e.slice(0,t-1))} and ${s-t} others`}function l(e,t,s){for(let n=0;n<e.length;n++){let o=e[n];if(s(o,t))return void e.splice(n,0,t)}e.push(t)}async function r(e){var t=["p",e];let s=await(0,n.$1)(e);if(s&&s.seen_on&&s.seen_on.length){let e=s.seen_on[Math.floor(Math.random()*s.seen_on.length)];t.push(e)}return t}async function d(e,...t){let s=await(0,n.uA)(e);if(s&&s.seen_on&&s.seen_on.length){let e=s.seen_on[Math.floor(Math.random()*s.seen_on.length)];return["e",s.id,e,...t]}return["e",e,"",...t]}},18933:(e,t,s)=>{"use strict";s.d(t,{Z:()=>y});s(46727);var n=s(56366),o=s.n(n),i=s(26041),a=s(4376),l=s(36836),r=s(14725),d=s(88995),c=s(40270),u=s(6827),p=s(31262);const{formatDate:h}=a.ZP;function g(e,t){return h(e,t,{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})}function m(e,t=!1){let s=new Date(1e3*e),n=new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),o=Date.now();return o-n.getTime()<31536e6&&o>n.getTime()?g(n,t?"ddd D MMMM":"D MMMM"):g(n,t?"ddd D MMMM YYYY":"D MMMM YYYY")}const y={methods:{getLocation(){return location},json(e){return JSON.stringify(e,null,2)},log(e){return console.log(e)},getProfile(e){return this.hexToBech32(e,"npub")},getNote(e){return this.hexToBech32(e,"note")},toProfile(e){this.$router.push("/"+this.getProfile(e))},toEvent(e){this.$router.push("/"+this.getNote(e))},shorten:i.OV,shortenUrl:i.Xp,shortenList:i.BP,niceDateUTC(e){let t=Math.floor(Date.now()/1e3);if(e>t)return m(e);if(e===t)return this.$t("now");let s=t-e;if(s<60)return`${s}${this.$t("s")}`;let n=Math.floor(s/60);if(n<60)return`${n}${this.$t("m")}`;let o=Math.floor(n/60);return o<24?`${o}${this.$t("h")}`:m(e)},dateUTC(e){return m(e,!0)},timeUTC(e){let t=new Date(1e3*e);return`${String(t.getUTCHours()).padStart(2,"0")}:${String(t.getUTCMinutes()).padStart(2,"0")} ${this.$t("UTC")}`},interpolateMentions(e,t,s){const n={profiles:[],replyEvents:[],mentionEvents:[]};if(e=String(e).trim(),""===e)return{text:e,replyEvents:[],mentionEvents:t.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t))};const o=(o,a)=>{if(t.length-1<Number(a)||t[Number(a)].length<2||!["e","p"].includes(t[Number(a)][0]))return o;if("e"===t[Number(a)][0]){const s=t[Number(a)][1];return n.mentionEvents.push(s),o.length===e.length?"":`[${(0,i.OV)(this.hexToBech32(s,"note"))}](/${this.hexToBech32(s,"note")})`}if("p"===t[Number(a)][0]){const e=t[Number(a)][1],n=s.getters.displayName(e);return`[${n}](/${this.hexToBech32(e,"npub")})`}},a=(e,t,s)=>`${t}[${e}](/hashtag/${s})`,l=(e,t)=>{const n=s.getters.displayName(t);return`[@${n}](/${t})`};let r=e.replace(/#\[(\d+)\]/g,o),c=r.replace(/(?<s>^|[\s])#([\w]{1,63})\b/g,a),u=c.replace(/@([\w]{64})/g,l),p=u,h=t.findIndex((([e,t,s,n])=>"e"===e&&t&&"root"===n));if(h>=0){let[e,s]=t[h];!n.mentionEvents.includes(s)&&n.replyEvents.length<2&&n.replyEvents.push(s);let o=t.find((([e,t,s,n])=>"e"===e&&t&&"reply"===n));if(o>=0){let[e,s]=t[o];!n.mentionEvents.includes(s)&&n.replyEvents.length<2&&n.replyEvents.push(s)}}return t.filter((([e,t,s,n])=>"e"===e&&t&&"mention"===n)).forEach((([e,t],s)=>{n.mentionEvents.includes(t)||n.mentionEvents.push(t)})),t.filter((([e,t])=>"e"===e&&t)).forEach((([e,t],s)=>{n.mentionEvents.includes(t)||n.replyEvents.includes(t)||(n.replyEvents.length<2?n.replyEvents.push(t):n.mentionEvents.push(t))})),{text:d.sanitize(p),replyEvents:n.replyEvents,mentionEvents:n.mentionEvents}},interpolateEventMentions(e,t=this.$store){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.content,e.tags||[],t))}))},interpolateMessageMentions(e,t=this.$store){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.text,e.tags,t))}))},createMentionsProvider(e){const t=new(o())({menuContainer:document.getElementById("tribute-wrapper"),positionMenu:!1,selectTemplate:e=>`${this.hexToBech32(e.original.value.pubkey,"npub")}`,menuItemTemplate:e=>`\n            <div class="flex row no-wrap items-center" style="gap: .2rem; width: 100%;">\n              <div style="border-radius: 10px">\n                <img src=${this.$store.getters.avatar(e.original.value.pubkey)} style="object-fit: cover; height: 1.5rem; width: 1.5rem;"/>\n              </div>\n                <div class="text-bold">${e.string}</div>\n              ${this.$store.state.follows.includes(e.original.value.pubkey)?'<i class="notranslate material-icons text-secondary mr-1 -ml-1" aria-hidden="true" role="presentation">visibility</i>':""}\n              ${e.original.value.nip05?'<i class="notranslate material-icons text-accent mr-1 -ml-1" aria-hidden="true" role="presentation">verified</i>':""}\n                <div class="text-secondary text-caption">${(0,i.OV)(this.hexToBech32(e.original.value.pubkey,"npub"))}</div>\n              </div>\n            `,values:(e,t)=>{t(this.$store.getters.namedProfiles.map((e=>({key:this.$store.getters.displayName(e.pubkey),value:e}))))},noMatchTemplate:()=>{}});return{attach:e=>t.attach(e),detach:e=>t.detach(e)}},async processTaggedEvents(e,t){if(!Array.isArray(t))throw new Error("no array supplied");e.splice(10);for(let s of e)this.$store.dispatch("useEvent",{id:s})},async getPlaintext(e,t=this.$store){if(e.tags.find((([e,s])=>"p"===e&&s===t.state.keys.pub)))return await this.decrypt(e.pubkey,e.content,t);if(e.pubkey===t.state.keys.pub){let[t,s]=e.tags.find((([e])=>"p"===e));return await this.decrypt(s,e.content)}},async decrypt(e,t,s=this.$store){try{if(s.state.keys.priv)return l._J.decrypt(s.state.keys.priv,e,t);if(await(window?.nostr?.getPublicKey?.())===s.state.keys.pub)return await window.nostr.nip04.decrypt(e,t);throw new Error("no private key available to decrypt!")}catch(n){return"???"}},isKey(e){return!(!e||"string"!==typeof e)&&/^[0-9a-f]{64}$/.test(e?.toLowerCase())},isBech32Key(e){if("string"!==typeof e)return!1;try{let{prefix:t}=r.gW.decode(e.toLowerCase());return!!["npub","nsec","note"].includes(t)&&("npub"===t&&(this.watchOnly=!0),"nsec"===t&&(this.watchOnly=!1),this.isKey(this.bech32ToHex(e)))}catch(t){}return!1},bech32ToHex(e){try{let{data:t}=l.uD.decode(e);return t}catch(t){}return""},hexToBech32(e,t){try{switch(t){case"npub":return l.uD.npubEncode(e);case"nsec":return l.uD.nsecEncode(e);case"note":return l.uD.noteEncode(e)}}catch(s){}return""},lnurlToLnAddr(e){try{let t=p.P6.decodeUrlOrAddress(e);if(!t)return null;let s=/^https:\/\/(?<domain>[a-zA-z0-9.]+)\/.well-known\/lnurlp\/(?<user>[a-zA-Z0-9_-]+)/,n=t.match(s);if(n)return`${n.groups.user}@${n.groups.domain}`}catch(t){}return null},lnAddrToLnurl(e){try{if(!p.P6.isLightningAddress(e))return null;let t=p.P6.decodeUrlOrAddress(e),s=r.gW.toWords(c.Buffer.from(t,"utf8")),n=r.gW.encode("lnurl",s,5e3);return n}catch(t){}},async getInvoice(e,t){if(0===e.toLowerCase().indexOf("lnbc"))return e;if(!t)return e;try{const{invoice:s}=await(0,p.Fl)({lnUrlOrAddress:e,tokens:t,fetchGet:e=>{let t=`https://proxy.astral.ninja/${e.url}`;return e.params&&(t.includes("?")?t+="&":t+="?",t+=new URLSearchParams(e.params)),fetch(t).then((e=>e.json())).catch((e=>{u.Z.create({message:"❌ Error fetching invoice from LN-URL: "+e.toString(),classes:"notify"})}))}});return s}catch(s){return u.Z.create({message:"❌ Error fetching invoice from LN-URL: "+s.toString(),classes:"notify"}),this.lnString}}}}},23426:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var n=s(59835),o=s(86970);function i(e,t,s,i,a,l){const r=(0,n.up)("q-tooltip"),d=(0,n.up)("q-btn");return e.buttonText?((0,n.wg)(),(0,n.j4)(d,{key:0,icon:"content_copy",unelevated:"",clickable:"",onClick:e.copy,class:(0,o.C_)([""+e.buttonClass,"button-copy"]),size:e.buttonSize,dense:"",label:e.verbose||e.buttonLabel?e.buttonLabel||"copy":"",align:"left"},{default:(0,n.w5)((()=>[e.tooltipText?((0,n.wg)(),(0,n.j4)(r,{key:0,anchor:"top middle",self:"bottom middle",offset:[10,10],class:"tooltip"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.tooltipText),1)])),_:1})):(0,n.kq)("",!0)])),_:1},8,["onClick","class","size","label"])):(0,n.kq)("",!0)}var a=s(18933),l=s(6827);const r=(0,n.aZ)({name:"BaseButtonCopy",mixins:[a.Z],props:{buttonText:{type:String,required:!0},buttonLabel:{type:String,default:null},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1},tooltipText:{type:String,required:!1,default:""},element:{type:Object,default:null}},computed:{copyText(){let e=this.element?.getSelection()?.toString();return e||this.buttonText}},methods:{async copy(){let e=this.copyText;console.log(e),await navigator.clipboard.writeText(e),l.Z.create({message:`Copied ${this.copyText.length<70?this.copyText:this.shorten(this.copyText,30)}`,classes:"notify"})}}});var d=s(11639),c=s(24455),u=s(46858),p=s(69984),h=s.n(p);const g=(0,d.Z)(r,[["render",i]]),m=g;h()(r,"components",{QBtn:c.Z,QTooltip:u.Z})},32145:(e,t,s)=>{"use strict";s.d(t,{Z:()=>z});var n=s(59835),o=s(61957),i=s(86970);const a=(0,n.Uk)(" METADATA "),l={class:"flex row justify-end"},r={class:"overflow-auto"};function d(e,t,s,d,c,u){const p=(0,n.up)("q-tooltip"),h=(0,n.up)("q-btn"),g=(0,n.up)("BaseRawEvent"),m=(0,n.up)("q-card"),y=(0,n.up)("q-dialog"),f=(0,n.Q2)("close-popup");return(0,n.wy)(((0,n.wg)(),(0,n.j4)(h,{icon:"info",unelevated:"",clickable:"",onClick:t[2]||(t[2]=(0,o.iM)((t=>e.toggleMetadataDialog()),["stop"])),class:(0,i.C_)([""+e.buttonClass,"button-info"]),size:e.buttonSize,label:e.verbose?"info":"",dense:"",align:"left"},{default:(0,n.w5)((()=>[e.verbose?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(p,{key:0,class:"tooltip"},{default:(0,n.w5)((()=>[a])),_:1})),(0,n.Wm)(y,{modelValue:e.metadataDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.metadataDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,n.w5)((()=>[(0,n._)("div",l,[(0,n.wy)((0,n.Wm)(h,{icon:"close",flat:"",dense:""},null,512),[[f]])]),(0,n._)("div",r,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.events,(e=>((0,n.wg)(),(0,n.j4)(g,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["class","size","label"])),[[f]])}const c={class:"text-subtitle1 spotnik"},u=(0,n.Uk)(" Raw Event Data "),p={class:"code"};function h(e,t,s,o,a,l){const r=(0,n.up)("BaseButtonCopy"),d=(0,n.up)("q-card-section"),h=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(h,{style:{"box-shadow":"none"}},{default:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n._)("div",c,[u,(0,n.Wm)(r,{"button-text":e.json(l.cleaned)},null,8,["button-text"])]),(0,n._)("pre",p,(0,i.zw)(e.json(l.cleaned)),1)])),_:1})])),_:1})}var g=s(18933),m=s(22330),y=s(23426),f=s(88995);const w={name:"BaseRawEvent",mixins:[g.Z],props:{event:{type:Object,required:!0}},components:{BaseButtonCopy:y.Z},computed:{cleaned(){return Array.isArray(this.event)?this.event.map((e=>(0,m.CX)(this.sanitize(e)))):(0,m.CX)(this.sanitize(this.event))}},methods:{sanitize(e){return JSON.parse(f.sanitize(JSON.stringify(this.event)))}}};var b=s(11639),v=s(44458),k=s(63190),x=s(69984),C=s.n(x);const M=(0,b.Z)(w,[["render",h]]),_=M;C()(w,"components",{QCard:v.Z,QCardSection:k.Z});const T=(0,n.aZ)({name:"BaseButtonInfo",emits:["dialog","hide"],components:{BaseRawEvent:_},data(){return{metadataDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleMetadataDialog(){this.metadataDialog=!this.metadataDialog,this.$emit("dialog",this.metadataDialog)}}});var q=s(24455),B=s(46858),S=s(87743),$=s(62146);const E=(0,b.Z)(T,[["render",d]]),z=E;C()(T,"components",{QBtn:q.Z,QTooltip:B.Z,QDialog:S.Z,QCard:v.Z}),C()(T,"directives",{ClosePopup:$.Z})},28669:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var n=s(59835),o=s(86970),i=s(61957);const a=(0,n.Uk)(" TIP WITH BITCOIN LIGHTNING ⚡ ");function l(e,t,s,l,r,d){const c=(0,n.up)("q-tooltip"),u=(0,n.up)("BaseLightningCard"),p=(0,n.up)("q-dialog"),h=(0,n.up)("q-btn"),g=(0,n.up)("q-btn-group");return(0,n.wg)(),(0,n.j4)(g,{class:"no-padding",flat:""},{default:(0,n.w5)((()=>[e.lnString&&this.$store.state.config.preferences.lightningTips.enabled?((0,n.wg)(),(0,n.j4)(h,{key:0,icon:"bolt",class:(0,o.C_)(["button-lightning",e.oneClick?"q-pr-none q-pl-sm":""]),onClick:(0,i.iM)(e.handleLightningTipClick,["stop"]),align:"left",size:e.size,unelevated:"",ripple:!1,dense:"",disable:e.loading},{default:(0,n.w5)((()=>[e.loading?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(c,{key:0,class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,n.w5)((()=>[a])),_:1})),(0,n.Wm)(p,{modelValue:e.showLightningCard,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showLightningCard=t)},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{"ln-string":e.lnString,pubkey:e.pubkey,style:{padding:"1.5rem"}},null,8,["ln-string","pubkey"])])),_:1},8,["modelValue"])])),_:1},8,["class","onClick","size","disable"])):(0,n.kq)("",!0),e.oneClick?((0,n.wg)(),(0,n.j4)(h,{key:1,icon:"arrow_drop_down",class:"no-padding",dense:"",unelevated:"",size:e.size,onClick:t[1]||(t[1]=(0,i.iM)((t=>e.showLightningCard=!e.showLightningCard),["stop"]))},null,8,["size"])):(0,n.kq)("",!0)])),_:1})}var r=s(18933),d=s(50332),c=s(6827);const u=(0,n.aZ)({name:"BaseButtonLightning",mixins:[r.Z],components:{BaseLightningCard:d.Z},data(){return{showLightningCard:!1,oneClick:this.$store.state.config.preferences.lightningTips.oneClick.enabled,amount:this.$store.state.config.preferences.lightningTips.oneClick.amount,lnString:this.$store.getters.profileLud06(this.pubkey),loading:!1}},props:{pubkey:{type:String,required:!0},size:{type:String,required:!1,default:"md"}},methods:{handleLightningTipClick(){window.webln&&this.$store.state.config.preferences.lightningTips.oneClick.enabled?this.sendTip():this.showLightningCard=!this.showLightningCard},async sendTip(){if(!window.webln)return;this.loading=!0;const e=await this.getInvoice(this.lnString,this.amount);if(e.startsWith("lnurl"))return c.Z.create({message:`⚠️ Invoice couldn't be fetched for ${this.$store.getters.displayName(this.pubkey)}. Please use a different pay method`,classes:"notify"}),void(this.loading=!1);try{await window.webln.sendPayment(e),c.Z.create({message:`⚡ ${this.amount} sats sent to ${this.$store.getters.displayName(this.pubkey)} 🎉`,classes:"notify"})}catch{c.Z.create({message:"❌ One-Click Tip Unsuccessful",classes:"notify"})}this.loading=!1}}});var p=s(11639),h=s(67236),g=s(24455),m=s(46858),y=s(87743),f=s(69984),w=s.n(f);const b=(0,p.Z)(u,[["render",l]]),v=b;w()(u,"components",{QBtnGroup:h.Z,QBtn:g.Z,QTooltip:m.Z,QDialog:y.Z})},85598:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var n=s(59835),o=s(86970);const i=(0,n.Uk)(" SEEN ON RELAYS "),a={class:"flex row justify-end"},l={class:"overflow-auto"};function r(e,t,s,r,d,c){const u=(0,n.up)("q-tooltip"),p=(0,n.up)("q-btn"),h=(0,n.up)("BaseRelayList"),g=(0,n.up)("q-card"),m=(0,n.up)("q-dialog"),y=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(p,{icon:"sync_alt",unelevated:"",clickable:"",onClick:e.toggleRelayListDialog,class:(0,o.C_)([""+e.buttonClass,"button-relays"]),size:e.buttonSize,label:e.verbose?"relays":"",dense:"",align:"left"},{default:(0,n.w5)((()=>[e.verbose?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(u,{key:0,class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,n.w5)((()=>[i])),_:1})),(0,n.Wm)(m,{modelValue:e.relayListDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.relayListDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n._)("div",a,[(0,n.wy)((0,n.Wm)(p,{icon:"close",flat:"",dense:""},null,512),[[y]])]),(0,n._)("div",l,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.events,(e=>((0,n.wg)(),(0,n.j4)(h,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["onClick","class","size","label"])}var d=s(18587);const c=(0,n.aZ)({name:"BaseButtonRelays",emits:["dialog","hide"],components:{BaseRelayList:d.Z},data(){return{relayListDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleRelayListDialog(){this.relayListDialog=!this.relayListDialog,this.$emit("dialog",this.relayListDialog)}}});var u=s(11639),p=s(24455),h=s(46858),g=s(87743),m=s(44458),y=s(62146),f=s(69984),w=s.n(f);const b=(0,u.Z)(c,[["render",r]]),v=b;w()(c,"components",{QBtn:p.Z,QTooltip:h.Z,QDialog:g.Z,QCard:m.Z}),w()(c,"directives",{ClosePopup:y.Z})},80517:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var n=s(59835),o=s(61957);function i(e,t,s,i,a,l){const r=(0,n.up)("q-separator"),d=(0,n.up)("q-btn"),c=(0,n.up)("q-btn-group");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(r,{color:"accent"}),(0,n.Wm)(c,{flat:"",spread:"",dense:"","text-color":"accent"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{dense:"",flat:"",color:"accent",class:"text-weight-light",style:{"letter-spacing":"0.1rem"},onClick:(0,o.iM)(l.showMore,["stop"]),label:s.replyCount?s.replyCount+" replies":"show more"},null,8,["onClick","label"])])),_:1}),s.replyCount?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(r,{key:0,color:"accent"}))],64)}var a=s(18933);const l={name:"BaseButtonShowMore",mixins:[a.Z],props:{root:{type:String,required:!0},replyCount:{type:Number,default:0}},methods:{showMore(){this.toEvent(this.root)}}};var r=s(11639),d=s(50926),c=s(67236),u=s(24455),p=s(69984),h=s.n(p);const g=(0,r.Z)(l,[["render",i]]),m=g;h()(l,"components",{QSeparator:d.Z,QBtnGroup:c.Z,QBtn:u.Z})},50332:(e,t,s)=>{"use strict";s.d(t,{Z:()=>ye});var n=s(59835),o=s(86970),i=s(61957);const a=e=>((0,n.dD)("data-v-4599daf8"),e=e(),(0,n.Cn)(),e),l={class:"lightning-card"},r=["align"],d={key:0,class:"flex column items-center"},c=a((()=>(0,n._)("span",{class:"text-bold",style:{"font-size":"1.1rem"}},"⚡ Lightning Tip for",-1))),u={key:1,class:"text-bold",style:{"font-size":"1.1rem"}},p={key:0},h=a((()=>(0,n._)("strong",{style:{color:"skyblue"}},"summary:",-1))),g=a((()=>(0,n._)("strong",{style:{color:"lightgreen"}},"amount:",-1))),m={key:1},y=a((()=>(0,n._)("strong",{style:{color:"skyblue"}},"creation date:",-1))),f={key:2},w=a((()=>(0,n._)("strong",{style:{color:"skyblue"}},"creation time:",-1))),b={key:3},v=a((()=>(0,n._)("strong",{style:{color:"orange"}},"expiry date:",-1))),k={key:4},x=a((()=>(0,n._)("strong",{style:{color:"orange"}},"expiry time:",-1))),C={key:5},M=a((()=>(0,n._)("strong",{style:{color:"orangered"}},"error:",-1))),_={key:0,class:"flex row items-center"},T={class:"break-word-wrap code",style:{"font-size":"0.7rem","overflow-y":"auto","max-height":"170px","max-width":"200px"}};function q(e,t,s,a,q,B){const S=(0,n.up)("BaseUserCard"),$=(0,n.up)("BaseButtonCopy"),E=(0,n.up)("q-btn"),z=(0,n.up)("q-tab-panel"),Z=(0,n.up)("BaseQr"),W=(0,n.up)("BaseWallet"),R=(0,n.up)("q-tab-panels");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",{class:(0,o.C_)(["flex no-wrap justify-between",s.rowOrColumn]),style:{gap:"1rem"}},[(0,n._)("div",{style:(0,o.j5)([{"font-size":"0.9rem"},"row"===s.rowOrColumn?"gap: .5rem;":"gap: 1rem;"]),class:"flex column justify-between",align:"row"===s.rowOrColumn?"start":"center"},[s.pubkey?((0,n.wg)(),(0,n.iD)("div",d,[c,(0,n.Wm)(S,{pubkey:s.pubkey,"action-buttons":!1},null,8,["pubkey"])])):((0,n.wg)(),(0,n.iD)("div",u," ⚡ Lightning "+(0,o.zw)(B.type),1)),B.bolt11?((0,n.wg)(),(0,n.iD)("div",{key:2,class:(0,o.C_)(["flex column","row"===s.rowOrColumn?"items-start":"items-center"])},[B.bolt11.description?((0,n.wg)(),(0,n.iD)("div",p,[h,(0,n.Uk)(" "+(0,o.zw)(B.bolt11.description),1)])):(0,n.kq)("",!0),(0,n._)("div",null,[g,(0,n.Uk)(" "+(0,o.zw)(B.bolt11.amount?`${B.bolt11.amount} sats`:"none specified"),1)]),B.bolt11.created?((0,n.wg)(),(0,n.iD)("div",m,[y,(0,n.Uk)(" "+(0,o.zw)(e.dateUTC(B.bolt11.created)),1)])):(0,n.kq)("",!0),B.bolt11.created?((0,n.wg)(),(0,n.iD)("div",f,[w,(0,n.Uk)(" "+(0,o.zw)(e.timeUTC(B.bolt11.created)),1)])):(0,n.kq)("",!0),B.bolt11.expires?((0,n.wg)(),(0,n.iD)("div",b,[v,(0,n.Uk)(" "+(0,o.zw)(e.dateUTC(B.bolt11.expires)),1)])):(0,n.kq)("",!0),B.bolt11.expires?((0,n.wg)(),(0,n.iD)("div",k,[x,(0,n.Uk)(" "+(0,o.zw)(e.timeUTC(B.bolt11.expires)),1)])):(0,n.kq)("",!0),B.bolt11.error?((0,n.wg)(),(0,n.iD)("div",C,[M,(0,n.Uk)(" "+(0,o.zw)(B.bolt11.error),1)])):(0,n.kq)("",!0)],2)):((0,n.wg)(),(0,n.iD)("div",{key:3,class:(0,o.C_)(["flex column","row"===s.rowOrColumn?"items-start":"items-center"])},[q.request.lnAddr?((0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("span",null,(0,o.zw)(q.request.lnAddr),1),(0,n.Wm)($,{"button-text":q.request.lnAddr,class:"q-pr-xs",onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"]))},null,8,["button-text"])])):(0,n.kq)("",!0)],2)),(0,n._)("div",{class:(0,o.C_)(["flex row no-wrap q-pt-xs","row"===s.rowOrColumn?" justify-start":" justify-center"]),style:{gap:"0.5rem"}},[(0,n.Wm)($,{"button-text":s.lnString,"button-label":"copy",outline:"",class:"q-pr-xs",onClick:t[1]||(t[1]=(0,i.iM)((e=>B.updateMode("copy")),["stop"]))},null,8,["button-text"]),(0,n.Wm)(E,{label:"qr",icon:"qr_code_2",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:t[2]||(t[2]=(0,i.iM)((e=>B.updateMode("qr")),["stop"]))}),(0,n.Wm)(E,{label:"wallet",icon:"wallet",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:t[3]||(t[3]=(0,i.iM)((e=>B.updateMode("wallet")),["stop"]))})],2)],12,r),(0,n.Wm)(R,{modelValue:q.mode,"onUpdate:modelValue":t[4]||(t[4]=e=>q.mode=e),style:(0,o.j5)([{background:"unset"},"row"===s.rowOrColumn?"max-width: 50%; width: 50%":"max-width: 100%; width: 100%"])},{default:(0,n.w5)((()=>[(0,n.Wm)(z,{name:"copy",class:(0,o.C_)(["no-padding flex items-center","row"===s.rowOrColumn?"justify-end":"justify-center"])},{default:(0,n.w5)((()=>[(0,n._)("div",T,(0,o.zw)(this.lnString.toLowerCase()),1)])),_:1},8,["class"]),(0,n.Wm)(z,{name:"qr",class:"no-padding flex items-center justify-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(Z,{code:this.lnString,style:{height:"fit-content"}},null,8,["code"])])),_:1}),(0,n.Wm)(z,{name:"wallet",class:"no-padding flex items-center justify-center full-width"},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{"ln-string":s.lnString,pubkey:s.pubkey,bolt11:B.bolt11},null,8,["ln-string","pubkey","bolt11"])])),_:1})])),_:1},8,["modelValue","style"])],2)])}var B=s(18933),S=s(23426);const $={ref:"qr",style:{"object-fit":"cover","min-height":"200px","min-width":"200px",width:"100%"}};function E(e,t,s,o,i,a){return(0,n.wg)(),(0,n.iD)("img",$,null,512)}var z=s(21170);const Z=(0,n.aZ)({name:"BaseQr",props:{code:{type:String,required:!0}},mounted(){let e=this.$refs.qr,t=e.clientWidth;e.style.height=`${t}px`,this.renderQr()},methods:{renderQr(e){this.showQr=!0;let t=z.Z.QrCode.encodeText(this.code,z.Z.QrCode.Ecc.MEDIUM),s=this.toSvgString(t,4);this.$refs.qr.src=s},toSvgString(e,t){let s="#FFFFFF",n="#000000";if(t<0)throw new RangeError("Border must be non-negative");let o=[];for(let r=0;r<e.size;r++)for(let s=0;s<e.size;s++)e.getModule(s,r)&&o.push(`M${s+t},${r+t}h1v1h-1z`);let i=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 ${e.size+2*t} ${e.size+2*t}" stroke="none">\n\t<rect width="100%" height="100%" fill="${s}"/>\n\t<path d="${o.join(" ")}" fill="${n}"/>\n</svg>\n`,a=new Blob([i],{type:"image/svg+xml"}),l=URL.createObjectURL(a);return l}}});var W=s(11639),R=s(490),j=s(69984),P=s.n(j);const L=(0,W.Z)(Z,[["render",E]]),D=L;P()(Z,"components",{QItem:R.Z});const U={ref:"walletPicker",class:"wallet-picker flex column no-padding justify-center",style:{gap:"1rem",height:"100%",width:"100%"}},I={class:"flex row full-width items-center justify-center"},N={key:0,class:"flex row no-wrap items-center q-pa-xs",style:{gap:"0.5rem","font-size":"1.1rem",width:"100%"}},O=["src"],A={key:1,style:{"font-size":"1.1rem",width:"100%"}},F={class:"flex column no-wrap q-pa-sm base-select-list",style:{"max-height":"80%",gap:"0.5rem",background:"var(--q-background)","font-size":"1.1rem"}},H=["onClick"],Q=["src"],V={key:0,class:"flex row items-center justify-center",style:{gap:"0.7rem"}},K=(0,n._)("div",{style:{"font-size":"1.1rem"}},"sats",-1),J={key:1,class:"flex row justify-center",style:{gap:"0.3rem"}},Y={class:"flex column justify-center items-center",style:{"font-size":"0.9rem",width:"100%"}},X={key:0},G={key:1},ee={key:2};function te(e,t,s,a,l,r){const d=(0,n.up)("q-dialog"),c=(0,n.up)("BaseSelect"),u=(0,n.up)("q-btn"),p=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)("div",U,[(0,n._)("div",I,[(0,n._)("div",null,[(0,n.Wm)(c,{selecting:e.showWalletPicker,onToggle:t[1]||(t[1]=t=>e.showWalletPicker=!e.showWalletPicker),style:{width:"100%"}},{default:(0,n.w5)((()=>[e.selectedWallet?((0,n.wg)(),(0,n.iD)("div",N,[e.loadingInvoice?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("img",{key:0,src:"wallet-icons/"+e.selectedWallet.image,style:{height:"1.5rem",width:"1.5rem","border-radius":"0.3rem"}},null,8,O)),(0,n._)("div",null,(0,o.zw)(e.selectedWallet.name),1)])):((0,n.wg)(),(0,n.iD)("div",A," Select a ⚡ Wallet "))])),"list-items":(0,n.w5)((()=>[(0,n.Wm)(d,{modelValue:e.showWalletPicker,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showWalletPicker=t)},{default:(0,n.w5)((()=>[(0,n._)("div",F,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.wallets,((t,s)=>((0,n.wg)(),(0,n.iD)("li",{key:s,onClick:(0,i.iM)((s=>e.selectWallet(t)),["stop"]),class:"flex row items-center no-wrap q-pl-xs",style:{gap:"0.5rem"}},[e.loadingInvoice?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("img",{key:0,src:"wallet-icons/"+t.image,style:{height:"1.5rem",width:"1.5rem","border-radius":"0.3rem"}},null,8,Q)),(0,n._)("div",null,(0,o.zw)(t.name),1)],8,H)))),128))])])),_:1},8,["modelValue"])])),_:1},8,["selecting"])])]),e.isInvoice?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",V,[(0,n._)("div",{id:"amount-input",contenteditable:"",style:{"font-size":"2rem",padding:"0 0.4rem","min-width":"2rem",outline:"none",border:"none"},onInput:t[2]||(t[2]=(...t)=>e.updateTipAmount&&e.updateTipAmount(...t)),onKeypress:t[3]||(t[3]=(0,i.D2)((t=>e.openInWallet()),["enter"]))},(0,o.zw)(e.tipAmount),33),K])),e.isInvoice?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",J,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.tipPresets,((t,s)=>((0,n.wg)(),(0,n.j4)(u,{key:s,label:t+" sats",size:"sm",outline:"",onClick:(0,i.iM)((s=>e.tipAmount=t),["stop"])},null,8,["label","onClick"])))),128)),(0,n.Wm)(u,{label:"other",size:"sm",outline:"",onClick:t[4]||(t[4]=(0,i.iM)((t=>e.focusAmount()),["stop"]))})])),(0,n._)("div",Y,[e.selectedWallet?!e.isInvoice&&e.selectedWallet&&0===e.tipAmount?((0,n.wg)(),(0,n.iD)("span",G,"Please enter an amount greater than 0")):e.isInvoice||!e.selectedWallet||e.tipAmount?(0,n.wy)(((0,n.wg)(),(0,n.j4)(u,{key:3,spread:"",outline:"",class:"full-width",label:e.hasWebLn&&"lightning:"===e.selectedWallet.prefix?"pay":"open wallet",color:"primary",onClick:t[5]||(t[5]=(0,i.iM)((t=>e.openInWallet()),["stop"]))},null,8,["label"])),[[p]]):((0,n.wg)(),(0,n.iD)("span",ee,"Please enter an amount")):((0,n.wg)(),(0,n.iD)("span",X,"Please select a Wallet"))])],512)}var se=s(6827),ne=s(83325);const oe=(0,n.aZ)({name:"BaseWallet",mixins:[B.Z],components:{BaseSelect:ne.Z},props:{lnString:{type:String,required:!0,default:""},pubkey:{type:String,default:null},bolt11:{type:Object,default:null},extended:{type:Boolean,requred:!1,default:!1},size:{type:String,required:!1,default:"sm"}},data(){return{showWalletPicker:!1,loadingInvoice:!1,tipAmount:this.$store.state.config.preferences.lightningTips.presets[0],tipPresets:this.$store.state.config.preferences.lightningTips.presets,selectedWallet:null,wallets:[{name:"system default",prefix:"lightning:",image:"default.png"},{name:"browser extension (webln)",prefix:"lightning:",image:"webln.jpg"},{name:"Strike",prefix:"strike:lightning:",image:"strike.jpg"},{name:"Cash App",prefix:"squarecash://",image:"cashapp.jpg"},{name:"Muun",prefix:"muun:",image:"muun.jpg"},{name:"Breez",prefix:"breez:",image:"breez.jpg"},{name:"Phoenix",prefix:"phoenix://",image:"phoenix.jpg"},{name:"Wallet of Satoshi",prefix:"walletofsatoshi:lightning:",image:"wos.jpg"},{name:"Blixt",prefix:"blixtwallet:lightning:",image:"blixt.png"},{name:"Zeus LN",prefix:"zeusln:lightning:",image:"zeusln.jpg"},{name:"Bitcoin Beach",prefix:"bitcoinbeach://",image:"bbw.jpg"}],hasWebLn:!1,focusAmount(){setTimeout((async()=>{await this.$nextTick(),this.tipAmount=null,this.amountInput.focus()}),1)}}},computed:{amountInput(){return this.$refs.walletPicker.querySelector("#amount-input")},isInvoice(){return this.lnString.startsWith("lnbc")}},mounted(){this.selectedWallet=this.wallets.find((e=>e.name===this.$store.state.config.preferences.lightningTips.lastWallet)),this.hasWebLn=window.webln},methods:{selectWallet(e){this.selectedWallet=e,this.showWalletPicker=!1},updateTipAmount(e){let t=e.target.innerText,s=/^[0-9]+$/,n=t.match(s);if(!n)return void(this.tipAmount=null);let o=parseInt(t);this.tipAmount=o},async openInWallet(){if(!this.selectedWallet||!this.tipAmount)return;this.$store.commit("setConfigLightningTips",{key:"lastWallet",value:this.selectedWallet.name});let e=this.selectedWallet.prefix;e||(e="lightning:"),this.loadingInvoice=!0;const t=await this.getInvoice(this.lnString,this.tipAmount);if(t.startsWith("lnurl"))return se.Z.create({message:`⚠️ Invoice couldn't be fetched for ${this.$store.getters.displayName(this.pubkey)}. Please try a different method`}),void(this.loadingInvoice=!1);if("lightning:"===e&&window.webln&&t.startsWith("lnbc"))try{await window.webln.sendPayment(t),se.Z.create({message:`⚡ Successfully sent ${this.bolt11?this.bolt11.amount:this.tipAmount} sats 💸🥳🎉`})}catch{se.Z.create({message:"❌ Payment Unsuccessful"})}else window.open(`${e}${t}`,"_self");this.loadingInvoice=!1}}});var ie=s(87743),ae=s(24455),le=s(62146);const re=(0,W.Z)(oe,[["render",te]]),de=re;P()(oe,"components",{QDialog:ie.Z,QBtn:ae.Z}),P()(oe,"directives",{ClosePopup:le.Z});var ce=s(78621),ue=s(31262);const pe={name:"BaseLightningCard",mixins:[B.Z],props:{lnString:{type:String,required:!0},pubkey:{type:String,default:null},rowOrColumn:{type:String,default:"column"}},components:{BaseButtonCopy:S.Z,BaseQr:D,BaseWallet:de},data(){return{request:{},mode:this.$store.state.config.preferences.lightningTips.lastMode}},computed:{bolt11(){if(!this.lnString.toLowerCase().startsWith("lnbc"))return null;try{let e=ce.decode(this.lnString),t={};e.sections.forEach((({name:e,value:s})=>{t[e]=s}));let s=t.amount?t.amount/1e3:null,n=t.description,o=t.timestamp,i=t.expiry,a=parseInt(i),l=isNaN(a)?null:o+a,r=e.paymentRequest;return{amount:s,description:n,created:o,expires:l,request:r}}catch(e){console.log("invoice parsing error",e);let t=this.lnString;return{error:e,request:t}}},type(){return this.lnString.startsWith("lnbc")?"invoice":"lnurl"}},async mounted(){if(this.both11)return;if(!ue.P6.isLnurl(this.lnString))return void(this.request.error="invalid lnurl");let e=this.lnurlToLnAddr(this.lnString);e&&(this.request.lnAddr=e)},methods:{updateMode(e){this.mode=e,this.$store.commit("setConfigLightningTips",{key:"lastMode",value:e})}}};var he=s(89800),ge=s(84106);const me=(0,W.Z)(pe,[["render",q],["__scopeId","data-v-4599daf8"]]),ye=me;P()(pe,"components",{QBtn:ae.Z,QTabPanels:he.Z,QTabPanel:ge.Z})},3325:(e,t,s)=>{"use strict";s.d(t,{Z:()=>z});var n=s(59835),o=s(86970),i=s(61957);const a={ref:"src",class:"hidden break-word-wrap"},l={ref:"append",class:"hidden break-word-wrap"},r=["innerHTML"],d={key:1};function c(e,t,s,c,u,p){const h=(0,n.up)("q-btn"),g=(0,n.up)("BaseLightningCard");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",a,[(0,n.WI)(e.$slots,"default")],512),(0,n._)("div",l,[(0,n.WI)(e.$slots,"append")],512),(0,n._)("div",{innerHTML:u.html,ref:"html",class:(0,o.C_)(["break-word-wrap dynamic-content",s.longForm?"long-form":""]),onClick:t[0]||(t[0]=(...e)=>p.handleClicks&&p.handleClicks(...e))},null,10,r),s.longForm?((0,n.wg)(),(0,n.j4)(h,{key:0,id:"long-form-button",dense:"",outline:"",rounded:"",color:"info",class:"text-weight-light q-ma-sm justify-between full-width",style:{"letter-spacing":"0.1rem","justify-content":"space-between"},label:"show full post",onClick:(0,i.iM)(p.expand,["stop"])},null,8,["onClick"])):(0,n.kq)("",!0),u.invoices.length?((0,n.wg)(),(0,n.iD)("div",d,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(u.invoices,((t,s)=>((0,n.wg)(),(0,n.j4)(g,{key:s,"ln-string":e.Invoice,class:"lt-sm",style:{padding:"1rem"}},null,8,["ln-string"])))),128)),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(u.invoices,((t,s)=>((0,n.wg)(),(0,n.j4)(g,{key:s,"ln-string":e.Invoice,class:"gt-xs","row-or-column":"row",style:{padding:"1rem"}},null,8,["ln-string"])))),128))])):(0,n.kq)("",!0)])}var u=s(27678),p=s.n(u),h=s(51994),g=s.n(h),m=s(64879),y=s.n(m),f=s(77984),w=s.n(f),b=s(89105),v=s.n(b),k=s(30651),x=s.n(k),C=s(18933),M=s(50332);const _=p()({html:!1,breaks:!0,linkify:!0});_.use(g()).use(y()).use(w()).use(v()).use(x()).use((e=>{var t=e.renderer.rules.link_open||function(e,t,s,n,o){return o.renderToken(e,t,s)};e.core.ruler.before("normalize","auto-imager",(e=>{e.src=e.src.replace(/https?:[^ \n]+/g,(e=>{if(e){let t=e.split("?")[0];if(t.endsWith(".gif")||t.endsWith(".png")||t.endsWith(".jpeg")||t.endsWith(".jpg")||t.endsWith(".svg")||t.endsWith(".webp")||t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".ogg"))return`![](${e})`}return e}))})),e.renderer.rules.image=(e,t)=>{let s=e[t].attrs[[e[t].attrIndex("src")]][1],n=s.split("?")[0];return n.endsWith(".gif")||n.endsWith(".png")||n.endsWith(".jpeg")||n.endsWith(".jpg")||n.endsWith(".webp")||n.endsWith(".svg")?`<img src="${s}" async loading='lazy' style="max-width: 90%; max-height: 50vh;">`:n.endsWith(".mp4")||n.endsWith(".webm")||n.endsWith(".ogg")?`<video src="${s}" controls async style="max-width: 90%; max-height: 50vh;"></video>`:void 0},e.renderer.rules.link_open=function(e,s,n,o,i){var a=e[s],l=a.attrIndex("target"),r=a.attrIndex("href"),d=/\bhttps:\/\/(www.|m.|music.)?youtu(be.com|.be)\/(watch\?v=|shorts\/)?(?<v>[a-zA-Z0-9_-]{11})(&t=(?<s>[0-9]+)s)?/;let c=a.attrs[r][1].match(d);if(c){let e=`https://www.youtube.com/embed/${c.groups.v}`;return c.groups.s&&(e+=`?start=${c.groups.s}`),`<iframe anonymous async style="height: 15rem; width: 90%; object-fit: cover;" src="${e}" loading='lazy'\n          title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>\n          </iframe>`}var u=/^https?:\/\//;return u.test(a.attrs[r][1])&&(l<0?e[s].attrPush(["target","_blank"]):e[s].attrs[l][1]="_blank"),t(e,s,n,o,i)}})),_.linkify.tlds(["onion","eth"],!0).add("bitcoin:",null).add("lightning:",null).add("http:",{validate(e,t,s){var n=e.slice(t);return s.re.http||(s.re.http=new RegExp("^\\/\\/"+s.re.src_auth+s.re.src_host_port_strict+s.re.src_path,"i")),s.re.http.test(n)?n.match(s.re.http)[0].length:0},normalize(e,t){if(t.__text_cache__.length<150||e.text<23)return;let s=new URL(e.url),n=s.host;if((s.pathname+s.search+s.hash).length>10){let t=e.text.slice(-7);"/"===t[0]&&(t=t.slice(1)),n+=`/…/${t}`}e.text=n}}).set({fuzzyEmail:!1});const T={name:"BaseMarkdown",mixins:[C.Z],emits:["expand","resized"],components:{BaseLightningCard:M.Z},data(){return{html:"",invoices:[]}},props:{content:{type:String,default:"todo".toUpperCase()+"needs to be updated"},longForm:{type:Boolean,default:!1}},computed:{parsedContent(){const e=/\b(?<i>(lnbc|LNBC)[0-9a-zA-Z]*1[0-9a-zA-Z]+)\b/g,t=(e,t)=>(this.invoices.push(e.toLowerCase()),"");let s=this.content.replace(e,t);return s}},mounted(){this.render()},updated(){this.render()},methods:{render(){this.html=_.render(this.parsedContent)+this.$refs.append.innerHTML,this.$refs.html.querySelectorAll("img").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation(),document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():e.requestFullscreen(),this.$emit("resized")})),e.addEventListener("load",(e=>{this.$emit("resized")}))}))},handleClicks(e){let{target:t}=e;if(t&&t.matches(".dynamic-content a:not([href*='://'])")&&t.href){const{altKey:s,ctrlKey:n,metaKey:o,shiftKey:i,button:a,defaultPrevented:l}=e;if(o||s||n||i)return;if(l)return;if(void 0!==a&&0!==a)return;if(t&&t.getAttribute){const e=t.getAttribute("target");if(/\b_blank\b/i.test(e))return}const r=new URL(t.href),d=r.pathname;window.location.pathname!==d&&e.preventDefault&&(e.preventDefault(),e.stopPropagation(),this.$router.push(d))}else t&&t.matches(".dynamic-content a[href*='://']")&&t.href&&e.stopPropagation()},expand(e){this.$emit("expand")}}};var q=s(11639),B=s(24455),S=s(69984),$=s.n(S);const E=(0,q.Z)(T,[["render",c]]),z=E;$()(T,"components",{QBtn:B.Z})},40930:(e,t,s)=>{"use strict";s.d(t,{Z:()=>$});var n=s(59835),o=s(86970),i=s(61957);const a={key:0,class:"text-accent timestamp"},l={class:"flex column message-bubbles"},r={key:0,class:"flex column text-left full-width q-pb-xs embeded-message",style:{display:"block"},clickable:!1},d={key:0,class:"reposts"};function c(e,t,s,c,u,p){const h=(0,n.up)("BasePost"),g=(0,n.up)("BaseMessage",!0),m=(0,n.up)("BaseUserName"),y=(0,n.up)("BaseMarkdown"),f=(0,n.up)("BaseButtonReply"),w=(0,n.up)("BaseButtonCopy"),b=(0,n.up)("BaseButtonInfo"),v=(0,n.up)("BaseButtonRelays"),k=(0,n.up)("q-list"),x=(0,n.up)("q-menu"),C=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)(["relative-position flex column",p.sent?"message-sent":"message-received"]),onClick:t[3]||(t[3]=(0,i.iM)((()=>{}),["stop"]))},[s.isEmbeded?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",a,(0,o.zw)(e.timeUTC(s.event.created_at)),1)),(0,n._)("div",l,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(p.sequence,((a,l)=>((0,n.wg)(),(0,n.iD)("div",{key:l,class:(0,o.C_)(["message-bubble",(0===l||1===p.sequence.length?" first-message":"")+(l===p.sequence.length-1?" last-message":"")])},[!s.isEmbeded&&u.taggedEvents[a.id]&&u.render?((0,n.wg)(),(0,n.iD)("div",r,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(u.taggedEvents[a.id],(s=>((0,n.wg)(),(0,n.iD)("div",{key:s.id+"_"+u.taggedEvents[a.id].length+"_"+u.render},[1===s.kind||2===s.kind?((0,n.wg)(),(0,n.iD)("div",d,[(0,n.Wm)(h,{event:s,"manual-focus":!1,"is-embeded":!0,onContextmenuCapture:(0,i.iM)((t=>e.toEvent(s.id)),["stop"])},null,8,["event","onContextmenuCapture"])])):4===s.kind?((0,n.wg)(),(0,n.j4)(g,{key:1,event:s,class:"no-padding no-margin","is-embeded":!0,clickable:"",onMounted:t[0]||(t[0]=t=>e.$emit("mounted")),onClickCapture:t[1]||(t[1]=(0,i.iM)((()=>{}),["prevent","stop"]))},null,8,["event"])):(0,n.kq)("",!0)])))),128))])):(0,n.kq)("",!0),s.isEmbeded?((0,n.wg)(),(0,n.iD)("div",{key:1,class:(0,o.C_)(["flex row justify-between q-gutter-md",p.sent?"reverse":""])},[(0,n.Wm)(m,{pubkey:a.pubkey,fallback:!0},null,8,["pubkey"]),(0,n._)("span",null,(0,o.zw)(e.niceDateUTC(s.event.created_at)),1)],2)):(0,n.kq)("",!0),(0,n.Wm)(y,{content:a.interpolated.text},null,8,["content"]),s.isEmbeded?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(x,{key:2,modelValue:u.contextMenus[l],"onUpdate:modelValue":e=>u.contextMenus[l]=e,"touch-position":"","context-menu":"",persistent:u.persistentMenu,onClick:t[2]||(t[2]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{dense:"",class:"flex column q-gutter-xs q-pa-xs"},{default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(f,{"button-class":"text-accent full-width justify-start",verbose:!0,onReply:e=>p.reply(a)},null,8,["onReply"])])),[[C]]),(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(w,{"button-class":"text-accent full-width justify-start","button-text":a.interpolated.text,verbose:!0},null,8,["button-text"])])),[[C]]),(0,n._)("div",null,[(0,n.Wm)(b,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])]),(0,n._)("div",null,[(0,n.Wm)(v,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue","persistent"]))],2)))),128))])],2)}var u=s(19302),p=s(18933),h=s(85598),g=s(32145),m=s(23426);function y(e,t,s,i,a,l){const r=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.j4)(r,{icon:"reply",unelevated:"",clickable:"",onClick:t[0]||(t[0]=t=>e.$emit("reply")),class:(0,o.C_)([""+e.buttonClass,"button-reply"]),size:e.buttonSize,dense:"",label:e.verbose?"reply":"",align:"left"},null,8,["class","size","label"])}const f=(0,n.aZ)({name:"BaseButtonReply",emits:["reply"],props:{buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}});var w=s(11639),b=s(24455),v=s(69984),k=s.n(v);const x=(0,w.Z)(f,[["render",y]]),C=x;k()(f,"components",{QBtn:b.Z});var M=s(3325);const _={name:"BaseMessage",emits:["reply","mounted"],mixins:[p.Z],props:{event:{type:Object,required:!0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:h.Z,BaseButtonInfo:g.Z,BaseButtonCopy:m.Z,BaseButtonReply:C,BaseMarkdown:M.Z},setup(){const e=(0,u.Z)();e.platform.has.touch},data(){return{invisible:!0,menu:{},render:1,contextMenus:[],persistentMenu:!1,taggedEvents:{}}},computed:{sequence(){let e=[this.event].concat(this.event.appended).filter((e=>e));return this.render,e},sent(){return this.event.pubkey===this.$store.state.keys.pub}},mounted(){setTimeout((()=>{this.invisible=!1}),20);for(let e of this.sequence){let t=e.tags?.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t))||[];t.length&&(this.taggedEvents[e.id]=[],this.processTaggedEvents(t,this.taggedEvents[e.id]))}this.event.created_at<this.$store.state.lastMessageRead[this.bech32ToHex(this.$route.params.pubkey)]&&this.$emit("mounted")},methods:{reply(e){this.$emit("reply",e)},hideMenu(){this.contextMenus=this.contextMenus.map((e=>!1)),this.togglePersistentMenu(!1)},togglePersistentMenu(e){this.persistentMenu=e}}};var T=s(56362),q=s(13246),B=s(62146);const S=(0,w.Z)(_,[["render",c]]),$=S;k()(_,"components",{QMenu:T.Z,QList:q.Z}),k()(_,"directives",{ClosePopup:B.Z})},18587:(e,t,s)=>{"use strict";s.d(t,{Z:()=>L});var n=s(59835),o=s(86970);const i=e=>((0,n.dD)("data-v-10a7d162"),e=e(),(0,n.Cn)(),e),a=i((()=>(0,n._)("span",{class:"text-bold spotnik",style:{"font-size":"1.1rem"}},"relays",-1))),l=(0,n.Uk)("   "),r={class:"text-secondary spotnik"},d=(0,n.Uk)(" seen "),c=(0,n.Uk)("   "),u={class:"spotnik"},p=(0,n.Uk)(" not seen "),h={style:{"overflow-x":"scroll"}},g={class:"relay-list"},m=(0,n.Uk)("        "),y={key:0,class:"text-secondary",style:{overflow:"hidden"}},f=(0,n.Uk)("\n          "),w=(0,n.Uk)("\n            "),b=(0,n.Uk)("\n        "),v=(0,n.Uk)("\n        "),k={key:1,style:{overflow:"hidden"}},x=(0,n.Uk)("\n          "),C=(0,n.Uk)("\n            "),M=(0,n.Uk)("\n            "),_=(0,n.Uk)("\n        "),T=(0,n.Uk)("\n      ");function q(e,t,s,i,q,B){const S=(0,n.up)("q-icon"),$=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",null,[a,l,(0,n._)("span",r,[(0,n.Wm)(S,{name:"visibility",size:"xs",dense:""}),d]),c,(0,n._)("span",u,[(0,n.Wm)(S,{name:"visibility_off",size:"xs",dense:""}),p])]),(0,n._)("div",h,[(0,n._)("pre",g,[m,s.event?.seen_on?.length?((0,n.wg)(),(0,n.iD)("div",y,[f,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.event.seen_on,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,class:"relay-item hide-scrollbar"},[w,(0,n.Wm)(S,{name:"visibility",size:"xs"}),(0,n.Uk)("\n            "+(0,o.zw)(e)+"\n          ",1)])))),128)),b])):(0,n.kq)("",!0),v,B.missingFrom.length?((0,n.wg)(),(0,n.iD)("div",k,[x,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(B.missingFrom,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,class:"relay-item unseen-relay-item hide-scrollbar",clickable:""},[C,(0,n.Wm)($,{icon:"visibility",flat:"",unelevated:"",color:"secondary",size:"sm",class:"no-padding",dense:"",onClick:t=>B.publishTo(e)},null,8,["onClick"]),M,(0,n.Wm)(S,{name:"visibility_off",size:"xs",clickable:""}),(0,n.Uk)("\n            "+(0,o.zw)(e)+"\n          ",1)])))),128)),_])):(0,n.kq)("",!0),T])])])}var B=s(34136),S=s(18933),$=s(22330);const E={name:"BaseRelayList",mixins:[S.Z],props:{event:{type:Object,required:!0}},computed:{missingFrom(){return this.event&&this.event.seen_on?Object.entries(this.$store.state.relays).filter((([e,t])=>t.write)).map((([e,t])=>e)).filter((e=>-1===this.event.seen_on.indexOf(e))):[]}},methods:{publishTo(e){console.log("publish event",this.event);let t=[e];(0,B.nY)((0,$.CX)(this.event),t)}}};var z=s(11639),Z=s(22857),W=s(24455),R=s(69984),j=s.n(R);const P=(0,z.Z)(E,[["render",q],["__scopeId","data-v-10a7d162"]]),L=P;j()(E,"components",{QIcon:Z.Z,QBtn:W.Z})},85234:(e,t,s)=>{"use strict";s.d(t,{Z:()=>M});var n=s(59835);const o={class:"flex column q-gutter-md"},i={key:0};function a(e,t,s,a,l,r){const d=(0,n.up)("BaseRelayCard");return(0,n.wg)(),(0,n.iD)("div",o,[s.listView?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",i,"added relay:")),(0,n.Wm)(d,{url:s.url},null,8,["url"])])}var l=s(18933),r=s(61957),d=s(86970);const c={class:"w-full ml-2"},u={class:"text-bold"};function p(e,t,s,o,i,a){const l=(0,n.up)("q-btn"),p=(0,n.up)("q-card");return(0,n.wg)(),(0,n.iD)("div",c,[(0,n.Wm)(p,{class:"cursor-pointer flex row justify-start items-center",flat:""},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{rounded:"",flat:"",color:"positive",size:"md",icon:s.url in e.$store.state.relays?"check":"add",label:s.url in e.$store.state.relays?"added":"add relay",disable:s.url in e.$store.state.relays,onClick:(0,r.iM)(a.addRelay,["stop"])},null,8,["icon","label","disable","onClick"]),(0,n._)("div",u,(0,d.zw)(a.cleanUrl),1)])),_:1})])}var h=s(88995);const g={name:"BaseRelayCard",props:{url:{type:String,required:!0}},computed:{cleanUrl(){return h.sanitize(this.url)}},methods:{addRelay(){Object.keys(this.$store.state.relays).length?this.$q.dialog({title:"Add new relay?",message:`Add ${this.url} to your list of relays?`,cancel:{color:"negative"},ok:{color:"positive"}}).onOk((()=>{this.$store.commit("addRelay",this.url)})):this.$q.dialog({title:"Did you set your first relay?",message:"If you are a new user, click PROCEED. If you are a user with existing relay list, Dostr has not been\n            able to find it yet. If you hit PROCEED, it will clear your relay list and replace it with this single relay.",cancel:{color:"negative"},ok:{color:"positive",label:"PROCEED"}}).onOk((()=>{this.$store.commit("addRelay",this.url)}))}}};var m=s(11639),y=s(44458),f=s(24455),w=s(69984),b=s.n(w);const v=(0,m.Z)(g,[["render",p],["__scopeId","data-v-93c6da72"]]),k=v;b()(g,"components",{QCard:y.Z,QBtn:f.Z});const x={name:"BaseRelayRecommend",mixins:[l.Z],components:{BaseRelayCard:k},props:{url:{type:String,required:!0},listView:{type:Boolean,default:!1}}},C=(0,m.Z)(x,[["render",a]]),M=C},83325:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});var n=s(59835),o=s(86970),i=s(61957);const a={style:{cursor:"pointer","padding-left":"0.2rem"},class:"relative-position"},l={class:"q-pl-sm"},r={key:0,class:"base-select-list",style:{position:"absolute",top:"1.3rem","z-index":"1","max-height":"15rem","overflow-y":"auto",width:"100%","font-family":"'Spotnik'"}},d={class:"",style:{display:"block","margin-block-start":"0.5rem","margin-block-end":"0.5rem","padding-inline-start":"0.5rem"}};function c(e,t,s,c,u,p){const h=(0,n.up)("q-icon");return(0,n.wg)(),(0,n.iD)("div",a,[(0,n._)("div",{class:"flex justify-between base-select no-wrap items-center",style:(0,o.j5)([{"border-radius":"3px"},e.allowSelection?"cursor: pointer; opacity: 1;":"cursor: not-allowed; opacity: .5;"]),onClick:t[0]||(t[0]=(0,i.iM)(((...t)=>e.toggle&&e.toggle(...t)),["stop"]))},[(0,n._)("span",l,[(0,n.WI)(e.$slots,"default",{},void 0,!0)]),(0,n.Wm)(h,{name:e.selecting?"arrow_drop_up":"arrow_drop_down",size:"xs"},null,8,["name"])],4),e.selecting&&e.allowSelection?((0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("ul",d,[(0,n.WI)(e.$slots,"list-items",{},void 0,!0)])])):(0,n.kq)("",!0)])}const u=(0,n.aZ)({name:"BaseSelect",emits:["toggle"],props:{allowSelection:{type:Boolean,default:!0},selecting:{type:Boolean,default:!1}},methods:{toggle(){this.allowSelection&&this.$emit("toggle")}}});var p=s(11639),h=s(22857),g=s(69984),m=s.n(g);const y=(0,p.Z)(u,[["render",c],["__scopeId","data-v-d81cd76a"]]),f=y;m()(u,"components",{QIcon:h.Z})},15554:(e,t,s)=>{"use strict";s.d(t,{Z:()=>j});var n=s(59835),o=s(86970),i=s(61957);const a={class:"text-primary sf-mono"};function l(e,t,s,l,r,d){const c=(0,n.up)("BaseUserAvatar"),u=(0,n.up)("BaseUserName"),p=(0,n.up)("BaseMarkdown"),h=(0,n.up)("BaseUserCardActions"),g=(0,n.up)("q-item-section"),m=(0,n.up)("q-item");return(0,n.wg)(),(0,n.j4)(m,{clickable:e.clickable,unelevated:"",outlined:"",class:(0,o.C_)(["no-padding flex row justify-start items-center cursor-pointer",(e.alignRight?"text-right reverse":"text-left")+(e.headerMode?" header-mode":"")+(e.hasTouch||e.headerMode||!e.actionButtons?"":" hidden-action-buttons")]),onClick:t[0]||(t[0]=(0,i.iM)((t=>e.toProfile(e.pubkey)),["stop"])),style:(0,o.j5)([{"max-width":"100%",gap:"0.5rem"},e.headerMode?"margin-top: 100px;":""])},{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(c,{pubkey:e.pubkey,"align-right":e.alignRight,size:e.headerMode?"10rem":"lg",class:(0,o.C_)(e.headerMode?"self-center":"")},null,8,["pubkey","align-right","size","class"])]),(0,n.Wm)(g,{class:(0,o.C_)(e.headerMode?"self-start":""),style:(0,o.j5)(e.headerMode?"":"white-space: nowrap; overflow: auto; padding-left: 8px;")},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{pubkey:e.pubkey,"header-mode":e.headerMode,"show-verified":!0,class:(0,o.C_)(e.headerMode?" text-h6":""),"align-right":e.alignRight,"show-following":e.showFollowing,wrap:e.wrap},null,8,["pubkey","header-mode","class","align-right","show-following","wrap"]),(0,n._)("div",a,(0,o.zw)(e.shorten(e.npubKey)),1),e.headerMode?((0,n.wg)(),(0,n.j4)(p,{key:0,content:e.$store.getters.profileDescription(e.pubkey)},null,8,["content"])):(0,n.kq)("",!0),e.actionButtons?((0,n.wg)(),(0,n.j4)(h,{key:1,pubkey:e.pubkey,class:"action-buttons"},null,8,["pubkey"])):(0,n.kq)("",!0)])),_:1},8,["class","style"])])),_:1},8,["clickable","class","style"])}var r=s(19302),d=s(18933);function c(e,t,s,a,l,r){const d=(0,n.up)("BaseButtonCopy"),c=(0,n.up)("BaseButtonMessage"),u=(0,n.up)("BaseButtonFollow"),p=(0,n.up)("BaseButtonLightning");return(0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)(["flex row no-wrap",e.buttonGroupClass]),style:{gap:"0.3rem"}},[(0,n.Wm)(d,{"button-text":e.npubKey,"button-size":"sm","text-color":"primary","tooltip-text":"COPY PUBLIC KEY",onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"]))},null,8,["button-text"]),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,n.wg)(),(0,n.j4)(c,{key:0,"button-to":"/messages/"+e.npubKey,"button-size":"sm","text-color":"primary",onClick:t[1]||(t[1]=(0,i.iM)((()=>{}),["stop"]))},null,8,["button-to"])):(0,n.kq)("",!0),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,n.wg)(),(0,n.j4)(u,{key:1,pubkey:e.pubkey,"button-size":"sm",onClick:t[2]||(t[2]=(0,i.iM)((()=>{}),["stop"]))},null,8,["pubkey"])):(0,n.kq)("",!0),e.pubkey!==e.$store.state.keys.pub&&e.$store.getters.profileLud06(e.pubkey)?((0,n.wg)(),(0,n.j4)(p,{key:2,pubkey:e.pubkey},null,8,["pubkey"])):(0,n.kq)("",!0)],2)}const u=(0,n.Uk)(" ENCRYPTED MESSAGE ");function p(e,t,s,a,l,r){const d=(0,n.up)("q-tooltip"),c=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.j4)(c,{icon:"mail_lock",unelevated:"",clickable:"",class:(0,o.C_)([e.buttonClass,"button-message"]),size:e.buttonSize,to:e.buttonTo,onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"])),dense:""},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,n.w5)((()=>[u])),_:1})])),_:1},8,["class","size","to"])}const h=(0,n.aZ)({name:"BaseButtonMessage",props:{buttonTo:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},methods:{copy(){console.log(this.buttonText),navigator.clipboard.writeText(this.buttonText)}}});var g=s(11639),m=s(24455),y=s(46858),f=s(69984),w=s.n(f);const b=(0,g.Z)(h,[["render",p]]),v=b;function k(e,t,s,a,l,r){const d=(0,n.up)("q-icon"),c=(0,n.up)("q-tooltip"),u=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.j4)(u,{class:(0,o.C_)(e.buttonClass+(e.isFollowing?"button-unfollow":"button-follow")),size:e.buttonSize,unelevated:"","text-color":e.isFollowing?"":"secondary",dense:"",onClick:(0,i.iM)(e.toggleFollowing,["stop"])},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{name:e.isFollowing?"person_remove":"person_add",class:(0,o.C_)(e.isFollowing?"flip-horizontal":"")},null,8,["name","class"]),(0,n.Wm)(c,{class:"tooltip",anchor:"center left",self:"center right",offset:[10,10]},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.isFollowing?"unfollow".toUpperCase():"follow".toUpperCase()),1)])),_:1})])),_:1},8,["class","size","text-color","onClick"])}w()(h,"components",{QBtn:m.Z,QTooltip:y.Z});s(46727);const x=(0,n.aZ)({name:"BaseButtonFollow",props:{pubkey:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},computed:{isFollowing(){return this.$store.state.follows.includes(this.pubkey)}},methods:{toggleFollowing(){this.$store.state.follows.length?this.isFollowing?this.unfollow():this.follow():this.$q.dialog({title:"set your first follow?".toUpperCase(),message:"✅ If you are a new user, click PROCEED.</br>⚠️ If you are a user who already has a 'Follows' list, Dostr has not been\n            able to find it yet.</br>❌ If you hit PROCEED, it will clear your 'Follows' list and replace it with this single follow.",cancel:{color:"accent"},ok:{color:"accent",label:"proceed"},html:!0}).onOk((()=>{this.follow()}))},unfollow(){this.$store.commit("unfollow",this.pubkey)},follow(){this.$store.commit("follow",this.pubkey)}}});var C=s(22857);const M=(0,g.Z)(x,[["render",k],["__scopeId","data-v-f41898c6"]]),_=M;w()(x,"components",{QBtn:m.Z,QIcon:C.Z,QTooltip:y.Z});var T=s(23426),q=s(28669);const B=(0,n.aZ)({name:"BaseUserCardActions",mixins:[d.Z],props:{pubkey:{type:String,required:!0},buttonGroupClass:{type:String,required:!1,default:""}},components:{BaseButtonMessage:v,BaseButtonFollow:_,BaseButtonCopy:T.Z,BaseButtonLightning:q.Z},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}}),S=(0,g.Z)(B,[["render",c]]),$=S;var E=s(3325);const z=(0,n.aZ)({name:"BaseUserCard",components:{BaseUserCardActions:$,BaseMarkdown:E.Z},mixins:[d.Z],props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,required:!1,default:!1},clickable:{type:Boolean,required:!1,default:!0},headerMode:{type:Boolean,required:!1,default:!1},actionButtons:{type:Boolean,required:!1,default:!0},showFollowing:{type:Boolean,default:!1},wrap:{type:Boolean,default:!0}},setup(){const e=(0,r.Z)();let t=e?.platform.has.touch||!1;return{hasTouch:t}},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}});var Z=s(490),W=s(76749);const R=(0,g.Z)(z,[["render",l],["__scopeId","data-v-be6f5cbe"]]),j=R;w()(z,"components",{QItem:Z.Z,QItemSection:W.Z})},46601:()=>{},89214:()=>{},52361:()=>{},94616:()=>{}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=e,(()=>{s.amdO={}})(),(()=>{var e=[];s.O=(t,n,o,i)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,o,i]=e[c],l=!0,r=0;r<n.length;r++)(!1&i||a>=i)&&Object.keys(s.O).every((e=>s.O[e](n[r])))?n.splice(r--,1):(l=!1,i<a&&(a=i));if(l){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,o,i]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var i=Object.create(null);s.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var l=2&o&&n;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>a[e]=()=>n[e]));return a["default"]=()=>n,s.d(i,a),i}})(),(()=>{s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[]))})(),(()=>{s.u=e=>"js/"+(443===e?"about":e)+"."+{35:"dcf8cd34",129:"9b8ac98e",218:"a59fb6eb",252:"04d46eba",286:"ce378c94",363:"9c8c9c44",399:"57f3ebb1",408:"90d90617",443:"c50a224a",591:"6107b37e",740:"e787063b",771:"e3b233a9",883:"3a813f79",989:"d637cd0d"}[e]+".js"})(),(()=>{s.miniCssF=e=>"css/"+({143:"app",443:"about",736:"vendor"}[e]||e)+"."+{35:"94a32181",129:"d27ca446",143:"32324ae5",218:"8f912fb7",286:"d248924c",363:"f5c9dbbb",408:"206efb72",443:"65f00f79",591:"b989bfbc",736:"28563a9c",771:"3eb6b3c5"}[e]+".css"})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="dostr:";s.l=(n,o,i,a)=>{if(e[n])e[n].push(o);else{var l,r;if(void 0!==i)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){l=u;break}}l||(r=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.setAttribute("data-webpack",t+i),l.src=n),e[n]=[o];var p=(t,s)=>{l.onerror=l.onload=null,clearTimeout(h);var o=e[n];if(delete e[n],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach((e=>e(s))),t)return t(s)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),r&&document.head.appendChild(l)}}})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{s.j=143})(),(()=>{s.p="/dostr-client/"})(),(()=>{var e=(e,t,s,n)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var i=i=>{if(o.onerror=o.onload=null,"load"===i.type)s();else{var a=i&&("load"===i.type?"missing":i.type),l=i&&i.target&&i.target.href||t,r=new Error("Loading CSS chunk "+e+" failed.\n("+l+")");r.code="CSS_CHUNK_LOAD_FAILED",r.type=a,r.request=l,o.parentNode.removeChild(o),n(r)}};return o.onerror=o.onload=i,o.href=t,document.head.appendChild(o),o},t=(e,t)=>{for(var s=document.getElementsByTagName("link"),n=0;n<s.length;n++){var o=s[n],i=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(i===e||i===t))return o}var a=document.getElementsByTagName("style");for(n=0;n<a.length;n++){o=a[n],i=o.getAttribute("data-href");if(i===e||i===t)return o}},n=n=>new Promise(((o,i)=>{var a=s.miniCssF(n),l=s.p+a;if(t(a,l))return o();e(n,l,o,i)})),o={143:0};s.f.miniCss=(e,t)=>{var s={35:1,129:1,218:1,286:1,363:1,408:1,443:1,591:1,771:1};o[e]?t.push(o[e]):0!==o[e]&&s[e]&&t.push(o[e]=n(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))}})(),(()=>{s.b=document.baseURI||self.location.href;var e={143:0};s.f.j=(t,n)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((s,n)=>o=e[t]=[s,n]));n.push(o[2]=i);var a=s.p+s.u(t),l=new Error,r=n=>{if(s.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",l.name="ChunkLoadError",l.type=i,l.request=a,o[1](l)}};s.l(a,r,"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[a,l,r]=n,d=0;if(a.some((t=>0!==e[t]))){for(o in l)s.o(l,o)&&(s.m[o]=l[o]);if(r)var c=r(s)}for(t&&t(n);d<a.length;d++)i=a[d],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(c)},n=globalThis["webpackChunkdostr"]=globalThis["webpackChunkdostr"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=s.O(void 0,[736,64],(()=>s(3308)));n=s.O(n)})();
(()=>{var e={3671:(e,t,n)=>{"use strict";var s=n(61957),i=n(71947),o=n(60499),a=n(59835);function l(e,t,n,s,i,o){const l=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(l)}const r=(0,a.aZ)({name:"App"});var d=n(11639);const c=(0,d.Z)(r,[["render",l]]),u=c;var p=n(54927),h=n(23340),g=n(28339);const m=[{path:"/",component:()=>Promise.all([n.e(736),n.e(64),n.e(165)]).then(n.bind(n,18349)),children:[{path:"",component:()=>Promise.all([n.e(736),n.e(64),n.e(443)]).then(n.bind(n,64122)),name:"feed"},{path:"/follow",component:()=>Promise.all([n.e(736),n.e(64),n.e(710)]).then(n.bind(n,17725)),name:"follow"},{path:"/settings/:initUser?",component:()=>Promise.all([n.e(736),n.e(64),n.e(757)]).then(n.bind(n,40511)),name:"settings"},{path:"/messages/inbox",component:()=>Promise.all([n.e(736),n.e(557)]).then(n.bind(n,18557)),name:"inbox"},{path:"/messages/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(654)]).then(n.bind(n,82654)),name:"messages"},{path:"/:eventId(note[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(64),n.e(608)]).then(n.bind(n,97608)),name:"event"},{path:"/notifications",component:()=>Promise.all([n.e(736),n.e(64),n.e(683)]).then(n.bind(n,767)),name:"notifications"},{path:"/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(64),n.e(970)]).then(n.bind(n,90352)),name:"profile"},{path:"/hashtag/:hashtagId([a-zA-Z0-9_]{1,63})",component:()=>Promise.all([n.e(736),n.e(64),n.e(433)]).then(n.bind(n,89433)),name:"hashtag"},{path:"/devTools",component:()=>Promise.all([n.e(736),n.e(551)]).then(n.bind(n,12551)),name:"devTools"},{path:"/:catchAll(.*)*",component:()=>Promise.all([n.e(736),n.e(955)]).then(n.bind(n,23955))}]}],y=m,f=(0,h.BC)((()=>{const e=g.PO,t=(0,g.p7)({routes:y,history:e("/dostr-client/")});return t}));async function w(e,t){const s=e(u);s.use(i.Z,t);const a="function"===typeof p["default"]?await(0,p["default"])({}):p["default"],{storeKey:l}=await Promise.resolve().then(n.bind(n,54927)),r=(0,o.Xl)("function"===typeof f?await f({store:a}):f);return a.$router=r,{app:s,store:a,storeKey:l,router:r}}var b=n(6827),v=n(97286),k=n(79231);const x={config:{dark:!0,notify:{closeBtn:!0}},plugins:{Notify:b.Z,Dialog:v.Z,Meta:k.ZP}},C="/dostr-client/",M=/\/\//,_=e=>(C+e).replace(M,"/");async function q({app:e,router:t,store:n,storeKey:s},i){let o=!1;const a=e=>{try{return _(t.resolve(e).href)}catch(n){}return Object(e)===e?null:e},l=e=>{if(o=!0,"string"===typeof e&&/^https?:\/\//.test(e))return void(window.location.href=e);const t=a(e);null!==t&&(window.location.href=t)},r=window.location.href.replace(window.location.origin,"");for(let c=0;!1===o&&c<i.length;c++)try{await i[c]({app:e,router:t,store:n,ssrContext:null,redirect:l,urlPath:r,publicPath:C})}catch(d){return d&&d.url?void l(d.url):void console.error("[Quasar] boot error:",d)}!0!==o&&(e.use(t),e.use(n,s),e.mount("#q-app"))}w(s.ri,x).then((e=>Promise.all([Promise.resolve().then(n.bind(n,54940)),Promise.resolve().then(n.bind(n,55635))]).then((t=>{const n=t.map((e=>e.default)).filter((e=>"function"===typeof e));q(e,n)}))))},54940:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>sn});var s=n(59835),i=n(86970),o=n(61957);const a=e=>((0,s.dD)("data-v-620dd48c"),e=e(),(0,s.Cn)(),e),l={key:0,class:"is-reply-connector"},r={key:1,class:"has-reply-connector"},d={ref:"postHeader",clickable:"",avatar:"",top:"",class:"relative-position q-px-xs flex row no-wrap justify-between items-center"},c={class:"flex row no-wrap items-center",style:{gap:"1rem"}},u={class:"q-pb-xs"},p=a((()=>(0,s._)("span",null,"in reply to ",-1))),h={style:{background:"var(--q-background)"}},g={style:{background:"var(--q-background)"}},m={class:"flex column no-wrap col full-width"},y={class:"q-py-sm q-px-lg"},f={key:3},w={key:4,class:"reposts flex column q-pr-md",clickable:!1},b=["color"],v=(0,s.Uk)(" embed "),k=(0,s.Uk)(" repost "),x=(0,s.Uk)(" quote "),C={class:"no-wrap flex row items-center self-start",style:{gap:"0.5rem"}},M=(0,s.Uk)(" reply "),_={key:0,style:{position:"abosolute",right:"0"}},q=(0,s.Uk)(" cancel "),T=a((()=>(0,s._)("span",{class:"text-caption"}," copy the formatted event ID below and paste it in any post to embed this event ",-1))),B=a((()=>(0,s._)("br",null,null,-1))),$={class:"text-primary",style:{"word-break":"break-all"}},z={key:1,class:"full-width",style:{"padding-left":"12px"}};function Z(e,t,n,a,Z,S){const j=(0,s.up)("BaseUserAvatar"),W=(0,s.up)("q-item-label"),R=(0,s.up)("q-space"),L=(0,s.up)("BaseUserName"),P=(0,s.up)("BaseButtonInfo"),E=(0,s.up)("BaseButtonRelays"),D=(0,s.up)("q-fab"),U=(0,s.up)("BaseMarkdown"),I=(0,s.up)("BaseRelayRecommend"),N=(0,s.up)("BaseUserCard"),O=(0,s.up)("BasePost",!0),A=(0,s.up)("BaseButtonLightning"),F=(0,s.up)("q-tab"),Q=(0,s.up)("q-tooltip"),H=(0,s.up)("q-icon"),V=(0,s.up)("q-tabs"),K=(0,s.up)("q-item-section"),J=(0,s.up)("BaseButtonCopy"),Y=(0,s.up)("q-tab-panel"),X=(0,s.up)("BasePostEntry"),G=(0,s.up)("q-tab-panels"),ee=(0,s.up)("BasePostThread");return(0,s.wg)(),(0,s.iD)("div",{color:"accent",class:(0,i.C_)(["post-padding cursor-pointer no-hover flex column no-wrap relative-position",(e.hasReply?"post-has-reply":"")+(e.isReply?" post-is-reply":"")+(e.highlighted?" post-highlighted":"")+(e.isChildReply?" post-is-child-reply":"")+(e.hasReplyChildren?" post-has-child-reply":"")]),clickable:"","manual-focus":"",onClick:t[14]||(t[14]=(0,o.iM)((t=>e.toEvent(e.event.id)),["stop"]))},[e.isReply?((0,s.wg)(),(0,s.iD)("div",l)):(0,s.kq)("",!0),e.hasReply?((0,s.wg)(),(0,s.iD)("div",r)):(0,s.kq)("",!0),"reply"===e.replyMode?((0,s.wg)(),(0,s.iD)("div",{key:2,class:"has-replying-connector",style:(0,i.j5)("height: "+(e.headerHeight+e.postHeight)+"px;")},null,4)):(0,s.kq)("",!0),e.hasReplyChildren?((0,s.wg)(),(0,s.iD)("div",{key:3,ref:"hasChildReplyConnector",class:"has-child-reply-connector",style:(0,i.j5)([{visibility:"hidden"},e.childReplyConnectorStyle()])},null,4)):(0,s.kq)("",!0),(0,s._)("div",d,[(0,s._)("div",c,[(0,s.Wm)(j,{pubkey:e.event.pubkey,size:e.highlighted?"lg":"md",round:!0,bordered:e.hasReply||e.isReply||e.hasReplyChildren||e.isChildReply,"hover-effect":!0,style:{"z-index":"1"}},null,8,["pubkey","size","bordered"]),(0,s._)("div",u,[(0,s.Wm)(W,{caption:"",class:"text-secondary",style:{opacity:"0.7"}},{default:(0,s.w5)((()=>[(0,s._)("span",{onClick:t[0]||(t[0]=(0,o.iM)((t=>e.toProfile(e.event.pubkey)),["stop"]))},(0,i.zw)(e.shorten(e.hexToBech32(e.event.pubkey,"npub"))),1)])),_:1}),(0,s.Wm)(R),(0,s.Wm)(W,{line:1,clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(L,{pubkey:e.event.pubkey,"show-verified":!0,class:"text-bold","show-following":!0,wrap:!0},null,8,["pubkey"])])),_:1}),!e.tagged||"event"==e.$route.name||e.isReply||e.isChildReply?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(W,{key:0,class:"q-pl-sm",style:{"font-size":"0.8rem"}},{default:(0,s.w5)((()=>[p,(0,s._)("a",{onClick:t[1]||(t[1]=(0,o.iM)((t=>e.toEvent(e.tagged)),["stop"]))},(0,i.zw)(e.shorten(e.hexToBech32(e.tagged,"note"))),1)])),_:1}))])]),(0,s._)("div",{class:"flex row no-wrap items-center post-info",style:{"z-index":"1"},onClick:t[2]||(t[2]=(0,o.iM)((()=>{}),["stop"]))},[(0,s.Wm)(W,{class:"q-pr-xs",style:{opacity:"0.8","font-size":"90%"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.niceDate(e.event.created_at)),1)])),_:1}),(0,s.Wm)(D,{color:"secondary",icon:"more_vert",direction:"down","vertical-actions-align":"right",padding:"xs",flat:"",dense:""},{default:(0,s.w5)((()=>[(0,s._)("div",h,[(0,s.Wm)(P,{"button-class":"text-secondary full-width justify-start no-wrap",event:e.event,size:"md"},null,8,["event"])]),(0,s._)("div",g,[(0,s.Wm)(E,{"button-class":"text-secondary full-width justify-start no-wrap",event:e.event,size:"md"},null,8,["event"])])])),_:1})])],512),(0,s._)("div",m,[(0,s.Wm)(K,{ref:"postContent"},{default:(0,s.w5)((()=>[(0,s._)("div",y,[1===e.event.kind?((0,s.wg)(),(0,s.j4)(U,{key:0,content:e.event.interpolated.text,"long-form":e.isLongForm,onExpand:t[3]||(t[3]=t=>e.isLongForm=!e.isLongForm),onResized:t[4]||(t[4]=t=>e.calcConnectorValues(10))},null,8,["content","long-form"])):2===e.event.kind?((0,s.wg)(),(0,s.j4)(I,{key:1,url:e.sanitize(e.event.content)},null,8,["url"])):0===e.event.kind?((0,s.wg)(),(0,s.j4)(N,{key:2,pubkey:e.event.pubkey,"header-mode":!0},null,8,["pubkey"])):((0,s.wg)(),(0,s.iD)("pre",f," "+(0,i.zw)(e.cleanEvent)+" ",1)),e.isEmbeded||!e.isQuote&&!e.isRepost?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.mentionEvents,((n,i)=>((0,s.wg)(),(0,s.iD)("div",{key:n+"_"+e.mentionEvents.length+"_"+i},[e.$store.state.eventsCache[n]?((0,s.wg)(),(0,s.j4)(O,{key:0,event:e.$store.state.eventsCache[n],"manual-focus":!1,"is-embeded":!0,onClick:(0,o.iM)((t=>e.toEvent(n)),["stop"]),onResized:t[5]||(t[5]=t=>e.calcConnectorValues(10))},null,8,["event","onClick"])):(0,s.kq)("",!0)])))),128))]))]),!e.isRepost&&e.$store.state.keys.pub&&-1!==e.replyDepth?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"flex row items-center no-wrap reply-buttons full-width",color:e.replying?"primary":""},[(0,s.Wm)(V,{modelValue:e.replyMode,"onUpdate:modelValue":t[7]||(t[7]=t=>e.replyMode=t),class:"text-secondary full-width",align:"justify",unelevated:"",dense:"",flat:"","active-color":"primary",size:e.highlighted?"md":"sm",onClick:t[8]||(t[8]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{class:"no-padding"},{default:(0,s.w5)((()=>[e.$store.getters.profileLud06(e.event.pubkey)?((0,s.wg)(),(0,s.j4)(A,{key:0,pubkey:e.event.pubkey,size:e.highlighted?"md":"sm"},null,8,["pubkey","size"])):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(F,{name:"embed",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{name:"link"},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[v])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{name:"repost",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{name:"repeat"},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[k])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{name:"quote",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{name:"format_quote"},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[x])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{name:"reply",class:"no-padding no-wrap flex row"},{default:(0,s.w5)((()=>[(0,s._)("div",C,[(0,s.Wm)(H,{name:"chat_bubble_outline",class:"flip-horizontal relative-position"},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[M])),_:1})])),_:1}),e.replyCount?((0,s.wg)(),(0,s.iD)("span",_,(0,i.zw)(e.replyCount),1)):(0,s.kq)("",!0)])])),_:1}),e.replyMode&&"tip"!==e.replyMode?((0,s.wg)(),(0,s.j4)(F,{key:0,class:"no-padding",onClick:t[6]||(t[6]=(0,o.iM)((t=>e.replyMode=null),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{name:"close",color:"accent"},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[q])),_:1})])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1},8,["modelValue","size"])],8,b)):(0,s.kq)("",!0)])),_:1},512),e.replyMode&&"tip"!==e.replyMode?((0,s.wg)(),(0,s.j4)(K,{key:0,class:"new-reply-box",ref:"replyContent"},{default:(0,s.w5)((()=>[(0,s.Wm)(G,{modelValue:e.replyPanel,"onUpdate:modelValue":t[11]||(t[11]=t=>e.replyPanel=t),class:"no-padding full-width overflow-hidden",style:{background:"var(--q-background)","max-width":"100%","z-index":"1"},onTransition:t[12]||(t[12]=t=>e.calcConnectorValues(10))},{default:(0,s.w5)((()=>[(0,s.Wm)(Y,{name:"embed",class:"no-padding",onClick:t[9]||(t[9]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[T,(0,s.Wm)(J,{"button-text":e.hexToBech32(e.event.id,"note"),color:"primary",flat:"","tooltip-text":"copy event ID"},null,8,["button-text"]),B,(0,s._)("span",$,(0,i.zw)(e.hexToBech32(e.event.id,"note")),1)])),_:1}),(0,s.Wm)(Y,{name:"reply",class:"q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(X,{event:e.event,"reply-mode":e.replyMode,onSent:e.replySent,onResized:t[10]||(t[10]=t=>e.calcConnectorValues(10))},null,8,["event","reply-mode","onSent"])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,s.kq)("",!0),e.hasReplyChildren&&-1!==e.replyDepth&&e.event.replies&&e.event.replies.length<3?((0,s.wg)(),(0,s.iD)("div",z,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.event.replies,(n=>((0,s.wg)(),(0,s.iD)("div",{key:n[0].id,ref_for:!0,ref:"childReplyContent"},[(0,s.Wm)(ee,{events:n,"reply-depth":e.replyDepth+1,onResized:t[13]||(t[13]=t=>e.calcConnectorValues(10)),onAddEvent:e.addEvent},null,8,["events","reply-depth","onAddEvent"])])))),128))])):(0,s.kq)("",!0)])],2)}var S=n(22330),j=n(18933),W=n(90656),R=n(62863),L=n(29280),P=n(39474),E=n(88844),D=n(48730),U=n(88995);const I=(0,s.aZ)({name:"BasePost",emits:["resized","add-event","mounted"],mixins:[j.Z],props:{event:{type:Object,required:!0},highlighted:{type:Boolean,default:!1},position:{type:String,default:"standalone"},replyDepth:{type:Number,default:0},replyCount:{type:Number,default:0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:W.Z,BaseButtonInfo:R.Z,BaseButtonCopy:L.Z,BaseMarkdown:P.Z,BaseRelayRecommend:E.Z,BaseButtonLightning:D.Z},data(){return{clicking:!1,replying:!1,childReplyHeights:[],postHeight:0,replyHeight:0,reposts:[],eventSub:null,replyMode:"",resizing:!1,trigger:1,isLongForm:!1}},computed:{tagged(){let e=this.event.interpolated?.replyEvents;return e?.length?e[e.length-1]:null},taggedPubkeys(){let e=this.event.tags.filter((e=>"p"===e[0]&&e[1])).map((e=>e[1]));return e?.length?e:null},isRepost(){return""===this.event.interpolated?.text&&this.event.interpolated.mentionEvents.length},isQuote(){return this.event.interpolated?.text&&this.event.interpolated.mentionEvents.length},mentionEvents(){return this.event.interpolated?.mentionEvents},isReply(){return"middle"===this.position||"last"===this.position},hasReply(){return"middle"===this.position||"first"===this.position},isChildReply(){return!!this.replyDepth},hasReplyChildren(){return!!(this.event.replies&&this.event.replies.length>0&&this.event.replies.length<3)},postContentWidth(){return this.resizing,this.$refs.postContent?.$el?.clientWidth},postContentHeight(){return this.resizing,this.$refs.postContent?.$el?.clientHeight},replyContentHeight(){return this.replyMode&&this.resizing&&this.$refs.replyContent?.$el?this.$refs.replyContent?.$el?.clientHeight:this.$refs.replyContent?.$el?.clientHeight||0},replyPanel(){return"embed"===this.replyMode?"embed":this.replyMode?"reply":""},cleanEvent(){return this.sanitize(JSON.stringify((0,S.CX)(this.event),null,2))}},mounted(){this.isEmbeded||!this.isQuote&&!this.isRepost||(Array.isArray(this.reposts)||(this.reposts=[]),this.processTaggedEvents(this.mentionEvents,this.reposts)),this.calcConnectorValues(),this.$emit("mounted"),this.isLongForm=this.event.content.length>600||this.event.content.split(/\r\n|\r|\n/).length>10},activated(){this.calcConnectorValues(),this.trigger++},methods:{childReplyConnectorStyle(){if(this.childReplyHeights?.length){let e=this.headerHeight+this.postHeight+this.childReplyHeights.slice(0,-1).reduce(((e,t)=>e+t),0);return e+=this.isChildReply?12:22,this.replyHeight&&(e+=this.replyHeight),"visibility: visible; height: "+e+"px"}return""},calcConnectorValues(e=2e3){this.resizing=!this.resizing,(0,s.Y3)((()=>{setTimeout((()=>{this.headerHeight=this.$refs.postHeader?this.$refs.postHeader.clientHeight:0,this.postHeight=this.postContentHeight,this.replyHeight=this.replyContentHeight,this.hasReplyChildren&&(this.childReplyHeights=this.$refs.childReplyContent?.map((e=>e.clientHeight))),this.$emit("resized")}),e)}))},toggleReplying(){""===this.replyMode?(this.replying=!0,this.replyMode="reply"):(this.replyMode="",this.replying=!1),this.calcConnectorValues(10)},replySent(e){this.replying=!1,this.replyMode="",this.$emit("add-event",e)},niceDate(e){return this.trigger,this.niceDateUTC(e)},addEvent(e){this.$emit("add-event",e)},sanitize(e){return U.sanitize(e)}}});var N=n(11639),O=n(33115),A=n(90136),F=n(88830),Q=n(24455),H=n(56362),V=n(76749),K=n(47817),J=n(70900),Y=n(22857),X=n(46858),G=n(89800),ee=n(84106),te=n(69984),ne=n.n(te);const se=(0,N.Z)(I,[["render",Z],["__scopeId","data-v-620dd48c"]]),ie=se;ne()(I,"components",{QItemLabel:O.Z,QSpace:A.Z,QFab:F.Z,QBtn:Q.Z,QMenu:H.Z,QItemSection:V.Z,QTabs:K.Z,QTab:J.Z,QIcon:Y.Z,QTooltip:X.Z,QTabPanels:G.Z,QTabPanel:ee.Z});const oe={key:0,class:"text-bold flex row no-wrap items-center",style:{gap:"0.2rem"},clickable:""},ae=(0,s.Uk)(" following "),le={key:0,style:{opacity:"0.9","font-size":"90%","font-weight":"300","line-height":"90%"}},re={key:1,style:{opacity:"0.9","font-size":"90%","font-weight":"300","line-height":"90%"}};function de(e,t,n,a,l,r){const d=(0,s.up)("q-tooltip"),c=(0,s.up)("q-icon"),u=(0,s.up)("BaseButtonNIP05");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["cursor-pointer flex",(n.alignRight?" justify-end":" justify-start")+(n.headerMode?" column items-start":" row items-center")+(n.wrap?"":" no-wrap")]),onClick:t[0]||(t[0]=(0,o.iM)((t=>e.toProfile(n.pubkey)),["stop"])),style:(0,i.j5)([{gap:"0.1rem"},n.alignRight?"text-align: right;":"text-align: left"])},[e.$store.getters.name(n.pubkey)?((0,s.wg)(),(0,s.iD)("div",oe,[(0,s.Uk)((0,i.zw)(e.$store.getters.name(n.pubkey))+" ",1),n.showFollowing&&r.isFollow?((0,s.wg)(),(0,s.j4)(c,{key:0,name:"visibility",size:n.headerMode?"sm":"xs",color:"secondary"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[ae])),_:1})])),_:1},8,["size"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s._)("div",{class:"flex row no-wrap items-center",style:(0,i.j5)(n.headerMode?"gap: .3rem;":"gap: .1rem;")},[(0,s.Wm)(u,{pubkey:n.pubkey,"button-size":n.headerMode?"sm":"xs"},null,8,["pubkey","button-size"]),e.$store.getters.NIP05Id(n.pubkey)?((0,s.wg)(),(0,s.iD)("div",le,(0,i.zw)(n.headerMode?r.niceNIP05:r.niceShortNIP05),1)):(0,s.kq)("",!0)],4),n.headerMode&&e.lnurlToLnAddr(e.$store.getters.profileLud06(n.pubkey))?((0,s.wg)(),(0,s.iD)("div",re," ⚡️"+(0,i.zw)(e.lnurlToLnAddr(e.$store.getters.profileLud06(n.pubkey))),1)):(0,s.kq)("",!0)],6)}n(46727);const ce={class:"flex row justify-end"},ue={class:"overflow-auto"},pe={class:"text-subtitle1 flex row overflow-auto items-end q-gutter-sm"},he=(0,s.Uk)(" NIP05 identifier "),ge=["href"],me={key:0},ye=(0,s._)("div",null,[(0,s.Uk)(" learn how to get NIP05 verified "),(0,s._)("a",{href:"https://gist.github.com/metasikander/609a538e6a03b2f67e5c8de625baed3e",target:"_"},"here")],-1),fe=(0,s.Uk)(" NIP05 verified ");function we(e,t,n,a,l,r){const d=(0,s.up)("q-btn"),c=(0,s.up)("q-spinner-orbit"),u=(0,s.up)("q-inner-loading"),p=(0,s.up)("q-card-section"),h=(0,s.up)("q-card"),g=(0,s.up)("q-dialog"),m=(0,s.up)("q-tooltip"),y=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(g,{modelValue:l.NIP05Dialog,"onUpdate:modelValue":t[0]||(t[0]=e=>l.NIP05Dialog=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,s.w5)((()=>[(0,s._)("div",ce,[(0,s.wy)((0,s.Wm)(d,{icon:"close",flat:"",dense:""},null,512),[[y]])]),(0,s._)("div",ue,[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",pe,[he,(0,s._)("a",{href:r.NIP05Link,target:"_"},(0,i.zw)(r.NIP05Link),9,ge)]),r.NIP05Loaded?((0,s.wg)(),(0,s.iD)("pre",me,(0,i.zw)(r.NIP05Formatted),1)):(0,s.kq)("",!0),(0,s.Wm)(u,{showing:!r.NIP05Loaded},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{color:"accent",size:"2rem"})])),_:1},8,["showing"]),ye])),_:1})])])),_:1})])),_:1},8,["modelValue"]),e.$store.getters.NIP05Id(n.pubkey)?((0,s.wg)(),(0,s.j4)(d,{key:0,icon:"verified",color:"accent",flat:"",dense:"",size:n.buttonSize,class:"no-padding",clickable:"",onClick:(0,o.iM)(r.openNIP05,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[fe])),_:1})])),_:1},8,["size","onClick"])):(0,s.kq)("",!0)],64)}var be=n(33688),ve=n.n(be),ke=n(6827);const xe={mixins:[j.Z],props:{pubkey:{type:String,required:!0},buttonSize:{type:String,default:"xs"}},data(){return{NIP05Dialog:!1,NIP05Data:{}}},computed:{NIP05Link(){let[e,t]=this.$store.getters.NIP05Id(this.pubkey).split("@");return t||(t=e,e="_"),`https://${t}/.well-known/nostr.json?name=${e}`},NIP05Formatted(){return this.json(this.NIP05Data)},NIP05Loaded(){return!!Object.keys(this.NIP05Data).length}},methods:{openNIP05(){this.loadNIP05Data(),this.NIP05Dialog=!this.NIP05Dialog},async loadNIP05Data(){try{this.NIP05Data=await(await ve()(this.NIP05Link)).json()}catch(e){ke.Z.create({message:"failed to fetch NIP05 identifier",color:"negative"})}}}};var Ce=n(87743),Me=n(44458),_e=n(63190),qe=n(60854),Te=n(10786),Be=n(62146);const $e=(0,N.Z)(xe,[["render",we]]),ze=$e;ne()(xe,"components",{QDialog:Ce.Z,QCard:Me.Z,QBtn:Q.Z,QCardSection:_e.Z,QInnerLoading:qe.Z,QSpinnerOrbit:Te.Z,QTooltip:X.Z}),ne()(xe,"directives",{ClosePopup:Be.Z});const Ze={mixins:[j.Z],components:{BaseButtonNIP05:ze},props:{pubkey:{type:String,required:!0},wrap:{type:Boolean,default:!1},alignRight:{type:Boolean,default:!1},headerMode:{type:Boolean,default:!1},showFollowing:{type:Boolean,default:!1}},computed:{niceShortNIP05(){let e=this.$store.getters.NIP05Id(this.pubkey).split("@").map(((e,t)=>0===t&&e===this.$store.getters.name(this.pubkey)?"":e)).join("@");return e.startsWith("_@")?e.replace("_@",""):e},niceNIP05(){return this.$store.getters.NIP05Id(this.pubkey).split("@").map(((e,t)=>0===t&&"_"===e?"":e)).join("@")},isFollow(){return this.$store.state.follows.includes(this.pubkey)}}},Se=(0,N.Z)(Ze,[["render",de]]),je=Se;ne()(Ze,"components",{QIcon:Y.Z,QTooltip:X.Z});const We=["src"];function Re(e,t,n,a,l,r){const d=(0,s.up)("BaseButtonNIP05"),c=(0,s.up)("q-avatar");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)((n.bordered?"bordered-avatar":"")+(n.hoverEffect?" hovered-avatar":""))},[(0,s.Wm)(c,{rounded:!n.round,class:"relative-position",size:n.size,onClick:t[0]||(t[0]=(0,o.iM)((t=>e.toProfile(n.pubkey)),["stop"]))},{default:(0,s.w5)((()=>[(0,s._)("img",{src:e.$store.getters.avatar(n.pubkey),loading:"lazy",async:""},null,8,We),(0,s._)("div",{class:(0,i.C_)([n.alignRight?"icon-right":"icon-left","q-pt-xs"])},[n.showVerified?((0,s.wg)(),(0,s.j4)(d,{key:0,pubkey:n.pubkey,"button-size":"xs"},null,8,["pubkey"])):(0,s.kq)("",!0)],2)])),_:1},8,["rounded","size"])],2)}const Le={mixins:[j.Z],components:{BaseButtonNIP05:ze},props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,default:!1},size:{type:String,default:""},round:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},showVerified:{type:Boolean,default:!1},hoverEffect:{type:Boolean,default:!1}}};var Pe=n(61357);const Ee=(0,N.Z)(Le,[["render",Re],["__scopeId","data-v-0eae57ca"]]),De=Ee;ne()(Le,"components",{QAvatar:Pe.Z});var Ue=n(53361);const Ie=e=>((0,s.dD)("data-v-627865bb"),e=e(),(0,s.Cn)(),e),Ne={key:1,clickable:!1,class:"embeded-message q-px-sm q-py-xs"},Oe={class:"relative-position"},Ae={key:0,class:"flex row items-center",style:{gap:"0.3rem"}},Fe={class:"input-area"},Qe={id:"input-placeholder"},He={id:"input-readonly-highlight",contenteditable:"true",spellcheck:"false"},Ve=["contenteditable"],Ke=Ie((()=>(0,s._)("div",{id:"input-readonly",contenteditable:"true",spellcheck:"false"},null,-1))),Je={key:0,class:"absolute-top full-width row justify-center q-my-md"},Ye={style:{"font-size":"0.9rem"}},Xe={key:0,class:"q-pl-xs"},Ge=Ie((()=>(0,s._)("div",{class:"text-secondary"},"links added",-1))),et={dense:"",style:{"font-size":"0.8rem","font-weight":"300"}},tt={class:"col-11",style:{"overflow-x":"auto"}},nt={class:"flex row justify-between"},st=Ie((()=>(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[(0,s._)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),(0,s._)("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})],-1))),it=(0,s.Uk)(" add emoji "),ot=(0,s.Uk)(" add link "),at=(0,s.Uk)(" how to mention users and posts "),lt=Ie((()=>(0,s._)("div",null,[(0,s._)("span",{class:"text-bold"},(0,i.zw)("to mention a user: ")),(0,s.Uk)(" "+(0,i.zw)("type ")+" "),(0,s._)("code",null,(0,i.zw)('"@"')),(0,s.Uk)(" "+(0,i.zw)(" and select user from menu that pops up or paste in npub key"))],-1))),rt=Ie((()=>(0,s._)("span",{class:"text-bold"},(0,i.zw)("to mention a post: "),-1))),dt=(0,s.Uk)("paste in note id (you can copy note id from embed "),ct=(0,s.Uk)(' button at the bottom of every post)"'),ut=(0,s.Uk)(" cancel "),pt={key:1,class:"char-left-label"},ht={key:0,class:"over-limit"},gt=(0,s.Uk)(" short form post "),mt=(0,s.Uk)(" long form post ");function yt(e,t,n,a,l,r){const d=(0,s.up)("BasePost"),c=(0,s.up)("q-btn"),u=(0,s.up)("BaseMessage"),p=(0,s.up)("q-list"),h=(0,s.up)("q-icon"),g=(0,s.up)("BaseUserAvatar"),m=(0,s.up)("q-spinner-orbit"),y=(0,s.up)("q-tooltip"),f=(0,s.up)("q-btn-toggle"),w=(0,s.up)("q-separator"),b=(0,s.up)("BaseEmojiPicker"),v=(0,s.up)("q-tab-panel"),k=(0,s.up)("BaseLinkForm"),x=(0,s.up)("q-tab-panels"),C=(0,s.up)("q-item"),M=(0,s.up)("q-circular-progress"),_=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.j4)(C,{unelevated:"",class:"q-pa-none post-entry-form flex coloumn",ref:"postEntry",onClick:t[20]||(t[20]=(0,o.iM)((()=>{}),["stop"])),onMouseup:t[21]||(t[21]=(0,o.iM)((()=>{}),["stop"])),onKeypress:t[22]||(t[22]=(0,o.D2)((0,o.iM)((()=>{}),["stop"]),["enter"])),onKeydown:t[23]||(t[23]=(0,o.iM)((()=>{}),["stop"])),onKeyup:t[24]||(t[24]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>["quote"===n.replyMode||"repost"===n.replyMode?((0,s.wg)(),(0,s.iD)("div",{key:0,class:(0,i.C_)(["reposts flex column q-px-sm q-py-xs","quote"===n.replyMode?"q-mb-sm":""]),clickable:!1},[(0,s.Wm)(d,{event:n.event,clickable:!1,"is-embeded":!0,"reply-depth":-1},null,8,["event"])],2)):(0,s.kq)("",!0),"reply"===n.messageMode&&n.event?((0,s.wg)(),(0,s.iD)("div",Ne,[(0,s._)("div",Oe,[(0,s.Wm)(c,{icon:"close",flat:"",dense:"",onClick:t[0]||(t[0]=(0,o.iM)((t=>e.$emit("clear-event")),["stop"])),size:"xs",class:"absolute-top-right z-top"})]),n.event?((0,s.wg)(),(0,s.j4)(u,{key:0,event:n.event,clickable:!1,"is-embeded":!0},null,8,["event"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s.wy)((0,s._)("div",{class:"relative-position full-width",style:{gap:"5px"},onClick:t[9]||(t[9]=(0,o.iM)((()=>{}),["stop"]))},[(0,s.Wm)(p,{id:"tribute-wrapper",class:"overflow-auto flex row z-top",style:{"max-height":"40vh"},onClick:(0,o.iM)(l.focusInput,["stop"])},null,8,["onClick"]),!n.messageMode&&l.replyUserTags.length&&"embed"!==this.replyMode?((0,s.wg)(),(0,s.iD)("div",Ae,[(0,s.Wm)(h,{name:"alternate_email",color:"secondary",size:"sm"}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.replyUserTags,(t=>((0,s.wg)(),(0,s.j4)(c,{key:t,color:"secondary",outline:"",rounded:"",label:e.$store.getters.displayName(t),icon:"close",dense:"",size:"sm",class:"q-pr-sm","no-caps":"",onClick:(0,o.iM)((e=>r.removeReplyUserTag(t)),["stop"])},null,8,["label","onClick"])))),128))])):(0,s.kq)("",!0),(0,s._)("div",Fe,[(0,s.Wm)(g,{pubkey:e.$store.state.keys.pub,class:"avatar-image"},null,8,["pubkey"]),(0,s._)("span",Qe,(0,i.zw)(r.placeholderText),1),(0,s.wy)((0,s._)("div",He,null,512),[[o.F8,!l.longForm]]),(0,s._)("div",{id:"input-editable",contenteditable:!l.sending&&!l.mentionsUpdating,style:(0,i.j5)(l.mentionsUpdating?"opacity: .7;":""),onInput:t[1]||(t[1]=(...e)=>r.updateText&&r.updateText(...e)),onKeypress:[t[2]||(t[2]=(0,o.D2)(((...e)=>r.updateText&&r.updateText(...e)),["delete"])),t[5]||(t[5]=(0,o.D2)((0,o.iM)(((...e)=>r.send&&r.send(...e)),["ctrl"]),["enter"]))],onFocus:t[3]||(t[3]=(...e)=>r.textareaFocus&&r.textareaFocus(...e)),onBlur:t[4]||(t[4]=(...e)=>r.textareaBlur&&r.textareaBlur(...e)),onClick:t[6]||(t[6]=(0,o.iM)(((...e)=>r.updateText&&r.updateText(...e)),["stop"])),onTouchstart:t[7]||(t[7]=(0,o.iM)((()=>{}),["stop"])),onMousedown:t[8]||(t[8]=(0,o.iM)((()=>{}),["stop"]))},null,44,Ve),Ke,l.mentionsUpdating?((0,s.wg)(),(0,s.iD)("div",Je,[(0,s.Wm)(m,{color:"accent",size:"md"})])):(0,s.kq)("",!0)])],512),[[o.F8,"repost"!==n.replyMode]]),(0,s._)("div",Ye,[l.links.length?((0,s.wg)(),(0,s.iD)("div",Xe,[Ge,(0,s._)("ul",et,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.links,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t,class:"flex row justify-between no-wrap",dense:""},[(0,s._)("div",tt,[(0,s._)("strong",null,(0,i.zw)(r.linkName(e)),1),(0,s._)("span",null,(0,i.zw)(e.url),1)]),(0,s.Wm)(c,{icon:"remove_circle",clickable:"",onClick:(0,o.iM)((e=>r.removeLink(t)),["stop"]),flat:"",color:"negative",size:"xs",class:"no-padding"},null,8,["onClick"])])))),128))])])):(0,s.kq)("",!0)]),(0,s._)("div",{class:(0,i.C_)(["flex justify-between",l.toolSelected?"column":"row"]),onClick:t[19]||(t[19]=(0,o.iM)((()=>{}),["stop"]))},[(0,s._)("div",nt,[(0,s.wy)((0,s.Wm)(f,{modelValue:l.toolSelected,"onUpdate:modelValue":t[13]||(t[13]=e=>l.toolSelected=e),class:(0,i.C_)(["flex",l.toolSelected?"column":"row"]),dense:"",unelevated:"","toggle-color":"","toggle-text-color":"accent",options:[{value:"emoji",slot:"emoji"},{value:"link",slot:"link"},{value:"help",slot:"help"}]},{emoji:(0,s.w5)((()=>[(0,s.Wm)(c,{unelevated:"",class:"no-padding button-emoji",dense:"",size:"sm",onClick:t[10]||(t[10]=(0,o.iM)((e=>r.toggleTool("emoji")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[st])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[it])),_:1})])),_:1})])),link:(0,s.w5)((()=>[(0,s.Wm)(c,{unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[11]||(t[11]=(0,o.iM)((e=>r.toggleTool("link")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"add_link",size:"sm"}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[ot])),_:1})])),_:1})])),help:(0,s.w5)((()=>[(0,s.Wm)(c,{unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[12]||(t[12]=(0,o.iM)((e=>r.toggleTool("help")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"help",size:"xs"}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[at])),_:1})])),_:1})])),_:1},8,["modelValue","class"]),[[o.F8,"repost"!==n.replyMode]]),l.toolSelected?((0,s.wg)(),(0,s.j4)(C,{key:0,class:"col toolbox no-padding",ref:"toolbox"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{vertical:"",color:"accent",size:"1px"}),(0,s.Wm)(x,{modelValue:l.toolSelected,"onUpdate:modelValue":t[17]||(t[17]=e=>l.toolSelected=e),class:"no-padding full-width"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{name:"emoji",class:"no-padding",onClick:t[14]||(t[14]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{onEmojiSelected:r.insertEmoji,"per-line":r.emojiPerRow,class:"full-width"},null,8,["onEmojiSelected","per-line"])])),_:1}),(0,s.Wm)(v,{name:"link",class:"q-pa-xs",onClick:t[15]||(t[15]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{links:l.links,onLinkAdded:r.addLink},null,8,["links","onLinkAdded"])])),_:1}),(0,s.Wm)(v,{name:"help",class:"q-pa-xs",onClick:t[16]||(t[16]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[lt,(0,s._)("div",null,[rt,(0,s._)("span",null,[dt,(0,s.Wm)(h,{name:"link",size:"sm"}),ct])])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,s.kq)("",!0)]),(0,s.Wm)(_,{class:"flex items-center",unelevated:""},{default:(0,s.w5)((()=>[l.toolSelected?((0,s.wg)(),(0,s.j4)(c,{key:0,icon:"close",unelevated:"",class:"col button-close",dense:"",onClick:(0,o.iM)(r.closeTools,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[ut])),_:1})])),_:1},8,["onClick"])):(0,s.kq)("",!0),l.text&&!n.messageMode?((0,s.wg)(),(0,s.iD)("div",pt,[r.charLeft()<=0&&!l.longForm?((0,s.wg)(),(0,s.iD)("span",ht,(0,i.zw)(r.charLeft()),1)):(0,s.kq)("",!0),r.charLeft()>0?((0,s.wg)(),(0,s.j4)(M,{key:1,"show-value":r.charLeft()<=25,value:l.text.length%l.charLimit/l.charLimit*100,size:r.charLeft()<=25?"1.5rem":"1.2rem","font-size":".6rem",thickness:r.charLeft()<=25?.2:.1,color:r.charLeft()<=25?"warning":"secondary","track-color":"transparent",class:"no-padding","instant-feedback":""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(r.charLeft()),1)])),_:1},8,["show-value","value","size","thickness","color"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),!n.messageMode&&r.charLeft()<=0?((0,s.wg)(),(0,s.j4)(f,{key:2,modelValue:l.longForm,"onUpdate:modelValue":t[18]||(t[18]=e=>l.longForm=e),unelevated:"",dense:"","toggle-color":"primary",style:{border:"1px solid var(--q-primary)"},"text-color":"primary",class:"q-ml-md",options:[{value:!1,slot:"short"},{value:!0,slot:"long"}]},{short:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"short_text",size:"xs",style:(0,i.j5)(l.longForm?"":"color: var(--q-background")},null,8,["style"]),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[gt])),_:1})])),long:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"format_align_left",size:"xs",style:(0,i.j5)(l.longForm?"color: var(--q-background":"")},null,8,["style"]),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[mt])),_:1})])),_:1},8,["modelValue"])):(0,s.kq)("",!0),(0,s.Wm)(c,{flat:"",unelevated:"",color:"primary",type:"submit",onClick:(0,o.iM)(r.send,["stop"]),disable:!r.textValid()},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"send",style:(0,i.j5)("transform: translateX("+l.sendIconTranslation+"px);")},null,8,["style"])])),_:1},8,["onClick","disable"])])),_:1})],2)])),_:1},512)}var ft=n(75103),wt=n(26041);function bt(e,t,n,i,a,l){const r=(0,s.up)("Picker");return(0,s.wg)(),(0,s.j4)(r,{data:a.emojiIndex,set:"google","emoji-size":22,"per-line":n.perLine,"show-preview":!1,"show-skin-tomes":!1,onSelect:l.emojiSelected,onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},null,8,["data","per-line","onSelect"])}var vt=n(32859),kt=n(50502);let xt=new kt.xd(vt);const Ct={name:"BaseEmojiPicker",emits:["emoji-selected"],props:{perLine:{type:Number,required:!0}},components:{Picker:kt.cW},data(){return{emojiIndex:xt}},methods:{emojiSelected(e){this.$emit("emoji-selected",e)}}},Mt=(0,N.Z)(Ct,[["render",bt]]),_t=Mt;function qt(e,t,n,o,a,l){const r=(0,s.up)("q-input"),d=(0,s.up)("q-btn"),c=(0,s.up)("q-form");return(0,s.wg)(),(0,s.j4)(c,{onSubmit:t[2]||(t[2]=e=>l.addLink({url:a.url,name:a.name})),class:"no-padding flex row items-center no-wrap justify-between"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{modelValue:a.url,"onUpdate:modelValue":t[0]||(t[0]=e=>a.url=e),type:"url",label:"url",dense:"",outlined:"",autofocus:"",color:"accent",class:"no-padding col-9"},null,8,["modelValue"]),(0,s.Wm)(r,{modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=e=>a.name=e),label:"url name",disable:0===a.url.length,outlined:"",dense:"",color:"accent",class:"no-padding col-2"},null,8,["modelValue","disable"]),(0,s.Wm)(d,{icon:"add",type:"submit",disable:!a.validUrl,outline:"",round:"",color:"accent",size:"sm",class:(0,i.C_)(["no-padding",a.validUrl?"pulse-button":""])},null,8,["disable","class"])])),_:1})}const Tt={name:"BaseLinkForm",emits:["link-added","link-removed"],props:{links:{type:Array,required:!0}},data(){return{url:"",name:"",validUrl:!1}},watch:{async url(e,t){if(e)try{this.validUrl=Boolean(new URL(e))}catch(n){this.validUrl=!1}else this.validUrl=!1}},methods:{linkName(e){return e.name?`${e.name}: `:""},addLink(e){0===e.name.length&&delete e.name,this.$emit("link-added",e),this.url="",this.name=""},removeLink(e){this.$emit("link-removed",e)}}};var Bt=n(8326),$t=n(66611);const zt=(0,N.Z)(Tt,[["render",qt],["__scopeId","data-v-3b53e1cf"]]),Zt=zt;ne()(Tt,"components",{QForm:Bt.Z,QInput:$t.Z,QBtn:Q.Z});var St=n(73396),jt=n(34136);const{getPaletteColor:Wt}=ft.ZP,Rt={name:"BasePostEntry",mixins:[j.Z],emits:["sent","resized","clear-event"],components:{BaseEmojiPicker:_t,BaseLinkForm:Zt,BaseMessage:St.Z},props:{messageMode:{type:String,required:!1,default:""},replyMode:{type:String,required:!1,default:""},event:{type:Object,required:!1,default:null},autoFocus:{type:Boolean,default:!0}},data(){return{text:"",charLimit:280,sending:!1,toolSelected:"",sendIconTranslation:0,tags:[],mentionsUpdating:!1,focusInput(){setTimeout((async()=>{await this.$nextTick(),this.textarea.focus()}),1)},trigger:1,links:[],textareaRange:null,longForm:!1,replyUserTags:[]}},watch:{text(e,t){this.updateMentionsTags()},replyMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())},messageMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())}},computed:{postEntry(){return this.$refs.postEntry.$el},textarea(){return this.postEntry.querySelector("#input-editable")},readonlyTextarea(){return this.postEntry.querySelector("#input-readonly")},readonlyHighlightTextarea(){return this.postEntry.querySelector("#input-readonly-highlight")},placeholder(){return this.postEntry.querySelector("#input-placeholder")},profileMentionsProvider(){return this.createMentionsProvider()},postEntryWidth(){return this.$refs.postEntry?.$el?.clientWidth},toolboxWidth(){return this.toolSelected?this.$refs.toolbox?.$el?.clientWidth:0},emojiPerRow(){return this.toolboxWidth?Math.floor((this.toolboxWidth-10)/25):0},label(){if("reply"===this.messageMode)return"what's your reply?";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought?"}return"what's happening?"},placeholderText(){if(this.text.length)return"";if("reply"===this.messageMode)return"reply to message";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought on this?"}return"what's happening?"},textareaMentions(){return this.mentions()},hashtags(){if(0===this.text.length)return[];const e=/(?<s>^|[\s])#(?<i>[\w]{1,63})/g;let t=this.innertext.matchAll(e),n=[];for(let s of t)n.push(s.groups.i.toLowerCase());return n},caretRange(){const e="undefined"!==typeof window.getSelection;if(e&&this.trigger){const e=window.getSelection();if(0!==e.rangeCount){const t=e.getRangeAt(0);return t}}return null},hexPubkey(){return this.$route.params.pubkey?this.bech32ToHex(this.$route.params.pubkey):""}},mounted(){this.messageMode||this.profileMentionsProvider.attach(this.textarea),this.replyMode&&(this.replyUserTags=this.getReplyUserTags()),this.autoFocus&&this.focusInput(),this.$emit("resized")},activated(){},beforeUnmount(){this.messageMode||this.profileMentionsProvider.detach(this.textarea),this.reset(),this.$emit("resized")},methods:{updateText(e){this.trigger++,this.text=this.textarea.textContent,this.innertext=this.textarea.innerText,this.textareaRange=this.caretRange||this.textareaRange,this.updateReadonlyInput(),this.messageMode||this.updateReadonlyHightlightInput()},async send(){if(!this.textValid())return void console.log("text not valid");if(this.sending)return void console.log("send already in progress");let e;this.toolSelected="",this.sending=!0,this.animateSendIcon(),this.updateText(),await this.extractMentions(this.textarea,this.tags),e=this.replyMode?await this.sendReply():this.messageMode?await this.sendMessage():await this.sendPost(),e&&(this.messageMode||this.interpolateEventMentions(e),this.reset(),this.$emit("sent",e),this.replyMode||this.messageMode||this.toEvent(e.id)),this.sending=!1},async sendPost(){let e=Object.values(this.mentions()).map((e=>e.tag)),t=await this.formatMentionsForPublishing(e);this.appendHashtags(e),t=this.appendLinks(t);let n=await this.$store.dispatch("sendPost",{message:t,tags:e});if(n)return n},async sendReply(){"repost"===this.replyMode&&this.text&&(this.textarea.innerHTML="");let e=[],t=this.textarea.cloneNode(!0);this.replyUserTags.forEach((async t=>e.push(await(0,wt.l_)(t))));let n=this.event.tags.filter((([e,t])=>"e"===e&&t)).map((([...e])=>[...e]));if("quote"===this.replyMode||"repost"===this.replyMode){let n=await(0,wt.wn)(this.event.id,"mention");e.push(n),t.append(` #[${e.length-1}]`)}else{let t=n.find((([e,t,n,s])=>"e"===e&&"root"===s))||n.find((e=>"e"===e[0]&&!e[3]));t||1!==n.filter((([e,t,n,s])=>"e"===e&&"reply"===s)).length||(t=n.find((([e,t,n,s])=>"e"===e&&"reply"===s))),t?(e.push(await(0,wt.wn)(t[1],"root")),e.push(await(0,wt.wn)(this.event.id,"reply"))):e.push(await(0,wt.wn)(this.event.id,"root"))}let s=await this.formatMentionsForPublishing(e,!0,t);this.appendHashtags(e),s=this.appendLinks(s);let i=Object.keys(this.$store.state.relays).length?Object.keys(this.$store.state.relays):Object.keys(this.$store.state.defaultRelays);return(0,jt.nY)((0,S.CX)(this.event),i),await this.$store.dispatch("sendPost",{message:s,tags:e})},async sendMessage(){let e=Math.round(Date.now()/1e3),t=[];t.find((([e,t])=>t===this.hexPubkey))||t.push(["p",this.hexPubkey]),this.event&&!t.find((([e,t])=>t===this.event.id))&&t.push(await(0,wt.wn)(this.event.id,"mention"));let n=await this.formatMentionsForPublishing(t,!1);return n=this.appendLinks(n),await this.$store.dispatch("sendChatMessage",{now:e,pubkey:this.hexPubkey,text:n,tags:t})},async extractMentions(e,t){const n=/(?<t>note|npub)(?<v>[a-z0-9]{59})\b/g,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let i={},o=s.nextNode();while(o){let e=o.textContent;for(let s of e.matchAll(n)){let e=null;if("note"===s.groups.t)e="e";else{if("npub"!==s.groups.t)return;e="p"}let n=s[0],o=this.bech32ToHex(n),a=Object.entries(t),l=a.map((([e,t])=>t)).findIndex((([t,s])=>t===e&&s===n));if(-1!==l)i[n]=a[l][0];else if("e"===e){let e=`${this.shorten(n)}`;t[e]=await(0,wt.wn)(o,"mention"),i[n]=e}else{console.log("extract mentions",`"${n}"`,s);let e=`@${this.$store.getters.displayName(o)}`;t[e]=await(0,wt.l_)(o),i[n]=e}}e=e.replace(n,((e,t,n)=>i[e])),o.textContent=e,o=s.nextNode()}},mentions(e=this.textarea){if(0===this.text.length)return{};let t={};const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let s=n.nextNode(),i=0;while(s){for(let[e,n]of Object.entries(this.tags)){const o=new RegExp(`(?<i>${e})\\b`,"g");let a=s.textContent.matchAll(o);for(let e of a)this.tags[e.groups.i]&&(t[i+"."+e.index+"_"+e.groups.i]={el:s,pos:e.index,tag:Array.from(n),length:e.groups.i.length})}s=n.nextNode(),i++}return t},async formatMentionsForPublishing(e,t=!0,n=this.textarea.cloneNode(!0)){let s=this.mentions(n),i={el:null,offset:null};for(let a in s){let n=s[a],o=e.findIndex((([e,t])=>e===n.tag[0]&&t===n.tag[1]));if(-1===o){let s;"p"===n.tag[0]&&t?s=await(0,wt.l_)(n.tag[1]):"e"===n.tag[0]&&(s=await(0,wt.wn)(n.tag[1],"mention")),s&&(e.push(s),o=e.length-1)}i.el&&i.el!==n.el&&(i.offset=0);let l=i.el&&i.el===n.el?i.offset:0,r=new Range;r.setStart(n.el,n.pos+l),r.setEnd(n.el,n.pos+n.length+l);let d="p"!==n.tag[0]||t?`#[${o}]`:`@${n.tag[1]}`;this.insertText(d,r),i={el:n.el,offset:d.length-n.length+i.offset||0}}n.style.maxHeight="0",this.postEntry.appendChild(n);let o=n.innerText;return n.remove(),o},async updateMentionsTags(){this.trigger++;let{start:e}=this.startEndOfRange();const t=/(?<t>note|npub)(?<v>[a-z0-9]{59})/g;this.text.toLowerCase().match(t)&&(this.mentionsUpdating=!0,await this.extractMentions(this.textarea,this.tags),"#text"===e.el.nodeName&&e.pos>e.el.length?this.setCaret(e.el,e.el.length):this.setCaret(e.el,e.pos),this.updateText(),console.log("updateMentionTags",this.tags),Object.keys(this.tags).filter((e=>"p"===this.tags[e][0])).forEach((e=>{this.replyUserTags.includes(this.tags[e][1])||this.replyUserTags.push(this.tags[e][1])})),this.mentionsUpdating=!1)},startEndOfRange(e=this.caretRange){return{start:{el:e.startContainer,pos:e.startOffset},end:{el:e.endContainer,pos:e.endOffset}}},insertText(e,t=this.textareaRange){let{start:n,end:s}=this.startEndOfRange(t),i=n.el.textContent.slice(0,n.pos)+e+s.el.textContent.slice(s.pos);if(t.isCollapsed||(t.deleteContents(),s.el!==n.el&&s.el.remove()),"#text"===n.el.nodeName)n.el.textContent=i,this.setCaret(n.el,n.pos+e.length);else{let t=document.createTextNode(i);n.el.insertBefore(t,n.el.firstChild),this.setCaret(t,e.length)}this.updateText()},insertEmoji(e){e.native&&(this.trigger++,this.insertText(e.native))},animateSendIcon(){let e=setInterval((()=>{if(!this.sending)return clearInterval(e),void(this.sendIconTranslation=0);this.sendIconTranslation+=3,this.sendIconTranslation>50&&(this.sendIconTranslation-=this.postEntryWidth+40)}),50)},closeTools(){this.toolSelected=""},toggleTool(e){this.updateText(),this.toolSelected===e?this.closeTools():this.toolSelected=e},reset(){this.closeTools(),this.text="",this.textarea.innerHTML="",this.readonlyTextarea.innerHTML="",this.readonlyHighlightTextarea.innerHTML="",this.tags=[],this.links=[],this.focusInput()},appendHashtags(e){for(let t of this.hashtags)e.find((([e,n])=>n===t))||e.push(["t",t.toLowerCase()])},appendLinks(e){for(let t of this.links)t.name?e+=`\n[${t.name}](${t.url})`:e+=`\n${t.url}`;return e},setCaret(e,t){const n="undefined"!==typeof window.getSelection;if(n&&e){const n=window.getSelection(),s=document.createRange();n.removeAllRanges(),s.selectNodeContents(e),s.collapse(!0),s.setStart(e,t),n.addRange(s),this.focusInput()}},addLink(e){this.links.push(e)},linkName(e){return e.name?`${e.name}: `:""},removeLink(e){this.links.splice(e,1)},textareaFocus(e){const t=this.placeholder;t.style.opacity=".3"},textareaBlur(e){const t=this.placeholder;t.style.opacity=".6"},colorText(e){let t=document.createElement("span");return t.innerHTML=e,t.style.color=Wt("secondary"),t},updateReadonlyInput(){let e=this.textarea.innerHTML,t=Object.assign({},this.mentions());for(let n in t){let[t,s]=n.split("_");const i=new RegExp(`(?<i>${s})\\b`,"g");e=e.replaceAll(i,((e,t)=>this.colorText(s).outerHTML))}this.readonlyTextarea.innerHTML=e},updateReadonlyHightlightInput(){if(this.overCharLimit()){this.readonlyHighlightTextarea.innerHTML=this.textarea.innerHTML;let{el:e,pos:t}=this.charPos(this.charLimit,this.readonlyHighlightTextarea),n=e.length&&e.length>t,s=new Range;s.setStart(e,t),s.setEndAfter(this.readonlyHighlightTextarea.lastChild);let i=s.extractContents(),o=[].map.call(i.childNodes,((e,t)=>{if(0===t&&n)return"#text"===e.nodeName?e.textContent:e.innerHTML;let s=document.createElement("span");return s.style.background=Wt("negative"),s.style.opacity=".6",s.innerHTML=e.innerHTML,e.innerHTML=s.outerHTML,e.outerHTML})).join(""),a=document.createElement("span");a.innerHTML=o,a.style.background=Wt("negative"),a.style.opacity=".6";let l=new Range;l.setStart(e,t),l.collapse(!0),l.insertNode(a)}else this.readonlyHighlightTextarea.innerHTML=""},charPos(e,t=this.textarea){for(var n of t.childNodes)if(3===n.nodeType){if(n.length>=e)return{el:n,pos:e,char:-1};e-=n.length}else{let t=this.charPos(e,n);if(-1===t.char)return t;e=t.char}return{char:e}},extractUrls(e){const t=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;return e=e.replace(t,(e=>(this.addLink({url:e}),""))),e},charLeft(){return this.charLimit-this.text.length},overCharLimit(){return this.charLeft()<0},textValid(){return"repost"===this.replyMode||(!!this.links.length||!!this.text.length&&(!!this.messageMode||(!!this.longForm||!this.overCharLimit())))},getReplyUserTags(){if(!this.event)return[];let e=Object.assign({},this.event);e.tags||(e.tags=[]);let t=e.tags.filter((([e,t])=>"p"===e&&this.isKey(t))).map((([...e])=>[...e])),n=t.filter((([e,t])=>"p"===e)).map((([e,t])=>t)).slice(0,9);return n.find((t=>t===e.pubkey))||n.push(e.pubkey),n=n.filter((e=>e!==this.$store.state.keys.pub)),n},removeReplyUserTag(e){let t=this.mentions();Object.keys(t).forEach((n=>{let s=t[n];if(s.tag[1]===e){let e=new Range;e.setStart(s.el,s.pos),e.setEnd(s.el,s.pos+s.length),this.insertText("",e),this.updateText()}}));let n=Object.keys(this.tags).find((t=>e===this.tags[t][1]));delete this.tags[n],this.replyUserTags=this.replyUserTags.filter((t=>e!==t))}}};var Lt=n(490),Pt=n(13246),Et=n(1389),Dt=n(50926),Ut=n(67236),It=n(11221),Nt=n(83302);const Ot=(0,N.Z)(Rt,[["render",yt],["__scopeId","data-v-627865bb"]]),At=Ot;ne()(Rt,"components",{QItem:Lt.Z,QBtn:Q.Z,QList:Pt.Z,QIcon:Y.Z,QSpinnerOrbit:Te.Z,QBtnToggle:Et.Z,QTooltip:X.Z,QSeparator:Dt.Z,QTabPanels:G.Z,QTabPanel:ee.Z,QBtnGroup:Ut.Z,QCheckbox:It.Z,QCircularProgress:Nt.Z});const Ft={key:0},Qt={key:1,class:"bottom-border"};function Ht(e,t,n,i,a,l){const r=(0,s.up)("BasePostThread",!0),d=(0,s.up)("BaseButtonShowMore"),c=(0,s.up)("BasePost"),u=(0,s.up)("q-list");return(0,s.wg)(),(0,s.j4)(u,{ref:"thread",class:"no-padding"},{default:(0,s.w5)((()=>[n.fetchRootReply&&(e.$store.state.eventsCache[l.reply]||e.$store.state.eventsCache[l.root])&&l.rootReplyThread.length?((0,s.wg)(),(0,s.iD)("div",Ft,[(0,s.Wm)(r,{events:l.rootReplyThread,"is-ancestors":""},null,8,["events"])])):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.filledEvents,((t,i)=>((0,s.wg)(),(0,s.iD)("div",{key:t.id+i,class:"no-padding"},["FILLER"===t.id?((0,s.wg)(),(0,s.j4)(d,{key:0,root:t.root},null,8,["root"])):((0,s.wg)(),(0,s.j4)(c,{key:1,event:t,position:l.position(i),"reply-depth":n.replyDepth,"reply-count":t.replies?.length?t.replies.length:i===l.filledEvents.length-1?n.isAncestors?1:0:1,onResized:l.resize,onAddEvent:l.addEvent,onClick:(0,o.iM)((n=>e.toEvent(t.id)),["stop"])},null,8,["event","position","reply-depth","reply-count","onResized","onAddEvent","onClick"]))])))),128)),n.replyDepth&&0!==n.replyDepth||n.isAncestors?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Qt))])),_:1},512)}var Vt=n(45938);const Kt={name:"BasePostThread",emits:["resized","add-event"],mixins:[j.Z],props:{events:{type:Array,required:!0},isAncestors:{type:Boolean,default:!1},replyDepth:{type:Number,default:0},fetchRootReply:{type:Boolean,default:!1}},components:{BaseButtonShowMore:Vt.Z},data(){return{resizing:!1}},computed:{root(){return this.events[0]?.interpolated?.replyEvents?.length?this.events[0].interpolated.replyEvents[0]:null},reply(){return this.root&&this.events[0]?.interpolated?.replyEvents?.length>1?this.events[0].interpolated.replyEvents[1]:null},rootReplyThread(){let e=[];return this.reply&&this.$store.state.eventsCache[this.reply]&&(this.root&&this.$store.state.eventsCache[this.root]&&e.push(this.$store.state.eventsCache[this.root]),e.push(this.$store.state.eventsCache[this.reply])),e},filledEvents(){if(!this.resizing||this.resizing){if(0===this.events.length)return[];var e=[this.events[0]];if(1===this.events.length)return e;for(let t=1;t<this.events.length;t++){let n=this.events[t],s=this.events[t-1],i=n.interpolated.replyEvents||[];i.length&&i[i.length-1]!==s.id&&e.push({id:"FILLER",root:s.id}),e.push(n)}return e}}},mounted(){this.fetchRootReply&&(this.root&&this.$store.dispatch("useEvent",{id:this.root}),this.reply&&this.$store.dispatch("useEvent",{id:this.reply}))},methods:{position(e){return this.isAncestors?1===this.filledEvents.length||0===e?"first":(this.filledEvents.length,"middle"):1===this.filledEvents.length?this.rootReplyThread?.length?"last":"single":0===e?this.rootReplyThread?.length?"middle":"first":e===this.filledEvents.length-1?"last":"middle"},addEvent(e){console.log("basepostthread add-event",e),this.$emit("add-event",e)},resize(e){this.resizing=!this.resizing,this.$emit("resized")},threadWidth(){return this.$refs.thread?.$el?.clientWidth}}},Jt=(0,N.Z)(Kt,[["render",Ht]]),Yt=Jt;ne()(Kt,"components",{QList:Pt.Z});const Xt={class:"text-h5 text-bold q-pt-md q-pb-sm q-px-sm"};function Gt(e,t,n,i,o,a){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",Xt,[(0,s.WI)(e.$slots,"default")])])}const en=(0,s.aZ)({name:"BaseHeader",props:{separator:{type:Boolean,default:!0}}}),tn=(0,N.Z)(en,[["render",Gt]]),nn=tn;ne()(en,"components",{QSeparator:Dt.Z});const sn=({app:e})=>{e.component("BasePost",ie),e.component("BaseUserName",je),e.component("BaseUserAvatar",De),e.component("BaseUserCard",Ue.Z),e.component("BasePostEntry",At),e.component("BasePostThread",Yt),e.component("BaseHeader",nn)}},55635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var s=n(37912);const i={Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday",Sun:"Sun",Mon:"Mon",Tue:"Tue",Wed:"Wed",Thu:"Thu",Fri:"Fri",Sat:"Sat",second:"sec",day:"day",January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December",Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",UTC:"UTC",now:"now",s:"s",m:"m",h:"h",post:"Post",follow:"Follow",close:"Close",setUser:"Set User",read:"Read",write:"Write",reorderFollows:"Re-order Follows",cancel:"Cancel",save:"Save",searchProfiles:"Search Profiles",searchPosts:"Search Posts",feed:"Feed",notifications:"Notifications",messages:"Messages",inbox:"Inbox",settings:"Settings",thread:"Thread",event:"Event",devTools:"DevTools",notFound:"Oops. Nothing here...",follows:"Follows",followers:"Followers",replies:"Replies",profile:"Profile",relays:"Relays",faq:"FAQ",users:"Users",nip05Maintainer:"NIP-05 Maintainer",inactiveRelays:"Inactive Relays",preferences:"Preferences",colors:"Colors",font:"Font",lightningTips:"Lightning Tips",noFollows:"No Follows",noFollowers:"No Followers",noRelays:"No Relays",dragDropReorder:"Drag & Drop to re-order"},o={en:i},a=({app:e})=>{const t=(0,s.o)({locale:"en",fallbackLocale:"en",globalInjection:!0,messages:o});e.use(t)}},34136:(e,t,n)=>{"use strict";n.d(t,{$1:()=>T,$d:()=>_,AF:()=>x,Fp:()=>f,GG:()=>d,Kk:()=>p,LB:()=>M,Lh:()=>h,TE:()=>S,Uk:()=>z,Xp:()=>g,Y8:()=>l,cp:()=>c,dq:()=>C,hG:()=>b,hl:()=>w,mX:()=>j,mw:()=>$,nY:()=>r,pe:()=>y,sf:()=>B,so:()=>k,t_:()=>Z,u$:()=>m,uA:()=>q,vw:()=>u,w8:()=>v});const s=new Worker(new URL(n.p+n.u(399),n.b)),i={};function o(e,t){let n=e+" "+Math.random().toString().slice(-4);return s.postMessage(JSON.parse(JSON.stringify({id:n,name:e,args:t,call:!0}))),new Promise(((e,t)=>{i[n]={resolve:e,reject:t}}))}function a(e,t,n,o){let a=e+" "+Math.random().toString().slice(-4);return i[a]={cb:n,eoseCb:o},s.postMessage(JSON.stringify({id:a,name:e,args:t,stream:!0})),{update(...t){s.postMessage(JSON.stringify({id:a,name:e,args:t,stream:!0}))},cancel(){s.postMessage(JSON.stringify({id:a,cancel:!0})),delete i[a]}}}async function l(){return o("getRelayStatus",[])}async function r(e,t){return o("publish",[e,t])}async function d(e={}){return o("getFeed",[e])}async function c(e={}){return o("getProfiles",[e])}async function u(e={}){return o("getEvents",[e])}async function p(e={}){return o("getNotes",[e])}async function h(e={},t=(()=>{}),n=(()=>{})){return a("streamMainProfilesFollows",[e],t,n)}async function g(e={},t=(()=>{}),n=(()=>{})){return a("streamMainMentions",[e],t,n)}async function m(e={},t=(()=>{}),n=(()=>{})){return a("streamMainIncomingMessages",[e],t,n)}async function y(e={},t=(()=>{}),n=(()=>{})){return a("streamMainOutgoingMessages",[e],t,n)}async function f(e={},t=(()=>{}),n=(()=>{})){return a("streamPeerIncomingMessages",[e],t,n)}async function w(e={},t=(()=>{}),n=(()=>{})){return a("streamPeerOutgoingMessages",[e],t,n)}async function b(e={},t=(()=>{}),n=(()=>{})){return a("streamProfile",[e],t,n)}async function v(e={},t=(()=>{}),n=(()=>{})){return a("dbStreamEvent",[e],t,n)}async function k(e={},t=(()=>{}),n=(()=>{})){return a("dbStreamFollows",[e],t,n)}async function x(e={},t=(()=>{}),n=(()=>{})){return a("dbStreamFollowers",[e],t,n)}async function C(e={},t=(()=>{}),n=(()=>{})){return a("dbStreamTagKind",[e],t,n)}async function M(e){return o("dbSave",[e])}async function _(e){return o("dbQuery",[e])}async function q(e){return o("dbEvent",[e])}async function T(e){return o("dbProfile",[e])}async function B(e){return o("dbFollows",[e])}async function $(e){return o("dbChats",[e])}async function z(e,t,n=50,s=Math.round(Date.now()/1e3)){return o("dbMessages",[e,t,n,s])}async function Z(e,t=40,n=Math.round(Date.now()/1e3)){return o("dbMentions",[e,t,n])}async function S(e,t,n=0){return o("dbUnreadMessagesCount",[e,t,n])}async function j(e,t=0){return o("dbUnreadMentionsCount",[e,t])}s.onmessage=e=>{let{id:t,success:n,error:s,data:o,stream:a,type:l,notice:r,eose:d}="string"===typeof e.data?JSON.parse(e.data):e.data;if(!l&&!r)if(d)i[t]&&i[t].eoseCb&&i[t].eoseCb();else if(a)n?i[t]&&i[t].cb&&i[t].cb(o):console.log("ERROR",t,"~>>",o,i[t],s);else{if(!n)return i[t].reject(new Error(s)),void delete i[t];i[t]?.resolve?.(o),delete i[t]}}},54927:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Se});var s={};n.r(s),n.d(s,{NIP05Id:()=>k,avatar:()=>x,canEncryptDecrypt:()=>z,canSignEventsAutomatically:()=>$,contacts:()=>_,displayName:()=>v,hasMoreContacts:()=>q,hasName:()=>w,name:()=>b,namedProfiles:()=>f,profileDescription:()=>C,profileLud06:()=>M,unreadChats:()=>T,unreadNotifications:()=>B});var i={};n.r(i),n.d(i,{addContactListToCache:()=>Q,addEventToCache:()=>A,addProfileToCache:()=>O,addRelay:()=>R,addToNIP05VerificationCache:()=>F,follow:()=>U,haveReadMessage:()=>K,haveReadNotifications:()=>H,removeRelay:()=>L,reorderFollows:()=>N,saveRelays:()=>E,setConfig:()=>Y,setConfigLightningTips:()=>X,setDefaultRelays:()=>W,setFollows:()=>D,setKeys:()=>S,setRelayOpt:()=>P,setRelays:()=>j,setUnreadMessages:()=>J,setUnreadNotifications:()=>V,unfollow:()=>I});var o={};n.r(o),n.d(o,{addEvent:()=>de,handleAddingProfileEventToCache:()=>Te,initKeys:()=>oe,launch:()=>ae,publishContactList:()=>pe,publishEvent:()=>me,recommendRelay:()=>ge,restartMainSubscription:()=>re,sendChatMessage:()=>ue,sendPost:()=>ce,setMetadata:()=>he,useEvent:()=>_e,useNip05:()=>qe,useProfile:()=>ve});var a=n(76058),l=n(63703);const r=()=>window.location.hostname.endsWith(".onion"),d={"wss://nostr-pub.wellorder.net":{read:!0,write:!0},"wss://nostr.onsats.org":{read:!0,write:!0},"wss://nostr-relay.wlvs.space":{read:!0,write:!0},"wss://relay.damus.io":{read:!0,write:!0},"wss://nostr.zebedee.cloud":{read:!0,write:!1},"wss://relay.nostr.info":{read:!0,write:!0},"wss://nostr-pub.semisol.dev":{read:!0,write:!1},"wss://nostr.walletofsatoshi.com":{read:!0,write:!1}},c=["wss://nostr-pub.wellorder.net","wss://nostr.swiss-enigma.ch","wss://nostr.cercatrova.me","wss://relay.damus.io","wss://relayer.fiatjaf.com","wss://nostr.rocks","wss://rsslay.fiatjaf.com","wss://nostr.zebedee.cloud","wss://nostr-2.zebedee.cloud","wss://expensive-relay.fiatjaf.com","wss://freedom-relay.herokuapp.com/ws","wss://nostr-relay.freeberty.net","wss://offchain.pub","wss://nostr-relay.wlvs.space","wss://nostr.onsats.org","wss://nostr-relay.untethr.me","wss://nostr.semisol.dev","wss://nostr-pub.semisol.dev","wss://nostr-verified.wellorder.net","wss://nostr.drss.io","wss://nostr.unknown.place","wss://nostr.openchain.fr","wss://nostr.delo.software","wss://relay.nostr.info","wss://relay.minds.com/nostr/v1/ws","wss://nostr.zaprite.io","wss://nostr.oxtr.dev","wss://nostr.ono.re","wss://relay.grunch.dev","wss://relay.cynsar.foundation","wss://nostr.sandwich.farm","wss://relay.nostr.ch","wss://nostr.mom","wss://nostr.walletofsatoshi.com","wss://nostr-relay.alekberg.net","wss://nostr.developer.li","wss://relay.current.fyi"],u={"ws://jgqaglhautb4k6e6i2g34jakxiemqp6z4wynlirltuukgkft2xuglmqd.onion":{read:!0,write:!0},"ws://wagvwfrdrikrqzp7h3b5lwl6btyuttu7mqpeji35ljzq36ovzgjhsfqd.onion":{read:!0,write:!0}};function p(){const e=r()?u:d,t=r()?Object.keys(u):c;let n=l.Z.getItem("config"),{timestamps:s,preferences:i}=n||{},{lastUserMainSync:o=0,lastFeedLoad:a=0}=s||{},{color:p,font:h="Roboto",lightningTips:g}=i||{},{primary:m="#ffffff",secondary:y="#aaaaaa",accent:f="#777777",background:w="#1f1f1f"}=p||{},{enabled:b=!0,lastMode:v="copy",lastWallet:k=null,presets:x=[10,100,1e3],oneClick:C={enabled:!1,amount:10}}=g||{};return n={timestamps:{lastUserMainSync:o,lastFeedLoad:a},preferences:{color:{primary:m,secondary:y,accent:f,background:w},font:h,lightningTips:{enabled:b,lastMode:v,lastWallet:k,presets:x,oneClick:C}}},{keys:l.Z.getItem("keys")||{},relays:l.Z.getItem("relays")||{},defaultRelays:e,optionalRelaysList:t,follows:l.Z.getItem("follows")||[],profilesCache:{},profilesCacheLRU:[],eventsCache:{},eventsCacheLRU:[],contactListCache:{},contactListCacheLRU:[],nip05VerificationCache:{},lastMessageRead:l.Z.getItem("lastMessageRead")||{},unreadMessages:{},lastNotificationRead:l.Z.getItem("lastNotificationRead")||0,unreadNotifications:0,config:n}}var h=n(61993),g=n.n(h),m=n(18933),y=n(31262);function f(e,t){return Object.entries(e.profilesCache).reduce(((e,[n,s])=>t.hasName(n)?[...e,{...s,pubkey:n}]:e),[])}function w(e){return t=>{let{name:n,nip05:s}=e.profilesCache[t]||{};return(n||s||"").length>0}}function b(e){return t=>{let{name:n}=e.profilesCache[t]||{};return n}}function v(e,t){return t=>{let{name:n,nip05:s}=e.profilesCache[t]||{};return s?s.startsWith("_@")?s.slice(2):s:n||m.Z.methods.shorten(m.Z.methods.hexToBech32(t,"npub"))}}function k(e){return t=>{let{nip05:n}=e.profilesCache[t]||{};return n}}function x(e){return t=>{let{picture:n="data:image/png;base64,"+new(g())(t,40).toString()}=e.profilesCache[t]||{};return n}}function C(e){return t=>{let{about:n=""}=e.profilesCache[t]||{};return n}}function M(e){return t=>{let{lud06:n,lud16:s}=e.profilesCache[t]||{};return n||s?y.P6.isLnurl(n)?n.toLowerCase():y.P6.isLightningAddress(s)?m.Z.methods.lnAddrToLnurl(s):null:null}}function _(e){return t=>e.contactListCache[t]}function q(e){return t=>e.contactListCache[t]?.length>6}function T(e){return delete e.unreadMessages[e.keys.pub],Object.values(e.unreadMessages).filter((e=>e)).length}function B(e){return e.unreadNotifications}function $(e){return Boolean(e.keys.priv||window.nostr)}function z(e){return Boolean(e.keys.priv||window.nostr&&window.nostr.nip04)}n(46727);var Z=n(36836);function S(e,{mnemonic:t,priv:n,pub:s}={}){if(t||n||s||(t=Z.Ev.generateSeedWords()),t){let e=Z.Ev.seedFromWords(t);n=Z.Ev.privateKeyFromSeed(e)}n&&(s=(0,Z.$3)(n)),e.keys={priv:n,pub:s}}function j(e,t){e.relays=t}function W(e,t){e.defaultRelays=t}function R(e,t){try{G(t),new URL(t)}catch(n){return}e.relays[t]={read:!0,write:!0}}function L(e,t){delete e.relays[t]}function P(e,{url:t,opt:n,value:s}){t in e.relays&&(e.relays[t][n]=s)}function E(e,t){e.relays=t}function D(e,t){e.follows=t}function U(e,t){e.keys.pub!==t&&(e.follows.includes(t)||e.follows.push(t))}function I(e,t){let n=e.follows.indexOf(t);n>=0&&e.follows.splice(n,1)}function N(e,t){e.follows=t}function O(e,t){t=JSON.parse(JSON.stringify(t));let{pubkey:n}=t;if(delete t.pubkey,n in e.profilesCache&&e.profilesCacheLRU.splice(e.profilesCacheLRU.indexOf(n),1),e.profilesCache[n]=t,n===e.keys.pub||e.profilesCacheLRU.push(n),e.profilesCacheLRU.length>3500){let t=e.profilesCacheLRU.shift();delete e.profilesCache[t]}}function A(e,t){let{id:n}=t;if(n in e.eventsCache&&e.eventsCacheLRU.splice(e.eventsCacheLRU.indexOf(n),1),e.eventsCache[n]=t,e.eventsCacheLRU.push(n),e.eventsCacheLRU.length>1e3){let t=e.eventsCacheLRU.shift();delete e.eventsCache[t]}}function F(e,{identifier:t,pubkey:n}){e.nip05VerificationCache[t]={pubkey:n,when:Math.round(Date.now()/1e3)}}function Q(e,t){t.pubkey in e.contactListCache&&e.contactListCacheLRU.splice(e.contactListCacheLRU.indexOf(t.pubkey),1);try{let n=t.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t,n,s])=>({pubkey:t,relay:n,petname:s})));n.length&&(e.contactListCache[t.pubkey]=n)}catch(n){return}if(t.pubkey===e.keys.pub||e.contactListCacheLRU.push(t.pubkey),e.contactListCacheLRU.length>150){let t=e.contactListCacheLRU.shift();delete e.contactListCache[t]}}function H(e){e.lastNotificationRead=Math.round(Date.now()/1e3)}function V(e,t){e.unreadNotifications=t}function K(e,t){e.lastMessageRead[t]=Math.round(Date.now()/1e3)}function J(e,{peer:t,count:n}){e.unreadMessages[t]=n}function Y(e,{key:t,value:n}){e.config[t]=n}function X(e,{key:t,value:n}){e.config.preferences.lightningTips[t]=n}function G(e){let[t,...n]=e.trim().split("?");return"http"===t.slice(0,4)&&(t="ws"+t.slice(4)),"ws"!==t.slice(0,2)&&(t="wss://"+t),t.length&&"/"===t[t.length-1]&&(t=t.slice(0,-1)),[t,...n].join("?")}var ee=n(6827),te=n(60899),ne=n(22330),se=n(34136),ie=n(26041);function oe(e,t){e.commit("setKeys",t),e.commit("haveReadNotifications")}async function ae(e){console.log("launch for ",e.state.keys.pub),e.dispatch("restartMainSubscription")}let le={};async function re(e){let t=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),n=[e.state.keys.pub,...e.state.follows,"29f63b70d8961835b14062b195fc7d84fa810560b36dde0749e4bc084f0f8952"];le.streamMainProfilesFollows?le.streamMainProfilesFollows.update({authors:n,relays:t}):le.streamMainProfilesFollows=await(0,se.Lh)({authors:n,relays:t},(async t=>{for(let n of t)if(0===n.kind)e.dispatch("handleAddingProfileEventToCache",n);else if(n.pubkey===e.state.keys.pub&&3===n.kind){let t=await(0,se.$d)(`\n            SELECT json_extract(event,'$.created_at') created_at\n            FROM nostr\n            WHERE json_extract(event,'$.kind') = 3 AND\n              json_extract(event,'$.pubkey') = '${e.state.keys.pub}'\n            LIMIT 1\n          `);if(t.length&&n.created_at<t[0].created_at)return;let s=JSON.parse(n.content);e.commit("setRelays",s);let i=n.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t));e.commit("setFollows",i),e.dispatch("restartMainSubscription")}}))}async function de(e,{event:t,relay:n=null}){await(0,se.LB)(t,n)}async function ce(e,{message:t,tags:n=[],kind:s=1}){if(0===t.length)return;const i={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:s,tags:n,content:t};let o=await e.dispatch("publishEvent",{unpublishedEvent:i});return console.log("sendPost result",o),o}async function ue(e,{now:t,pubkey:n,text:s,tags:i}){if(0===s.length)return;let o="???";try{if(e.state.keys.priv)o=await Z._J.encrypt(e.state.keys.priv,n,s);else{if(await(window?.nostr?.getPublicKey?.())!==e.state.keys.pub)throw new Error("no private key available to encrypt!");o=await window.nostr.nip04.encrypt(n,s)}let a={pubkey:e.state.keys.pub,created_at:t,kind:4,tags:i,content:o};return await e.dispatch("publishEvent",{unpublishedEvent:a})}catch(a){return void ee.Z.create({message:`could not encrypt message: ${a}`,color:"negative"})}}async function pe(e){let[t]=await(0,se.sf)(e.state.keys.pub);console.log("oldEvent poblishContactList",t);var n=t?.tags||[];let s=[];await Promise.all(e.state.follows.map((async e=>{let t=n.findIndex((([t,n])=>"p"===t&&n===e));t>=0?s.push(n[t]):s.push(await(0,ie.l_)(e))})));let i={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:3,tags:s,content:JSON.stringify(e.state.relays)};return await e.dispatch("publishEvent",{unpublishedEvent:i})}async function he(e,t){t.created_at&&delete t.created_at;let n={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:0,tags:[],content:JSON.stringify(t)};return await e.dispatch("publishEvent",{unpublishedEvent:n})}async function ge(e,t){let n={pubkey:e.state.keys.pub,created_at:Math.round(Date.now()/1e3),kind:2,tags:[],content:t};return await e.dispatch("publishEvent",{unpublishedEvent:n})}async function me(e,{unpublishedEvent:t}){let n,s=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays);switch(t.kind){case 0:n="profile information";break;case 1:n="note";break;case 2:n="recommend relay";break;case 3:n="follows and relay list";break;case 4:n="dm";break;default:n=`kind ${t.kind}`}try{let i=await(0,ne.B_)(t,e),o=await(0,se.nY)(i,s);if(o||console.log(`no publish confirmation for ${n} event`),await e.dispatch("addEvent",{event:i}),0===i.kind)e.dispatch("handleAddingProfileEventToCache",i);else if(3===i.kind){let t,n;t=JSON.parse(i.content),n=i.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t)),e.commit("setFollows",n),e.commit("setRelays",t)}return[0,3].includes(i.kind)&&ee.Z.create({message:`published updated ${n} event`,color:"positive"}),i}catch(i){return console.log(`could not publish ${n} event: ${i}`),void ee.Z.create({message:`could not publish ${n} event: ${i}`,color:"negative"})}}const ye=(0,te.Z)((async e=>{be||fe(e)}),1e3);async function fe(e){if(we.length){be=!0;let t=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),n=we.splice(0,50);while(n&&n.length){let s=await(0,se.cp)({authors:n,relays:t});if(s)for(let t of s)e.dispatch("handleAddingProfileEventToCache",t);n=we.splice(0,50)}be=!1}}let we=[],be=!1;async function ve(e,{pubkey:t}){if(m.Z.methods.isKey(t))if(t in e.state.profilesCache)e.commit("addProfileToCache",{pubkey:t,...e.state.profilesCache[t]});else{let n=await(0,se.$1)(t);n?e.dispatch("handleAddingProfileEventToCache",n):(we.push(t),ye(e))}}const ke=(0,te.Z)((async e=>{Me||xe(e)}),1e3);async function xe(e){if(Ce.length){Me=!0;let t=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),n=Ce.splice(0,50);while(n&&n.length){let s=await(0,se.vw)({ids:n,relays:t});if(s)for(let t of s)1===t.kind||2===t.kind?m.Z.methods.interpolateEventMentions(t,e):4===t.kind&&(t.text=await m.Z.methods.getPlaintext(t,e),m.Z.methods.interpolateMessageMentions(t,e)),e.commit("addEventToCache",t),e.dispatch("useProfile",{pubkey:t.pubkey});n=Ce.splice(0,50)}Me=!1}}let Ce=[],Me=!1;async function _e(e,{id:t}){if(m.Z.methods.isKey(t))if(t in e.state.eventsCache)e.commit("addEventToCache",{...e.state.eventsCache[t]});else{let n=await(0,se.uA)(t);n?(1===n.kind||2===n.kind?m.Z.methods.interpolateEventMentions(n,e):4===n.kind&&(n.text=await m.Z.methods.getPlaintext(n,e),m.Z.methods.interpolateMessageMentions(n,e)),e.commit("addEventToCache",n),e.dispatch("useProfile",{pubkey:n.pubkey})):(Ce.push(t),ke(e))}}async function qe(e,{metadata:t}){if(""===t.nip05&&delete t.nip05,t.nip05){let s=e.state.nip05VerificationCache[t.nip05];if(s&&s.when>Date.now()/1e3-3600)s.pubkey!==t.pubkey&&delete t.nip05;else{let s;try{let n=await Z.r$.queryProfile(t.nip05);s=n.pubkey,e.commit("addToNIP05VerificationCache",{pubkey:s,identifier:t.nip05})}catch(n){s=""}t.pubkey!==s&&delete t.nip05}}e.commit("addProfileToCache",t)}async function Te(e,t){if(e.state.profilesCache[t.pubkey]&&t.created_at<=e.state.profilesCache[t.pubkey].created_at)return;let n=(0,ne.Wb)(t);e.commit("addProfileToCache",n),e.dispatch("useNip05",{metadata:n})}function Be(e){e.subscribe((({type:e,payload:t},n)=>{switch(e){case"setKeys":l.Z.set("keys",n.keys);break;case"setFollows":l.Z.set("follows",n.follows);break;case"setRelays":l.Z.set("relays",n.relays);break;case"setConfig":case"setConfigLightningTips":l.Z.set("config",n.config);break;case"haveReadNotifications":l.Z.set("lastNotificationRead",n.lastNotificationRead);break;case"haveReadMessage":l.Z.set("lastMessageRead",n.lastMessageRead);break}}))}function $e(e){e.subscribe((({type:t,payload:n},s)=>{switch(t){case"addRelay":case"removeRelay":case"setRelayOpt":case"saveRelays":case"follow":case"unfollow":case"reorderFollows":e.dispatch("publishContactList");break}}))}function ze(e){e.subscribe((({type:t,payload:n},s)=>{switch(t){case"saveRelays":case"follow":case"unfollow":case"setRelays":case"addRelay":case"removeRelay":e.dispatch("restartMainSubscription");break}}))}function Ze(e){const t=async()=>{e.commit("setUnreadNotifications",await(0,se.mX)(e.state.keys.pub,e.state.lastNotificationRead))},n=async t=>{e.commit("setUnreadMessages",{peer:t,count:await(0,se.TE)(e.state.keys.pub,t,e.state.lastMessageRead[t]||0)})};let s={};const i=async()=>{let i=Object.keys(e.state.relays).length?Object.keys(e.state.relays):Object.keys(e.state.defaultRelays),o=!1,a=!1,l={};e.state.keys.pub&&(s.streamMainMentions?s.streamMainMentions.update({authors:[e.state.keys.pub],relays:i}):s.streamMainMentions=await(0,se.Xp)({authors:[e.state.keys.pub],relays:i},(()=>{o&&t()}),(()=>{o||(o=!0,t())})),s.streamMainIncomingMessages?s.streamMainIncomingMessages.update({authors:[e.state.keys.pub],relays:i}):s.streamMainIncomingMessages=await(0,se.u$)({authors:[e.state.keys.pub],relays:i},(e=>{if(a)for(let t of e)n(t.pubkey);else l[event.pubkey]=!0}),(()=>{if(!a){a=!0;for(let e of Object.keys(l))n(e)}})),t(),(0,se.mw)(e.state.keys.pub).then((e=>{e.forEach((e=>{n(e.peer)}))})))};e.subscribeAction((({type:e,payload:t},n)=>{switch(e){case"restartMainSubscription":i();break}})),e.subscribe((({type:e,payload:s},i)=>{switch(e){case"haveReadNotifications":t();break;case"haveReadMessage":n(s);break}}))}const Se=(0,a.MT)({state:p,getters:s,mutations:i,actions:o,plugins:[Be,$e,ze,Ze]})},22330:(e,t,n)=>{"use strict";n.d(t,{B_:()=>r,CX:()=>o,Wb:()=>a,nf:()=>l});n(46727);var s=n(88995),i=n(36836);function o(e){return{id:e.id,pubkey:e.pubkey,created_at:e.created_at,kind:e.kind,tags:e.tags,content:e.content,sig:e.sig}}function a(e){try{let t=JSON.parse(e.content);for(let e of Object.keys(t))t[e]=s.sanitize(t[e]);return t.pubkey=e.pubkey,t.created_at=e.created_at,t}catch(t){return console.log("metadataFromEvent error",t,e),{}}}function l(e){if(e.tags.filter((([e,t])=>"e"===e&&(!t||t.includes(" ")))).length)return!1;if("this workshop is awesome!"===e.content)return!1;if("Hello Nostr! :)"===e.content)return!1;if(""===e.content.trim())return!1;if(e.seen_on?.length&&e.seen_on.includes("wss://rsslay.nostr.net"))return!1;try{return JSON.parse(e.content),!1}catch(t){}return!0}async function r(e,t){if(e.id=(0,i.s_)(e),t.state.keys.priv)e.sig=(0,i.Y5)(e,t.state.keys.priv);else if(window.nostr){let t=await window.nostr.signEvent(e);switch(typeof t){case"string":e.sig=t;break;case"object":e.sig=t.sig;break;default:throw new Error("Failed to sign with Nostr extension.")}}return e}},26041:(e,t,n)=>{"use strict";n.d(t,{BP:()=>o,OV:()=>i,aR:()=>a,l_:()=>l,wn:()=>r});n(46727);var s=n(34136);function i(e,t=5){if(!e)return"";let n=e.slice(0,4);return["npub","nsec","note"].includes(n)?e.slice(0,t+n.length)+"…"+e.slice(-t):e?e.slice(0,t)+"…"+e.slice(-t):""}function o(e,t=3){if(!Array.isArray(e)||!e.length)return"";let n=e.length;return 1===n?e[0]:n<=t?`${JSON.stringify(...e.slice(0,n-2))} and ${e[n-1]}`:`${JSON.stringify(...e.slice(0,t-1))} and ${n-t} others`}function a(e,t,n){for(let s=0;s<e.length;s++){let i=e[s];if(n(i,t))return void e.splice(s,0,t)}e.push(t)}async function l(e){var t=["p",e];let n=await(0,s.$1)(e);if(n&&n.seen_on&&n.seen_on.length){let e=n.seen_on[Math.floor(Math.random()*n.seen_on.length)];t.push(e)}return t}async function r(e,...t){let n=await(0,s.uA)(e);if(n&&n.seen_on&&n.seen_on.length){let e=n.seen_on[Math.floor(Math.random()*n.seen_on.length)];return["e",n.id,e,...t]}return["e",e,"",...t]}},18933:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});n(46727);var s=n(56366),i=n.n(s),o=n(26041),a=n(4376),l=n(36836),r=n(14725),d=n(88995),c=n(40270),u=n(6827),p=n(31262);const{formatDate:h}=a.ZP;function g(e,t){return h(e,t,{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})}function m(e,t=!1){let n=new Date(1e3*e),s=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),i=Date.now();return i-s.getTime()<31536e6&&i>s.getTime()?g(s,t?"ddd D MMMM":"D MMMM"):g(s,t?"ddd D MMMM YYYY":"D MMMM YYYY")}const y={methods:{getLocation(){return location},json(e){return JSON.stringify(e,null,2)},log(e){return console.log(e)},getProfile(e){return this.hexToBech32(e,"npub")},getNote(e){return this.hexToBech32(e,"note")},toProfile(e){this.$router.push("/"+this.getProfile(e))},toEvent(e){this.$router.push("/"+this.getNote(e))},shorten:o.OV,shortenList:o.BP,niceDateUTC(e){let t=Math.floor(Date.now()/1e3);if(e>t)return m(e);if(e===t)return this.$t("now");let n=t-e;if(n<60)return`${n}${this.$t("s")}`;let s=Math.floor(n/60);if(s<60)return`${s}${this.$t("m")}`;let i=Math.floor(s/60);return i<24?`${i}${this.$t("h")}`:m(e)},dateUTC(e){return m(e,!0)},timeUTC(e){let t=new Date(1e3*e);return`${String(t.getUTCHours()).padStart(2,"0")}:${String(t.getUTCMinutes()).padStart(2,"0")} ${this.$t("UTC")}`},interpolateMentions(e,t,n){const s={profiles:[],replyEvents:[],mentionEvents:[]};if(e=String(e).trim(),""===e)return{text:e,replyEvents:[],mentionEvents:t.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t))};const i=(i,a)=>{if(t.length-1<Number(a)||t[Number(a)].length<2||!["e","p"].includes(t[Number(a)][0]))return i;if("e"===t[Number(a)][0]){const n=t[Number(a)][1];return s.mentionEvents.push(n),i.length===e.length?"":`[${(0,o.OV)(this.hexToBech32(n,"note"))}](/${this.hexToBech32(n,"note")})`}if("p"===t[Number(a)][0]){const e=t[Number(a)][1],s=n.getters.displayName(e);return`[${s}](/${this.hexToBech32(e,"npub")})`}},a=(e,t,n)=>`${t}[${e}](/hashtag/${n})`,l=(e,t)=>{const s=n.getters.displayName(t);return`[@${s}](/${t})`};let r=e.replace(/#\[(\d+)\]/g,i),c=r.replace(/(?<s>^|[\s])#([\w]{1,63})\b/g,a),u=c.replace(/@([\w]{64})/g,l),p=u,h=t.findIndex((([e,t,n,s])=>"e"===e&&t&&"root"===s));if(h>=0){let[e,n]=t[h];!s.mentionEvents.includes(n)&&s.replyEvents.length<2&&s.replyEvents.push(n);let i=t.find((([e,t,n,s])=>"e"===e&&t&&"reply"===s));if(i>=0){let[e,n]=t[i];!s.mentionEvents.includes(n)&&s.replyEvents.length<2&&s.replyEvents.push(n)}}return t.filter((([e,t,n,s])=>"e"===e&&t&&"mention"===s)).forEach((([e,t],n)=>{s.mentionEvents.includes(t)||s.mentionEvents.push(t)})),t.filter((([e,t])=>"e"===e&&t)).forEach((([e,t],n)=>{s.mentionEvents.includes(t)||s.replyEvents.includes(t)||(s.replyEvents.length<2?s.replyEvents.push(t):s.mentionEvents.push(t))})),{text:d.sanitize(p),replyEvents:s.replyEvents,mentionEvents:s.mentionEvents}},interpolateEventMentions(e,t=this.$store){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.content,e.tags||[],t))}))},interpolateMessageMentions(e,t=this.$store){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.text,e.tags,t))}))},createMentionsProvider(e){const t=new(i())({menuContainer:document.getElementById("tribute-wrapper"),positionMenu:!1,selectTemplate:e=>`${this.hexToBech32(e.original.value.pubkey,"npub")}`,menuItemTemplate:e=>`\n            <div class="flex row no-wrap items-center" style="gap: .2rem; width: 100%;">\n              <div style="border-radius: 10px">\n                <img src=${this.$store.getters.avatar(e.original.value.pubkey)} style="object-fit: cover; height: 1.5rem; width: 1.5rem;"/>\n              </div>\n                <div class="text-bold">${e.string}</div>\n              ${this.$store.state.follows.includes(e.original.value.pubkey)?'<i class="notranslate material-icons text-secondary mr-1 -ml-1" aria-hidden="true" role="presentation">visibility</i>':""}\n              ${e.original.value.nip05?'<i class="notranslate material-icons text-accent mr-1 -ml-1" aria-hidden="true" role="presentation">verified</i>':""}\n                <div class="text-secondary text-caption">${(0,o.OV)(this.hexToBech32(e.original.value.pubkey,"npub"))}</div>\n              </div>\n            `,values:(e,t)=>{t(this.$store.getters.namedProfiles.map((e=>({key:this.$store.getters.displayName(e.pubkey),value:e}))))},noMatchTemplate:()=>{}});return{attach:e=>t.attach(e),detach:e=>t.detach(e)}},async processTaggedEvents(e,t){if(!Array.isArray(t))throw new Error("no array supplied");e.splice(10);for(let n of e)this.$store.dispatch("useEvent",{id:n})},async getPlaintext(e,t=this.$store){if(e.tags.find((([e,n])=>"p"===e&&n===t.state.keys.pub)))return await this.decrypt(e.pubkey,e.content,t);if(e.pubkey===t.state.keys.pub){let[t,n]=e.tags.find((([e])=>"p"===e));return await this.decrypt(n,e.content)}},async decrypt(e,t,n=this.$store){try{if(n.state.keys.priv)return l._J.decrypt(n.state.keys.priv,e,t);if(await(window?.nostr?.getPublicKey?.())===n.state.keys.pub)return await window.nostr.nip04.decrypt(e,t);throw new Error("no private key available to decrypt!")}catch(s){return"???"}},isKey(e){return!(!e||"string"!==typeof e)&&/^[0-9a-f]{64}$/.test(e?.toLowerCase())},isBech32Key(e){if("string"!==typeof e)return!1;try{let{prefix:t}=r.gW.decode(e.toLowerCase());return!!["npub","nsec","note"].includes(t)&&("npub"===t&&(this.watchOnly=!0),"nsec"===t&&(this.watchOnly=!1),this.isKey(this.bech32ToHex(e)))}catch(t){}return!1},bech32ToHex(e){try{let{data:t}=l.uD.decode(e);return t}catch(t){}return""},hexToBech32(e,t){try{switch(t){case"npub":return l.uD.npubEncode(e);case"nsec":return l.uD.nsecEncode(e);case"note":return l.uD.noteEncode(e)}}catch(n){}return""},lnurlToLnAddr(e){try{let t=p.P6.decodeUrlOrAddress(e);if(!t)return null;let n=/^https:\/\/(?<domain>[a-zA-z0-9.]+)\/.well-known\/lnurlp\/(?<user>[a-zA-Z0-9_-]+)/,s=t.match(n);if(s)return`${s.groups.user}@${s.groups.domain}`}catch(t){}return null},lnAddrToLnurl(e){try{if(!p.P6.isLightningAddress(e))return null;let t=p.P6.decodeUrlOrAddress(e),n=r.gW.toWords(c.Buffer.from(t,"utf8")),s=r.gW.encode("lnurl",n,5e3);return s}catch(t){}},async getInvoice(e,t){if(0===e.toLowerCase().indexOf("lnbc"))return e;if(!t)return e;try{const{invoice:n}=await(0,p.Fl)({lnUrlOrAddress:e,tokens:t,fetchGet:e=>{let t=`https://proxy.astral.ninja/${e.url}`;return e.params&&(t.includes("?")?t+="&":t+="?",t+=new URLSearchParams(e.params)),fetch(t).then((e=>e.json())).catch((e=>{u.Z.create({message:"Error fetching invoice from LNURL. "+e.toString()})}))}});return n}catch(n){return u.Z.create({message:"Error fetching invoice from LNURL. "+n.toString()}),this.lnString}}}}},29280:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n(59835),i=n(86970);function o(e,t,n,o,a,l){const r=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn");return e.buttonText?((0,s.wg)(),(0,s.j4)(d,{key:0,icon:"content_copy",unelevated:"",clickable:"",onClick:e.copy,class:(0,i.C_)([""+e.buttonClass,"button-copy"]),size:e.buttonSize,dense:"",label:e.verbose||e.buttonLabel?e.buttonLabel||"copy":"",align:"left"},{default:(0,s.w5)((()=>[e.tooltipText?((0,s.wg)(),(0,s.j4)(r,{key:0},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.tooltipText),1)])),_:1})):(0,s.kq)("",!0)])),_:1},8,["onClick","class","size","label"])):(0,s.kq)("",!0)}var a=n(18933),l=n(6827);const r=(0,s.aZ)({name:"BaseButtonCopy",mixins:[a.Z],props:{buttonText:{type:String,required:!0},buttonLabel:{type:String,default:null},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1},tooltipText:{type:String,required:!1,default:""},element:{type:Object,default:null}},computed:{copyText(){let e=this.element?.getSelection()?.toString();return e||this.buttonText}},methods:{async copy(){let e=this.copyText;console.log(e),await navigator.clipboard.writeText(e),l.Z.create({message:`copied ${this.copyText.length<70?this.copyText:this.shorten(this.copyText,30)}`})}}});var d=n(11639),c=n(24455),u=n(46858),p=n(69984),h=n.n(p);const g=(0,d.Z)(r,[["render",o]]),m=g;h()(r,"components",{QBtn:c.Z,QTooltip:u.Z})},62863:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Z});var s=n(59835),i=n(61957),o=n(86970);const a=(0,s.Uk)(" metadata "),l={class:"flex row justify-end"},r={class:"overflow-auto"};function d(e,t,n,d,c,u){const p=(0,s.up)("q-tooltip"),h=(0,s.up)("q-btn"),g=(0,s.up)("BaseRawEvent"),m=(0,s.up)("q-card"),y=(0,s.up)("q-dialog"),f=(0,s.Q2)("close-popup");return(0,s.wy)(((0,s.wg)(),(0,s.j4)(h,{icon:"info",unelevated:"",clickable:"",onClick:t[2]||(t[2]=(0,i.iM)((t=>e.toggleMetadataDialog()),["stop"])),class:(0,o.C_)([""+e.buttonClass,"button-info"]),size:e.buttonSize,label:e.verbose?"info":"",dense:"",align:"left"},{default:(0,s.w5)((()=>[e.verbose?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(p,{key:0},{default:(0,s.w5)((()=>[a])),_:1})),(0,s.Wm)(y,{modelValue:e.metadataDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.metadataDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,s.w5)((()=>[(0,s._)("div",l,[(0,s.wy)((0,s.Wm)(h,{icon:"close",flat:"",dense:""},null,512),[[f]])]),(0,s._)("div",r,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.events,(e=>((0,s.wg)(),(0,s.j4)(g,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["class","size","label"])),[[f]])}const c={class:"text-subtitle1"},u=(0,s.Uk)(" raw event data ");function p(e,t,n,i,a,l){const r=(0,s.up)("BaseButtonCopy"),d=(0,s.up)("q-card-section"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(p,{style:{"box-shadow":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s._)("div",c,[u,(0,s.Wm)(r,{"button-text":e.json(l.cleaned)},null,8,["button-text"])]),(0,s._)("pre",null,(0,o.zw)(e.json(l.cleaned)),1)])),_:1})])),_:1})}var h=n(18933),g=n(22330),m=n(29280),y=n(88995);const f={name:"BaseRawEvent",mixins:[h.Z],props:{event:{type:Object,required:!0}},components:{BaseButtonCopy:m.Z},computed:{cleaned(){return Array.isArray(this.event)?this.event.map((e=>(0,g.CX)(this.sanitize(e)))):(0,g.CX)(this.sanitize(this.event))}},methods:{sanitize(e){return JSON.parse(y.sanitize(JSON.stringify(this.event)))}}};var w=n(11639),b=n(44458),v=n(63190),k=n(69984),x=n.n(k);const C=(0,w.Z)(f,[["render",p]]),M=C;x()(f,"components",{QCard:b.Z,QCardSection:v.Z});const _=(0,s.aZ)({name:"BaseButtonInfo",emits:["dialog","hide"],components:{BaseRawEvent:M},data(){return{metadataDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleMetadataDialog(){this.metadataDialog=!this.metadataDialog,this.$emit("dialog",this.metadataDialog)}}});var q=n(24455),T=n(46858),B=n(87743),$=n(62146);const z=(0,w.Z)(_,[["render",d]]),Z=z;x()(_,"components",{QBtn:q.Z,QTooltip:T.Z,QDialog:B.Z,QCard:b.Z}),x()(_,"directives",{ClosePopup:$.Z})},48730:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var s=n(59835),i=n(86970),o=n(61957);const a=(0,s.Uk)(" tip with bitcoin lightning network ");function l(e,t,n,l,r,d){const c=(0,s.up)("q-tooltip"),u=(0,s.up)("BaseLightningCard"),p=(0,s.up)("q-dialog"),h=(0,s.up)("q-btn"),g=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.j4)(g,{class:"no-padding",flat:""},{default:(0,s.w5)((()=>[e.lnString&&this.$store.state.config.preferences.lightningTips.enabled?((0,s.wg)(),(0,s.j4)(h,{key:0,icon:"bolt",class:(0,i.C_)(["button-lightning",e.oneClick?"q-pr-none q-pl-sm":""]),onClick:(0,o.iM)(e.handleLightningTipClick,["stop"]),align:"left",size:e.size,unelevated:"",ripple:!1,dense:"",disable:e.loading},{default:(0,s.w5)((()=>[e.loading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(c,{key:0},{default:(0,s.w5)((()=>[a])),_:1})),(0,s.Wm)(p,{modelValue:e.showLightningCard,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showLightningCard=t)},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{"ln-string":e.lnString,pubkey:e.pubkey,style:{padding:"1.5rem"}},null,8,["ln-string","pubkey"])])),_:1},8,["modelValue"])])),_:1},8,["class","onClick","size","disable"])):(0,s.kq)("",!0),e.oneClick?((0,s.wg)(),(0,s.j4)(h,{key:1,icon:"arrow_drop_down",class:"no-padding",dense:"",unelevated:"",size:e.size,onClick:t[1]||(t[1]=(0,o.iM)((t=>e.showLightningCard=!e.showLightningCard),["stop"]))},null,8,["size"])):(0,s.kq)("",!0)])),_:1})}var r=n(18933),d=n(25780),c=n(6827);const u=(0,s.aZ)({name:"BaseButtonLightning",mixins:[r.Z],components:{BaseLightningCard:d.Z},data(){return{showLightningCard:!1,oneClick:this.$store.state.config.preferences.lightningTips.oneClick.enabled,amount:this.$store.state.config.preferences.lightningTips.oneClick.amount,lnString:this.$store.getters.profileLud06(this.pubkey),loading:!1}},props:{pubkey:{type:String,required:!0},size:{type:String,required:!1,default:"sm"}},methods:{handleLightningTipClick(){window.webln&&this.$store.state.config.preferences.lightningTips.oneClick.enabled?this.sendTip():this.showLightningCard=!this.showLightningCard},async sendTip(){if(!window.webln)return;this.loading=!0;const e=await this.getInvoice(this.lnString,this.amount);if(e.startsWith("lnurl"))return c.Z.create({message:`invoice couldn't be fetched for ${this.$store.getters.displayName(this.pubkey)}, please use a different pay method`}),void(this.loading=!1);try{await window.webln.sendPayment(e),c.Z.create({message:`${this.amount} sats sent to ${this.$store.getters.displayName(this.pubkey)}`})}catch{c.Z.create({message:"one click tip unsuccessful"})}this.loading=!1}}});var p=n(11639),h=n(67236),g=n(24455),m=n(46858),y=n(87743),f=n(69984),w=n.n(f);const b=(0,p.Z)(u,[["render",l]]),v=b;w()(u,"components",{QBtnGroup:h.Z,QBtn:g.Z,QTooltip:m.Z,QDialog:y.Z})},90656:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var s=n(59835),i=n(86970);const o=(0,s.Uk)(" seen on relays "),a={class:"flex row justify-end"},l={class:"overflow-auto"};function r(e,t,n,r,d,c){const u=(0,s.up)("q-tooltip"),p=(0,s.up)("q-btn"),h=(0,s.up)("BaseRelayList"),g=(0,s.up)("q-card"),m=(0,s.up)("q-dialog"),y=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(p,{icon:"sync_alt",unelevated:"",clickable:"",onClick:e.toggleRelayListDialog,class:(0,i.C_)([""+e.buttonClass,"button-relays"]),size:e.buttonSize,label:e.verbose?"relays":"",dense:"",align:"left"},{default:(0,s.w5)((()=>[e.verbose?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:0},{default:(0,s.w5)((()=>[o])),_:1})),(0,s.Wm)(m,{modelValue:e.relayListDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.relayListDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,s.w5)((()=>[(0,s.Wm)(g,null,{default:(0,s.w5)((()=>[(0,s._)("div",a,[(0,s.wy)((0,s.Wm)(p,{icon:"close",flat:"",dense:""},null,512),[[y]])]),(0,s._)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.events,(e=>((0,s.wg)(),(0,s.j4)(h,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["onClick","class","size","label"])}var d=n(44044);const c=(0,s.aZ)({name:"BaseButtonRelays",emits:["dialog","hide"],components:{BaseRelayList:d.Z},data(){return{relayListDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleRelayListDialog(){this.relayListDialog=!this.relayListDialog,this.$emit("dialog",this.relayListDialog)}}});var u=n(11639),p=n(24455),h=n(46858),g=n(87743),m=n(44458),y=n(62146),f=n(69984),w=n.n(f);const b=(0,u.Z)(c,[["render",r]]),v=b;w()(c,"components",{QBtn:p.Z,QTooltip:h.Z,QDialog:g.Z,QCard:m.Z}),w()(c,"directives",{ClosePopup:y.Z})},45938:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n(59835),i=n(61957);function o(e,t,n,o,a,l){const r=(0,s.up)("q-separator"),d=(0,s.up)("q-btn"),c=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{color:"accent"}),(0,s.Wm)(c,{flat:"",spread:"",dense:"","text-color":"accent"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{dense:"",flat:"",color:"accent",class:"text-weight-light",style:{"letter-spacing":"0.1rem"},onClick:(0,i.iM)(l.showMore,["stop"]),label:n.replyCount?n.replyCount+" replies":"show more"},null,8,["onClick","label"])])),_:1}),n.replyCount?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:0,color:"accent"}))],64)}var a=n(18933);const l={name:"BaseButtonShowMore",mixins:[a.Z],props:{root:{type:String,required:!0},replyCount:{type:Number,default:0}},methods:{showMore(){this.toEvent(this.root)}}};var r=n(11639),d=n(50926),c=n(67236),u=n(24455),p=n(69984),h=n.n(p);const g=(0,r.Z)(l,[["render",o]]),m=g;h()(l,"components",{QSeparator:d.Z,QBtnGroup:c.Z,QBtn:u.Z})},25780:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ye});var s=n(59835),i=n(86970),o=n(61957);const a=e=>((0,s.dD)("data-v-ccb22f16"),e=e(),(0,s.Cn)(),e),l={class:"lightning-card"},r=["align"],d={key:0,class:"flex column items-center"},c=a((()=>(0,s._)("span",{class:"text-bold",style:{"font-size":"1.1rem"}},"lightning tip for",-1))),u={key:1,class:"text-bold",style:{"font-size":"1.1rem"}},p={key:0},h=a((()=>(0,s._)("strong",null,"desc:",-1))),g=a((()=>(0,s._)("strong",null,"amount:",-1))),m={key:1},y=a((()=>(0,s._)("strong",null,"created date:",-1))),f={key:2},w=a((()=>(0,s._)("strong",null,"created time:",-1))),b={key:3},v=a((()=>(0,s._)("strong",null,"expires date:",-1))),k={key:4},x=a((()=>(0,s._)("strong",null,"expires time:",-1))),C={key:5},M=a((()=>(0,s._)("strong",null,"error:",-1))),_={key:0,class:"flex row items-center"},q={class:"break-word-wrap",style:{"font-size":"0.7rem","overflow-y":"auto","max-height":"170px","max-width":"200px"}};function T(e,t,n,a,T,B){const $=(0,s.up)("BaseUserCard"),z=(0,s.up)("BaseButtonCopy"),Z=(0,s.up)("q-btn"),S=(0,s.up)("q-tab-panel"),j=(0,s.up)("BaseQr"),W=(0,s.up)("BaseWallet"),R=(0,s.up)("q-tab-panels");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",{class:(0,i.C_)(["flex no-wrap justify-between",n.rowOrColumn]),style:{gap:"1rem"}},[(0,s._)("div",{style:(0,i.j5)([{"font-size":"0.9rem"},"row"===n.rowOrColumn?"gap: .5rem;":"gap: 1rem;"]),class:"flex column justify-between",align:"row"===n.rowOrColumn?"start":"center"},[n.pubkey?((0,s.wg)(),(0,s.iD)("div",d,[c,(0,s.Wm)($,{pubkey:n.pubkey,"action-buttons":!1},null,8,["pubkey"])])):((0,s.wg)(),(0,s.iD)("div",u," lightning "+(0,i.zw)(B.type),1)),B.bolt11?((0,s.wg)(),(0,s.iD)("div",{key:2,class:(0,i.C_)(["flex column","row"===n.rowOrColumn?"items-start":"items-center"])},[B.bolt11.description?((0,s.wg)(),(0,s.iD)("div",p,[h,(0,s.Uk)(" "+(0,i.zw)(B.bolt11.description),1)])):(0,s.kq)("",!0),(0,s._)("div",null,[g,(0,s.Uk)(" "+(0,i.zw)(B.bolt11.amount?`${B.bolt11.amount} sats`:"none specified"),1)]),B.bolt11.created?((0,s.wg)(),(0,s.iD)("div",m,[y,(0,s.Uk)(" "+(0,i.zw)(e.dateUTC(B.bolt11.created)),1)])):(0,s.kq)("",!0),B.bolt11.created?((0,s.wg)(),(0,s.iD)("div",f,[w,(0,s.Uk)(" "+(0,i.zw)(e.timeUTC(B.bolt11.created)),1)])):(0,s.kq)("",!0),B.bolt11.expires?((0,s.wg)(),(0,s.iD)("div",b,[v,(0,s.Uk)(" "+(0,i.zw)(e.dateUTC(B.bolt11.expires)),1)])):(0,s.kq)("",!0),B.bolt11.expires?((0,s.wg)(),(0,s.iD)("div",k,[x,(0,s.Uk)(" "+(0,i.zw)(e.timeUTC(B.bolt11.expires)),1)])):(0,s.kq)("",!0),B.bolt11.error?((0,s.wg)(),(0,s.iD)("div",C,[M,(0,s.Uk)(" "+(0,i.zw)(B.bolt11.error),1)])):(0,s.kq)("",!0)],2)):((0,s.wg)(),(0,s.iD)("div",{key:3,class:(0,i.C_)(["flex column","row"===n.rowOrColumn?"items-start":"items-center"])},[T.request.lnAddr?((0,s.wg)(),(0,s.iD)("div",_,[(0,s._)("span",null,(0,i.zw)(T.request.lnAddr),1),(0,s.Wm)(z,{"button-text":T.request.lnAddr,class:"q-pr-xs",onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},null,8,["button-text"])])):(0,s.kq)("",!0)],2)),(0,s._)("div",{class:(0,i.C_)(["flex row no-wrap q-pt-xs","row"===n.rowOrColumn?" justify-start":" justify-center"]),style:{gap:"0.5rem"}},[(0,s.Wm)(z,{"button-text":n.lnString,"button-label":"copy",outline:"",class:"q-pr-xs",onClick:t[1]||(t[1]=(0,o.iM)((e=>B.updateMode("copy")),["stop"]))},null,8,["button-text"]),(0,s.Wm)(Z,{label:"qr",icon:"qr_code_2",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:t[2]||(t[2]=(0,o.iM)((e=>B.updateMode("qr")),["stop"]))}),(0,s.Wm)(Z,{label:"wallet",icon:"wallet",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:t[3]||(t[3]=(0,o.iM)((e=>B.updateMode("wallet")),["stop"]))})],2)],12,r),(0,s.Wm)(R,{modelValue:T.mode,"onUpdate:modelValue":t[4]||(t[4]=e=>T.mode=e),style:(0,i.j5)([{background:"unset"},"row"===n.rowOrColumn?"max-width: 50%; width: 50%":"max-width: 100%; width: 100%"])},{default:(0,s.w5)((()=>[(0,s.Wm)(S,{name:"copy",class:(0,i.C_)(["no-padding flex items-center","row"===n.rowOrColumn?"justify-end":"justify-center"])},{default:(0,s.w5)((()=>[(0,s._)("div",q,(0,i.zw)(this.lnString.toLowerCase()),1)])),_:1},8,["class"]),(0,s.Wm)(S,{name:"qr",class:"no-padding flex items-center justify-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(j,{code:this.lnString,style:{height:"fit-content"}},null,8,["code"])])),_:1}),(0,s.Wm)(S,{name:"wallet",class:"no-padding flex items-center justify-center full-width"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{"ln-string":n.lnString,pubkey:n.pubkey,bolt11:B.bolt11},null,8,["ln-string","pubkey","bolt11"])])),_:1})])),_:1},8,["modelValue","style"])],2)])}var B=n(18933),$=n(29280);const z={ref:"qr",style:{"object-fit":"cover","min-height":"200px","min-width":"200px",width:"100%"}};function Z(e,t,n,i,o,a){return(0,s.wg)(),(0,s.iD)("img",z,null,512)}var S=n(21170);const j=(0,s.aZ)({name:"BaseQr",props:{code:{type:String,required:!0}},mounted(){let e=this.$refs.qr,t=e.clientWidth;e.style.height=`${t}px`,this.renderQr()},methods:{renderQr(e){this.showQr=!0;let t=S.Z.QrCode.encodeText(this.code,S.Z.QrCode.Ecc.MEDIUM),n=this.toSvgString(t,4);this.$refs.qr.src=n},toSvgString(e,t){let n="#FFFFFF",s="#000000";if(t<0)throw new RangeError("Border must be non-negative");let i=[];for(let r=0;r<e.size;r++)for(let n=0;n<e.size;n++)e.getModule(n,r)&&i.push(`M${n+t},${r+t}h1v1h-1z`);let o=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 ${e.size+2*t} ${e.size+2*t}" stroke="none">\n\t<rect width="100%" height="100%" fill="${n}"/>\n\t<path d="${i.join(" ")}" fill="${s}"/>\n</svg>\n`,a=new Blob([o],{type:"image/svg+xml"}),l=URL.createObjectURL(a);return l}}});var W=n(11639),R=n(490),L=n(69984),P=n.n(L);const E=(0,W.Z)(j,[["render",Z]]),D=E;P()(j,"components",{QItem:R.Z});const U={ref:"walletPicker",class:"wallet-picker flex column no-padding justify-center",style:{gap:"1rem",height:"100%",width:"100%"}},I={class:"flex row full-width items-center justify-center"},N={key:0,class:"flex row no-wrap items-center q-pa-xs",style:{gap:"0.5rem","font-size":"1.1rem",width:"100%"}},O=["src"],A={key:1,style:{"font-size":"1.1rem",width:"100%"}},F={class:"flex column no-wrap q-pa-sm base-select-list",style:{"max-height":"80%",gap:"0.5rem",background:"var(--q-background)","font-size":"1.1rem"}},Q=["onClick"],H=["src"],V={key:0,class:"flex row items-center justify-center",style:{gap:"0.7rem"}},K=(0,s._)("div",{style:{"font-size":"1.1rem"}},"sats",-1),J={key:1,class:"flex row justify-center",style:{gap:"0.3rem"}},Y={class:"flex column justify-center items-center",style:{"font-size":"0.9rem",width:"100%"}},X={key:0},G={key:1},ee={key:2};function te(e,t,n,a,l,r){const d=(0,s.up)("q-dialog"),c=(0,s.up)("BaseSelect"),u=(0,s.up)("q-btn"),p=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",U,[(0,s._)("div",I,[(0,s._)("div",null,[(0,s.Wm)(c,{selecting:e.showWalletPicker,onToggle:t[1]||(t[1]=t=>e.showWalletPicker=!e.showWalletPicker),style:{width:"100%"}},{default:(0,s.w5)((()=>[e.selectedWallet?((0,s.wg)(),(0,s.iD)("div",N,[e.loadingInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("img",{key:0,src:"wallet-icons/"+e.selectedWallet.image,style:{height:"1.5rem",width:"1.5rem","border-radius":"0.3rem"}},null,8,O)),(0,s._)("div",null,(0,i.zw)(e.selectedWallet.name),1)])):((0,s.wg)(),(0,s.iD)("div",A," select a wallet "))])),"list-items":(0,s.w5)((()=>[(0,s.Wm)(d,{modelValue:e.showWalletPicker,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showWalletPicker=t)},{default:(0,s.w5)((()=>[(0,s._)("div",F,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.wallets,((t,n)=>((0,s.wg)(),(0,s.iD)("li",{key:n,onClick:(0,o.iM)((n=>e.selectWallet(t)),["stop"]),class:"flex row items-center no-wrap q-pl-xs",style:{gap:"0.5rem"}},[e.loadingInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("img",{key:0,src:"wallet-icons/"+t.image,style:{height:"1.5rem",width:"1.5rem","border-radius":"0.3rem"}},null,8,H)),(0,s._)("div",null,(0,i.zw)(t.name),1)],8,Q)))),128))])])),_:1},8,["modelValue"])])),_:1},8,["selecting"])])]),e.isInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",V,[(0,s._)("div",{id:"amount-input",contenteditable:"",style:{"font-size":"2rem",padding:"0 0.4rem","min-width":"2rem",outline:"none",border:"none"},onInput:t[2]||(t[2]=(...t)=>e.updateTipAmount&&e.updateTipAmount(...t)),onKeypress:t[3]||(t[3]=(0,o.D2)((t=>e.openInWallet()),["enter"]))},(0,i.zw)(e.tipAmount),33),K])),e.isInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",J,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.tipPresets,((t,n)=>((0,s.wg)(),(0,s.j4)(u,{key:n,label:t+" sats",size:"sm",outline:"",onClick:(0,o.iM)((n=>e.tipAmount=t),["stop"])},null,8,["label","onClick"])))),128)),(0,s.Wm)(u,{label:"other",size:"sm",outline:"",onClick:t[4]||(t[4]=(0,o.iM)((t=>e.focusAmount()),["stop"]))})])),(0,s._)("div",Y,[e.selectedWallet?!e.isInvoice&&e.selectedWallet&&0===e.tipAmount?((0,s.wg)(),(0,s.iD)("span",G,"please enter an amount greater than 0")):e.isInvoice||!e.selectedWallet||e.tipAmount?(0,s.wy)(((0,s.wg)(),(0,s.j4)(u,{key:3,spread:"",outline:"",class:"full-width",label:e.hasWebLn&&"lightning:"===e.selectedWallet.prefix?"pay":"open wallet",color:"primary",onClick:t[5]||(t[5]=(0,o.iM)((t=>e.openInWallet()),["stop"]))},null,8,["label"])),[[p]]):((0,s.wg)(),(0,s.iD)("span",ee,"please enter an amount")):((0,s.wg)(),(0,s.iD)("span",X,"please select a wallet"))])],512)}var ne=n(6827),se=n(64318);const ie=(0,s.aZ)({name:"BaseWallet",mixins:[B.Z],components:{BaseSelect:se.Z},props:{lnString:{type:String,required:!0,default:""},pubkey:{type:String,default:null},bolt11:{type:Object,default:null},extended:{type:Boolean,requred:!1,default:!1},size:{type:String,required:!1,default:"sm"}},data(){return{showWalletPicker:!1,loadingInvoice:!1,tipAmount:this.$store.state.config.preferences.lightningTips.presets[0],tipPresets:this.$store.state.config.preferences.lightningTips.presets,selectedWallet:null,wallets:[{name:"system default",prefix:"lightning:",image:"default.png"},{name:"browser extension (webln)",prefix:"lightning:",image:"webln.jpg"},{name:"Strike",prefix:"strike:lightning:",image:"strike.jpg"},{name:"Cash App",prefix:"squarecash://",image:"cashapp.jpg"},{name:"Muun",prefix:"muun:",image:"muun.jpg"},{name:"Breez",prefix:"breez:",image:"breez.jpg"},{name:"Phoenix",prefix:"phoenix://",image:"phoenix.jpg"},{name:"Wallet of Satoshi",prefix:"walletofsatoshi:lightning:",image:"wos.jpg"},{name:"Blixt",prefix:"blixtwallet:lightning:",image:"blixt.png"},{name:"Zeus LN",prefix:"zeusln:lightning:",image:"zeusln.jpg"},{name:"Bitcoin Beach",prefix:"bitcoinbeach://",image:"bbw.jpg"}],hasWebLn:!1,focusAmount(){setTimeout((async()=>{await this.$nextTick(),this.tipAmount=null,this.amountInput.focus()}),1)}}},computed:{amountInput(){return this.$refs.walletPicker.querySelector("#amount-input")},isInvoice(){return this.lnString.startsWith("lnbc")}},mounted(){this.selectedWallet=this.wallets.find((e=>e.name===this.$store.state.config.preferences.lightningTips.lastWallet)),this.hasWebLn=window.webln},methods:{selectWallet(e){this.selectedWallet=e,this.showWalletPicker=!1},updateTipAmount(e){let t=e.target.innerText,n=/^[0-9]+$/,s=t.match(n);if(!s)return void(this.tipAmount=null);let i=parseInt(t);this.tipAmount=i},async openInWallet(){if(!this.selectedWallet||!this.tipAmount)return;this.$store.commit("setConfigLightningTips",{key:"lastWallet",value:this.selectedWallet.name});let e=this.selectedWallet.prefix;e||(e="lightning:"),this.loadingInvoice=!0;const t=await this.getInvoice(this.lnString,this.tipAmount);if(t.startsWith("lnurl"))return ne.Z.create({message:`invoice couldn't be fetched for ${this.$store.getters.displayName(this.pubkey)}, please an different pay method`}),void(this.loadingInvoice=!1);if("lightning:"===e&&window.webln&&t.startsWith("lnbc"))try{await window.webln.sendPayment(t),ne.Z.create({message:`${this.bolt11?this.bolt11.amount:this.tipAmount} sats sent`})}catch{ne.Z.create({message:"payment unsuccessful"})}else window.open(`${e}${t}`,"_self");this.loadingInvoice=!1}}});var oe=n(87743),ae=n(24455),le=n(62146);const re=(0,W.Z)(ie,[["render",te]]),de=re;P()(ie,"components",{QDialog:oe.Z,QBtn:ae.Z}),P()(ie,"directives",{ClosePopup:le.Z});var ce=n(78621),ue=n(31262);const pe={name:"BaseLightningCard",mixins:[B.Z],props:{lnString:{type:String,required:!0},pubkey:{type:String,default:null},rowOrColumn:{type:String,default:"column"}},components:{BaseButtonCopy:$.Z,BaseQr:D,BaseWallet:de},data(){return{request:{},mode:this.$store.state.config.preferences.lightningTips.lastMode}},computed:{bolt11(){if(!this.lnString.toLowerCase().startsWith("lnbc"))return null;try{let e=ce.decode(this.lnString),t={};e.sections.forEach((({name:e,value:n})=>{t[e]=n}));let n=t.amount?t.amount/1e3:null,s=t.description,i=t.timestamp,o=t.expiry,a=parseInt(o),l=isNaN(a)?null:i+a,r=e.paymentRequest;return{amount:n,description:s,created:i,expires:l,request:r}}catch(e){console.log("invoice parsing error",e);let t=this.lnString;return{error:e,request:t}}},type(){return this.lnString.startsWith("lnbc")?"invoice":"lnurl"}},async mounted(){if(this.both11)return;if(!ue.P6.isLnurl(this.lnString))return void(this.request.error="invalid lnurl");let e=this.lnurlToLnAddr(this.lnString);e&&(this.request.lnAddr=e)},methods:{updateMode(e){this.mode=e,this.$store.commit("setConfigLightningTips",{key:"lastMode",value:e})}}};var he=n(89800),ge=n(84106);const me=(0,W.Z)(pe,[["render",T],["__scopeId","data-v-ccb22f16"]]),ye=me;P()(pe,"components",{QBtn:ae.Z,QTabPanels:he.Z,QTabPanel:ge.Z})},39474:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var s=n(59835),i=n(86970),o=n(61957);const a={ref:"src",class:"hidden break-word-wrap"},l={ref:"append",class:"hidden break-word-wrap"},r=["innerHTML"],d={key:1};function c(e,t,n,c,u,p){const h=(0,s.up)("q-btn"),g=(0,s.up)("BaseLightningCard");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",a,[(0,s.WI)(e.$slots,"default")],512),(0,s._)("div",l,[(0,s.WI)(e.$slots,"append")],512),(0,s._)("div",{innerHTML:u.html,ref:"html",class:(0,i.C_)(["break-word-wrap dynamic-content",n.longForm?"long-form":""]),onClick:t[0]||(t[0]=(...e)=>p.handleClicks&&p.handleClicks(...e))},null,10,r),n.longForm?((0,s.wg)(),(0,s.j4)(h,{key:0,id:"long-form-button",dense:"",outline:"",rounded:"",color:"accent",class:"text-weight-light q-ma-sm justify-between full-width",style:{"letter-spacing":"0.1rem","justify-content":"space-between"},label:"show full post",onClick:(0,o.iM)(p.expand,["stop"])},null,8,["onClick"])):(0,s.kq)("",!0),u.invoices.length?((0,s.wg)(),(0,s.iD)("div",d,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(u.invoices,((e,t)=>((0,s.wg)(),(0,s.j4)(g,{key:t,"ln-string":e,class:"lt-sm",style:{padding:"1rem"}},null,8,["ln-string"])))),128)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(u.invoices,((e,t)=>((0,s.wg)(),(0,s.j4)(g,{key:t,"ln-string":e,class:"gt-xs","row-or-column":"row",style:{padding:"1rem"}},null,8,["ln-string"])))),128))])):(0,s.kq)("",!0)])}var u=n(27678),p=n.n(u),h=n(51994),g=n.n(h),m=n(64879),y=n.n(m),f=n(77984),w=n.n(f),b=n(89105),v=n.n(b),k=n(30651),x=n.n(k),C=n(18933),M=n(25780);const _=p()({html:!1,breaks:!0,linkify:!0});_.use(g()).use(y()).use(w()).use(v()).use(x()).use((e=>{var t=e.renderer.rules.link_open||function(e,t,n,s,i){return i.renderToken(e,t,n)};e.core.ruler.before("normalize","auto-imager",(e=>{e.src=e.src.replace(/https?:[^ \n]+/g,(e=>{if(e){let t=e.split("?")[0];if(t.endsWith(".gif")||t.endsWith(".png")||t.endsWith(".jpeg")||t.endsWith(".jpg")||t.endsWith(".svg")||t.endsWith(".webp")||t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".ogg"))return`![](${e})`}return e}))})),e.renderer.rules.image=(e,t)=>{let n=e[t].attrs[[e[t].attrIndex("src")]][1],s=n.split("?")[0];return s.endsWith(".gif")||s.endsWith(".png")||s.endsWith(".jpeg")||s.endsWith(".jpg")||s.endsWith(".webp")||s.endsWith(".svg")?`<img src="${n}" async loading='lazy' style="max-width: 90%; max-height: 50vh;">`:s.endsWith(".mp4")||s.endsWith(".webm")||s.endsWith(".ogg")?`<video src="${n}" controls async style="max-width: 90%; max-height: 50vh;"></video>`:void 0},e.renderer.rules.link_open=function(e,n,s,i,o){var a=e[n],l=a.attrIndex("target"),r=a.attrIndex("href"),d=/\bhttps:\/\/(www.|m.|music.)?youtu(be.com|.be)\/(watch\?v=|shorts\/)?(?<v>[a-zA-Z0-9_-]{11})(&t=(?<s>[0-9]+)s)?/;let c=a.attrs[r][1].match(d);if(c){let e=`https://www.youtube.com/embed/${c.groups.v}`;return c.groups.s&&(e+=`?start=${c.groups.s}`),`<iframe anonymous async style="height: 15rem; width: 90%; object-fit: cover;" src="${e}" loading='lazy'\n          title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>\n          </iframe>`}var u=/^https?:\/\//;return u.test(a.attrs[r][1])&&(l<0?e[n].attrPush(["target","_blank"]):e[n].attrs[l][1]="_blank"),t(e,n,s,i,o)}})),_.linkify.tlds(["onion","eth"],!0).add("bitcoin:",null).add("lightning:",null).add("http:",{validate(e,t,n){var s=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(s)?s.match(n.re.http)[0].length:0},normalize(e,t){if(t.__text_cache__.length<150||e.text<23)return;let n=new URL(e.url),s=n.host;if((n.pathname+n.search+n.hash).length>10){let t=e.text.slice(-7);"/"===t[0]&&(t=t.slice(1)),s+=`/…/${t}`}e.text=s}}).set({fuzzyEmail:!1});const q={name:"BaseMarkdown",mixins:[C.Z],emits:["expand","resized"],components:{BaseLightningCard:M.Z},data(){return{html:"",invoices:[]}},props:{content:{type:String,default:"todo needs to be updated"},longForm:{type:Boolean,default:!1}},computed:{parsedContent(){const e=/\b(?<i>(lnbc|LNBC)[0-9a-zA-Z]*1[0-9a-zA-Z]+)\b/g,t=(e,t)=>(this.invoices.push(e.toLowerCase()),"");let n=this.content.replace(e,t);return n}},mounted(){this.render()},updated(){this.render()},methods:{render(){this.html=_.render(this.parsedContent)+this.$refs.append.innerHTML,this.$refs.html.querySelectorAll("img").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation(),document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():e.requestFullscreen(),this.$emit("resized")})),e.addEventListener("load",(e=>{this.$emit("resized")}))}))},handleClicks(e){let{target:t}=e;if(t&&t.matches(".dynamic-content a:not([href*='://'])")&&t.href){const{altKey:n,ctrlKey:s,metaKey:i,shiftKey:o,button:a,defaultPrevented:l}=e;if(i||n||s||o)return;if(l)return;if(void 0!==a&&0!==a)return;if(t&&t.getAttribute){const e=t.getAttribute("target");if(/\b_blank\b/i.test(e))return}const r=new URL(t.href),d=r.pathname;window.location.pathname!==d&&e.preventDefault&&(e.preventDefault(),e.stopPropagation(),this.$router.push(d))}else t&&t.matches(".dynamic-content a[href*='://']")&&t.href&&e.stopPropagation()},expand(e){this.$emit("expand")}}};var T=n(11639),B=n(24455),$=n(69984),z=n.n($);const Z=(0,T.Z)(q,[["render",c]]),S=Z;z()(q,"components",{QBtn:B.Z})},73396:(e,t,n)=>{"use strict";n.d(t,{Z:()=>z});var s=n(59835),i=n(86970),o=n(61957);const a={key:0,class:"text-accent timestamp"},l={class:"flex column message-bubbles"},r={key:0,class:"flex column text-left full-width q-pb-xs embeded-message",style:{display:"block"},clickable:!1},d={key:0,class:"reposts"};function c(e,t,n,c,u,p){const h=(0,s.up)("BasePost"),g=(0,s.up)("BaseMessage",!0),m=(0,s.up)("BaseUserName"),y=(0,s.up)("BaseMarkdown"),f=(0,s.up)("BaseButtonReply"),w=(0,s.up)("BaseButtonCopy"),b=(0,s.up)("BaseButtonInfo"),v=(0,s.up)("BaseButtonRelays"),k=(0,s.up)("q-list"),x=(0,s.up)("q-menu"),C=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["relative-position flex column",p.sent?"message-sent":"message-received"]),onClick:t[3]||(t[3]=(0,o.iM)((()=>{}),["stop"]))},[n.isEmbeded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",a,(0,i.zw)(e.timeUTC(n.event.created_at)),1)),(0,s._)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.sequence,((a,l)=>((0,s.wg)(),(0,s.iD)("div",{key:l,class:(0,i.C_)(["message-bubble",(0===l||1===p.sequence.length?" first-message":"")+(l===p.sequence.length-1?" last-message":"")])},[!n.isEmbeded&&u.taggedEvents[a.id]&&u.render?((0,s.wg)(),(0,s.iD)("div",r,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(u.taggedEvents[a.id],(n=>((0,s.wg)(),(0,s.iD)("div",{key:n.id+"_"+u.taggedEvents[a.id].length+"_"+u.render},[1===n.kind||2===n.kind?((0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(h,{event:n,"manual-focus":!1,"is-embeded":!0,onContextmenuCapture:(0,o.iM)((t=>e.toEvent(n.id)),["stop"])},null,8,["event","onContextmenuCapture"])])):4===n.kind?((0,s.wg)(),(0,s.j4)(g,{key:1,event:n,class:"no-padding no-margin","is-embeded":!0,clickable:"",onMounted:t[0]||(t[0]=t=>e.$emit("mounted")),onClickCapture:t[1]||(t[1]=(0,o.iM)((()=>{}),["prevent","stop"]))},null,8,["event"])):(0,s.kq)("",!0)])))),128))])):(0,s.kq)("",!0),n.isEmbeded?((0,s.wg)(),(0,s.iD)("div",{key:1,class:(0,i.C_)(["flex row justify-between q-gutter-md",p.sent?"reverse":""])},[(0,s.Wm)(m,{pubkey:a.pubkey,fallback:!0},null,8,["pubkey"]),(0,s._)("span",null,(0,i.zw)(e.niceDateUTC(n.event.created_at)),1)],2)):(0,s.kq)("",!0),(0,s.Wm)(y,{content:a.interpolated.text},null,8,["content"]),n.isEmbeded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(x,{key:2,modelValue:u.contextMenus[l],"onUpdate:modelValue":e=>u.contextMenus[l]=e,"touch-position":"","context-menu":"",persistent:u.persistentMenu,onClick:t[2]||(t[2]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{dense:"",class:"flex column q-gutter-xs q-pa-xs"},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(f,{"button-class":"text-accent full-width justify-start",verbose:!0,onReply:e=>p.reply(a)},null,8,["onReply"])])),[[C]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(w,{"button-class":"text-accent full-width justify-start","button-text":a.interpolated.text,verbose:!0},null,8,["button-text"])])),[[C]]),(0,s._)("div",null,[(0,s.Wm)(b,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])]),(0,s._)("div",null,[(0,s.Wm)(v,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue","persistent"]))],2)))),128))])],2)}var u=n(19302),p=n(18933),h=n(90656),g=n(62863),m=n(29280);function y(e,t,n,o,a,l){const r=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(r,{icon:"reply",unelevated:"",clickable:"",onClick:t[0]||(t[0]=t=>e.$emit("reply")),class:(0,i.C_)([""+e.buttonClass,"button-reply"]),size:e.buttonSize,dense:"",label:e.verbose?"reply":"",align:"left"},null,8,["class","size","label"])}const f=(0,s.aZ)({name:"BaseButtonReply",emits:["reply"],props:{buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}});var w=n(11639),b=n(24455),v=n(69984),k=n.n(v);const x=(0,w.Z)(f,[["render",y]]),C=x;k()(f,"components",{QBtn:b.Z});var M=n(39474);const _={name:"BaseMessage",emits:["reply","mounted"],mixins:[p.Z],props:{event:{type:Object,required:!0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:h.Z,BaseButtonInfo:g.Z,BaseButtonCopy:m.Z,BaseButtonReply:C,BaseMarkdown:M.Z},setup(){const e=(0,u.Z)();e.platform.has.touch},data(){return{invisible:!0,menu:{},render:1,contextMenus:[],persistentMenu:!1,taggedEvents:{}}},computed:{sequence(){let e=[this.event].concat(this.event.appended).filter((e=>e));return this.render,e},sent(){return this.event.pubkey===this.$store.state.keys.pub}},mounted(){setTimeout((()=>{this.invisible=!1}),20);for(let e of this.sequence){let t=e.tags?.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t))||[];t.length&&(this.taggedEvents[e.id]=[],this.processTaggedEvents(t,this.taggedEvents[e.id]))}this.event.created_at<this.$store.state.lastMessageRead[this.bech32ToHex(this.$route.params.pubkey)]&&this.$emit("mounted")},methods:{reply(e){this.$emit("reply",e)},hideMenu(){this.contextMenus=this.contextMenus.map((e=>!1)),this.togglePersistentMenu(!1)},togglePersistentMenu(e){this.persistentMenu=e}}};var q=n(56362),T=n(13246),B=n(62146);const $=(0,w.Z)(_,[["render",c]]),z=$;k()(_,"components",{QMenu:q.Z,QList:T.Z}),k()(_,"directives",{ClosePopup:B.Z})},44044:(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var s=n(59835),i=n(86970);const o=e=>((0,s.dD)("data-v-5ebe1cb2"),e=e(),(0,s.Cn)(),e),a=o((()=>(0,s._)("span",{class:"text-bold",style:{"font-size":"1.1rem"}},"relays",-1))),l=(0,s.Uk)("  ( "),r={class:"text-secondary"},d=(0,s.Uk)(" seen "),c=(0,s.Uk)(" not seen "),u=(0,s.Uk)(" ) "),p={style:{"overflow-x":"scroll"}},h={class:"relay-list"},g=(0,s.Uk)("        "),m={key:0,class:"text-secondary",style:{overflow:"hidden"}},y=(0,s.Uk)("\n          "),f=(0,s.Uk)("\n            "),w=(0,s.Uk)("\n        "),b=(0,s.Uk)("\n        "),v={key:1,style:{overflow:"hidden"}},k=(0,s.Uk)("\n          "),x=(0,s.Uk)("\n            "),C=(0,s.Uk)("\n            "),M=(0,s.Uk)("\n        "),_=(0,s.Uk)("\n      ");function q(e,t,n,o,q,T){const B=(0,s.up)("q-icon"),$=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",null,[a,l,(0,s._)("span",r,[(0,s.Wm)(B,{name:"visibility",size:"xs",dense:""}),d]),(0,s._)("span",null,[(0,s.Wm)(B,{name:"visibility_off",size:"xs",dense:""}),c]),u]),(0,s._)("div",p,[(0,s._)("pre",h,[g,n.event?.seen_on?.length?((0,s.wg)(),(0,s.iD)("div",m,[y,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.event.seen_on,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"relay-item hide-scrollbar"},[f,(0,s.Wm)(B,{name:"visibility",size:"xs"}),(0,s.Uk)("\n            "+(0,i.zw)(e)+"\n          ",1)])))),128)),w])):(0,s.kq)("",!0),b,T.missingFrom.length?((0,s.wg)(),(0,s.iD)("div",v,[k,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(T.missingFrom,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"relay-item unseen-relay-item hide-scrollbar",clickable:""},[x,(0,s.Wm)($,{icon:"visibility",flat:"",unelevated:"",color:"secondary",size:"sm",class:"no-padding",dense:"",onClick:t=>T.publishTo(e)},null,8,["onClick"]),C,(0,s.Wm)(B,{name:"visibility_off",size:"xs",clickable:""}),(0,s.Uk)("\n            "+(0,i.zw)(e)+"\n          ",1)])))),128)),M])):(0,s.kq)("",!0),_])])])}var T=n(34136),B=n(18933),$=n(22330);const z={name:"BaseRelayList",mixins:[B.Z],props:{event:{type:Object,required:!0}},computed:{missingFrom(){return this.event&&this.event.seen_on?Object.entries(this.$store.state.relays).filter((([e,t])=>t.write)).map((([e,t])=>e)).filter((e=>-1===this.event.seen_on.indexOf(e))):[]}},methods:{publishTo(e){console.log("publish event",this.event);let t=[e];(0,T.nY)((0,$.CX)(this.event),t)}}};var Z=n(11639),S=n(22857),j=n(24455),W=n(69984),R=n.n(W);const L=(0,Z.Z)(z,[["render",q],["__scopeId","data-v-5ebe1cb2"]]),P=L;R()(z,"components",{QIcon:S.Z,QBtn:j.Z})},88844:(e,t,n)=>{"use strict";n.d(t,{Z:()=>M});var s=n(59835);const i={class:"flex column q-gutter-md"},o={key:0};function a(e,t,n,a,l,r){const d=(0,s.up)("BaseRelayCard");return(0,s.wg)(),(0,s.iD)("div",i,[n.listView?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",o,"added relay:")),(0,s.Wm)(d,{url:n.url},null,8,["url"])])}var l=n(18933),r=n(61957),d=n(86970);const c={class:"w-full ml-2"},u={class:"text-bold"};function p(e,t,n,i,o,a){const l=(0,s.up)("q-btn"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.iD)("div",c,[(0,s.Wm)(p,{class:"cursor-pointer flex row justify-start items-center",flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{rounded:"",flat:"",color:"primary",size:"md",icon:n.url in e.$store.state.relays?"check":"add",label:n.url in e.$store.state.relays?"added":"add relay",disable:n.url in e.$store.state.relays,onClick:(0,r.iM)(a.addRelay,["stop"])},null,8,["icon","label","disable","onClick"]),(0,s._)("div",u,(0,d.zw)(a.cleanUrl),1)])),_:1})])}var h=n(88995);const g={name:"BaseRelayCard",props:{url:{type:String,required:!0}},computed:{cleanUrl(){return h.sanitize(this.url)}},methods:{addRelay(){Object.keys(this.$store.state.relays).length?this.$q.dialog({title:"Add relay?",message:`Add ${this.url} to your list of relays?`,cancel:{color:"accent"},ok:{color:"accent"}}).onOk((()=>{this.$store.commit("addRelay",this.url)})):this.$q.dialog({title:"set your first relay?",message:"if you are a new user click proceed. if you are a user that already has a relay list, astral has not been\n            able to find it yet. if you hit proceed it will clear your relay list and replace it with this single relay.",cancel:{color:"accent"},ok:{color:"accent",label:"proceed"}}).onOk((()=>{this.$store.commit("addRelay",this.url)}))}}};var m=n(11639),y=n(44458),f=n(24455),w=n(69984),b=n.n(w);const v=(0,m.Z)(g,[["render",p],["__scopeId","data-v-0b03fd4a"]]),k=v;b()(g,"components",{QCard:y.Z,QBtn:f.Z});const x={name:"BaseRelayRecommend",mixins:[l.Z],components:{BaseRelayCard:k},props:{url:{type:String,required:!0},listView:{type:Boolean,default:!1}}},C=(0,m.Z)(x,[["render",a]]),M=C},64318:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var s=n(59835),i=n(86970),o=n(61957);const a={style:{cursor:"pointer","padding-left":"0.2rem"},class:"relative-position"},l={class:"q-pl-sm"},r={key:0,class:"base-select-list",style:{position:"absolute",top:"1.3rem","z-index":"1","max-height":"15rem","overflow-y":"auto",width:"100%","font-family":"'Spotnik'"}},d={class:"",style:{display:"block","margin-block-start":"0.5rem","margin-block-end":"0.5rem","padding-inline-start":"0.5rem"}};function c(e,t,n,c,u,p){const h=(0,s.up)("q-icon");return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",{class:"flex justify-between base-select no-wrap items-center",style:(0,i.j5)([{"border-radius":"0.5rem"},e.allowSelection?"cursor: pointer; opacity: 1;":"cursor: not-allowed; opacity: .5;"]),onClick:t[0]||(t[0]=(0,o.iM)(((...t)=>e.toggle&&e.toggle(...t)),["stop"]))},[(0,s._)("span",l,[(0,s.WI)(e.$slots,"default",{},void 0,!0)]),(0,s.Wm)(h,{name:e.selecting?"arrow_drop_up":"arrow_drop_down",size:"xs"},null,8,["name"])],4),e.selecting&&e.allowSelection?((0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("ul",d,[(0,s.WI)(e.$slots,"list-items",{},void 0,!0)])])):(0,s.kq)("",!0)])}const u=(0,s.aZ)({name:"BaseSelect",emits:["toggle"],props:{allowSelection:{type:Boolean,default:!0},selecting:{type:Boolean,default:!1}},methods:{toggle(){this.allowSelection&&this.$emit("toggle")}}});var p=n(11639),h=n(22857),g=n(69984),m=n.n(g);const y=(0,p.Z)(u,[["render",c],["__scopeId","data-v-6a0eb6a4"]]),f=y;m()(u,"components",{QIcon:h.Z})},53361:(e,t,n)=>{"use strict";n.d(t,{Z:()=>L});var s=n(59835),i=n(86970),o=n(61957);const a={class:"text-secondary pubkey",style:{opacity:"0.9","font-size":"95%","font-weight":"300"}};function l(e,t,n,l,r,d){const c=(0,s.up)("BaseUserAvatar"),u=(0,s.up)("BaseUserName"),p=(0,s.up)("BaseMarkdown"),h=(0,s.up)("BaseUserCardActions"),g=(0,s.up)("q-item-section"),m=(0,s.up)("q-item");return(0,s.wg)(),(0,s.j4)(m,{clickable:e.clickable,unelevated:"",outlined:"",class:(0,i.C_)(["no-padding flex row justify-start items-center cursor-pointer",(e.alignRight?"text-right reverse":"text-left")+(e.headerMode?" header-mode":"")+(e.hasTouch||e.headerMode||!e.actionButtons?"":" hidden-action-buttons")]),onClick:t[0]||(t[0]=(0,o.iM)((t=>e.toProfile(e.pubkey)),["stop"])),style:{"max-width":"100%",gap:"0.5rem"}},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(c,{pubkey:e.pubkey,"align-right":e.alignRight,size:e.headerMode?"10rem":"lg",class:(0,i.C_)(e.headerMode?"self-center":"")},null,8,["pubkey","align-right","size","class"])]),(0,s.Wm)(g,{class:(0,i.C_)(e.headerMode?"self-start":""),style:(0,i.j5)(e.headerMode?"":"white-space: nowrap; overflow: auto;")},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{pubkey:e.pubkey,"header-mode":e.headerMode,"show-verified":!0,class:(0,i.C_)(e.headerMode?" text-h6":""),"align-right":e.alignRight,"show-following":e.showFollowing,wrap:e.wrap},null,8,["pubkey","header-mode","class","align-right","show-following","wrap"]),(0,s._)("div",a,(0,i.zw)(e.shorten(e.npubKey)),1),e.headerMode?((0,s.wg)(),(0,s.j4)(p,{key:0,content:e.$store.getters.profileDescription(e.pubkey)},null,8,["content"])):(0,s.kq)("",!0),e.actionButtons?((0,s.wg)(),(0,s.j4)(h,{key:1,pubkey:e.pubkey,class:"action-buttons"},null,8,["pubkey"])):(0,s.kq)("",!0)])),_:1},8,["class","style"])])),_:1},8,["clickable","class"])}var r=n(19302),d=n(18933);function c(e,t,n,a,l,r){const d=(0,s.up)("BaseButtonCopy"),c=(0,s.up)("BaseButtonMessage"),u=(0,s.up)("BaseButtonFollow"),p=(0,s.up)("BaseButtonLightning");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["flex row no-wrap",e.buttonGroupClass]),style:{gap:"0.3rem"}},[(0,s.Wm)(d,{"button-text":e.npubKey,"button-size":"sm","text-color":"secondary","tooltip-text":"copy pubkey",onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},null,8,["button-text"]),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(c,{key:0,"button-to":"/messages/"+e.npubKey,"button-size":"sm","text-color":"primary",onClick:t[1]||(t[1]=(0,o.iM)((()=>{}),["stop"]))},null,8,["button-to"])):(0,s.kq)("",!0),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(u,{key:1,pubkey:e.pubkey,"button-size":"sm",onClick:t[2]||(t[2]=(0,o.iM)((()=>{}),["stop"]))},null,8,["pubkey"])):(0,s.kq)("",!0),e.pubkey!==e.$store.state.keys.pub&&e.$store.getters.profileLud06(e.pubkey)?((0,s.wg)(),(0,s.j4)(p,{key:2,pubkey:e.pubkey},null,8,["pubkey"])):(0,s.kq)("",!0)],2)}const u=(0,s.Uk)(" encrypted message ");function p(e,t,n,a,l,r){const d=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(c,{icon:"mail_lock",unelevated:"",clickable:"",class:(0,i.C_)([e.buttonClass,"button-message"]),size:e.buttonSize,to:e.buttonTo,onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"])),dense:""},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[u])),_:1})])),_:1},8,["class","size","to"])}const h=(0,s.aZ)({name:"BaseButtonMessage",props:{buttonTo:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},methods:{copy(){console.log(this.buttonText),navigator.clipboard.writeText(this.buttonText)}}});var g=n(11639),m=n(24455),y=n(46858),f=n(69984),w=n.n(f);const b=(0,g.Z)(h,[["render",p]]),v=b;function k(e,t,n,a,l,r){const d=(0,s.up)("q-icon"),c=(0,s.up)("q-tooltip"),u=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(u,{class:(0,i.C_)(e.buttonClass+(e.isFollowing?"button-unfollow":"button-follow")),size:e.buttonSize,unelevated:"","text-color":e.isFollowing?"":"secondary",dense:"",onClick:(0,o.iM)(e.toggleFollowing,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{name:e.isFollowing?"person_remove":"person_add",class:(0,i.C_)(e.isFollowing?"flip-horizontal":"")},null,8,["name","class"]),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.isFollowing?"unfollow":"follow"),1)])),_:1})])),_:1},8,["class","size","text-color","onClick"])}w()(h,"components",{QBtn:m.Z,QTooltip:y.Z});n(46727);const x=(0,s.aZ)({name:"BaseButtonFollow",props:{pubkey:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},computed:{isFollowing(){return this.$store.state.follows.includes(this.pubkey)}},methods:{toggleFollowing(){this.$store.state.follows.length?this.isFollowing?this.unfollow():this.follow():this.$q.dialog({title:"set your first follow?",message:"if you are a new user click proceed. if you are a user that already has a follows list, dostr has not been\n            able to find it yet. if you hit proceed it will clear your follows list and replace it with this single follow.",cancel:{color:"accent"},ok:{color:"accent",label:"proceed"}}).onOk((()=>{this.follow()}))},unfollow(){this.$store.commit("unfollow",this.pubkey)},follow(){this.$store.commit("follow",this.pubkey)}}});var C=n(22857);const M=(0,g.Z)(x,[["render",k],["__scopeId","data-v-7a9e9312"]]),_=M;w()(x,"components",{QBtn:m.Z,QIcon:C.Z,QTooltip:y.Z});var q=n(29280),T=n(48730);const B=(0,s.aZ)({name:"BaseUserCardActions",mixins:[d.Z],props:{pubkey:{type:String,required:!0},buttonGroupClass:{type:String,required:!1,default:""}},components:{BaseButtonMessage:v,BaseButtonFollow:_,BaseButtonCopy:q.Z,BaseButtonLightning:T.Z},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}}),$=(0,g.Z)(B,[["render",c]]),z=$;var Z=n(39474);const S=(0,s.aZ)({name:"BaseUserCard",components:{BaseUserCardActions:z,BaseMarkdown:Z.Z},mixins:[d.Z],props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,required:!1,default:!1},clickable:{type:Boolean,required:!1,default:!0},headerMode:{type:Boolean,required:!1,default:!1},actionButtons:{type:Boolean,required:!1,default:!0},showFollowing:{type:Boolean,default:!1},wrap:{type:Boolean,default:!1}},setup(){const e=(0,r.Z)();let t=e?.platform.has.touch||!1;return{hasTouch:t}},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}});var j=n(490),W=n(76749);const R=(0,g.Z)(S,[["render",l],["__scopeId","data-v-aa0103ce"]]),L=R;w()(S,"components",{QItem:j.Z,QItemSection:W.Z})},46601:()=>{},89214:()=>{},52361:()=>{},94616:()=>{}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,(()=>{var e=[];n.O=(t,s,i,o)=>{if(!s){var a=1/0;for(c=0;c<e.length;c++){for(var[s,i,o]=e[c],l=!0,r=0;r<s.length;r++)(!1&o||a>=o)&&Object.keys(n.O).every((e=>n.O[e](s[r])))?s.splice(r--,1):(l=!1,o<a&&(a=o));if(l){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,i,o]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(s,i){if(1&i&&(s=this(s)),8&i)return s;if("object"===typeof s&&s){if(4&i&&s.__esModule)return s;if(16&i&&"function"===typeof s.then)return s}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var l=2&i&&s;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>a[e]=()=>s[e]));return a["default"]=()=>s,n.d(o,a),o}})(),(()=>{n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,s)=>(n.f[s](e,t),t)),[]))})(),(()=>{n.u=e=>"js/"+(443===e?"about":e)+"."+{165:"ba921f26",399:"07f52206",433:"d94dd3c5",443:"3d00c6a3",551:"1783f5ea",557:"d74d915f",608:"3309083d",654:"86b0ad52",683:"c4572093",710:"bfd970ef",757:"98800584",955:"0ae54ace",970:"c278aa3d"}[e]+".js"})(),(()=>{n.miniCssF=e=>"css/"+({143:"app",443:"about",736:"vendor"}[e]||e)+"."+{143:"6f257420",165:"e6eee1c1",443:"449e91d0",551:"d8c33866",608:"53a9e573",654:"d5c556c6",683:"f35522d2",710:"f5c9dbbb",736:"e2c77689",757:"278e9e54",970:"51703e6a"}[e]+".css"})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="dostr:";n.l=(s,i,o,a)=>{if(e[s])e[s].push(i);else{var l,r;if(void 0!==o)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==s||u.getAttribute("data-webpack")==t+o){l=u;break}}l||(r=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,n.nc&&l.setAttribute("nonce",n.nc),l.setAttribute("data-webpack",t+o),l.src=s),e[s]=[i];var p=(t,n)=>{l.onerror=l.onload=null,clearTimeout(h);var i=e[s];if(delete e[s],l.parentNode&&l.parentNode.removeChild(l),i&&i.forEach((e=>e(n))),t)return t(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),r&&document.head.appendChild(l)}}})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{n.j=143})(),(()=>{n.p="/dostr-client/"})(),(()=>{var e=(e,t,n,s)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var o=o=>{if(i.onerror=i.onload=null,"load"===o.type)n();else{var a=o&&("load"===o.type?"missing":o.type),l=o&&o.target&&o.target.href||t,r=new Error("Loading CSS chunk "+e+" failed.\n("+l+")");r.code="CSS_CHUNK_LOAD_FAILED",r.type=a,r.request=l,i.parentNode.removeChild(i),s(r)}};return i.onerror=i.onload=o,i.href=t,document.head.appendChild(i),i},t=(e,t)=>{for(var n=document.getElementsByTagName("link"),s=0;s<n.length;s++){var i=n[s],o=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(o===e||o===t))return i}var a=document.getElementsByTagName("style");for(s=0;s<a.length;s++){i=a[s],o=i.getAttribute("data-href");if(o===e||o===t)return i}},s=s=>new Promise(((i,o)=>{var a=n.miniCssF(s),l=n.p+a;if(t(a,l))return i();e(s,l,i,o)})),i={143:0};n.f.miniCss=(e,t)=>{var n={165:1,443:1,551:1,608:1,654:1,683:1,710:1,757:1,970:1};i[e]?t.push(i[e]):0!==i[e]&&n[e]&&t.push(i[e]=s(e).then((()=>{i[e]=0}),(t=>{throw delete i[e],t})))}})(),(()=>{n.b=document.baseURI||self.location.href;var e={143:0};n.f.j=(t,s)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)s.push(i[2]);else{var o=new Promise(((n,s)=>i=e[t]=[n,s]));s.push(i[2]=o);var a=n.p+n.u(t),l=new Error,r=s=>{if(n.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var o=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.src;l.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",l.name="ChunkLoadError",l.type=o,l.request=a,i[1](l)}};n.l(a,r,"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,s)=>{var i,o,[a,l,r]=s,d=0;if(a.some((t=>0!==e[t]))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(r)var c=r(n)}for(t&&t(s);d<a.length;d++)o=a[d],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(c)},s=globalThis["webpackChunkdostr"]=globalThis["webpackChunkdostr"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=n.O(void 0,[736,64],(()=>n(3671)));s=n.O(s)})();